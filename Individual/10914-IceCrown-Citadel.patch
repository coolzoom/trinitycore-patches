diff --git a/sql/CMakeLists.txt b/sql/CMakeLists.txt
index e1b0921..16a13f7 100644
--- a/sql/CMakeLists.txt
+++ b/sql/CMakeLists.txt
@@ -15,6 +15,7 @@ if( WITH_SQL )
       scripts
       base
       create
+	  ICC
     DESTINATION
       shared/trinity/sql
   )
diff --git a/sql/ICC/FULL_world_icc_templates.sql b/sql/ICC/FULL_world_icc_templates.sql
new file mode 100644
index 0000000..50e879f
--- /dev/null
+++ b/sql/ICC/FULL_world_icc_templates.sql
@@ -0,0 +1,390 @@
+-- Cleanup
+UPDATE `creature_template` SET `ScriptName`='' WHERE `entry` IN (SELECT `id` FROM `creature` WHERE `map` = 631);
+
+-- GameObject
+UPDATE `gameobject_template` SET `ScriptName` = 'icecrown_citadel_teleporter' WHERE `entry` IN (202223,202235,202242,202243,202244,202245,202246);
+UPDATE `gameobject_template` SET `flags` = 32 WHERE `entry` IN (202235,202242,202243,202244,202245,202246);
+UPDATE `gameobject_template` SET `flags` = 52 WHERE `entry` = 202223;
+UPDATE `gameobject_template` SET `ScriptName` = '', `data10` = 70308 WHERE `entry` = 201584;
+UPDATE `gameobject` SET `phaseMask` = '1' WHERE `id` IN (202242,202243,202244,202245,202235,202223,202246);
+UPDATE `gameobject` SET `state` = '1' WHERE `id` IN (201614,201613);
+UPDATE `gameobject` SET `state` = '0' WHERE `id` IN (201375);
+UPDATE gameobject SET phaseMask = 17 WHERE id IN (201375,201374);
+-- test platform destruction
+UPDATE `gameobject_template` SET `flags` = 32 WHERE `entry` = 202161;
+UPDATE `gameobject` SET `state` = '1' WHERE `id` IN (202161);
+
+-- Boss
+UPDATE `creature_template` SET `ScriptName`='boss_rotface' WHERE `entry`= 36627;
+UPDATE `creature_template` SET `ScriptName`='boss_blood_elf_valanar_icc' WHERE `entry` = 37970;
+UPDATE `creature_template` SET `ScriptName`='boss_blood_elf_keleset_icc' WHERE `entry` = 37972;
+UPDATE `creature_template` SET `ScriptName`='boss_blood_elf_taldaram_icc' WHERE `entry` = 37973;
+UPDATE `creature_template` SET `ScriptName`='boss_blood_queen_lanathel' WHERE `entry` = 37955;
+UPDATE `creature_template` SET `ScriptName`='boss_valithria' WHERE `entry` = 36789;
+UPDATE `creature_template` SET `ScriptName`='boss_sindragosa' WHERE `entry` = 36853;
+UPDATE `creature_template` SET `ScriptName`='boss_the_lich_king' WHERE `entry` = 36597;
+
+-- Mobs
+UPDATE `creature_template` SET `ScriptName`='npc_tirion_icc' WHERE `entry`= 38995;
+UPDATE `creature_template` SET `ScriptName`='npc_swarming_shadows' WHERE `entry` = 38163;
+UPDATE `creature_template` SET `ScriptName`='npc_cold_flame' WHERE `entry` = 36672;
+UPDATE `creature_template` SET `ScriptName`='npc_bone_spike' WHERE `entry` = 36619;
+UPDATE `creature_template` SET `ScriptName`='npc_volatile_ooze' WHERE `entry` = 37697;
+UPDATE `creature_template` SET `ScriptName`='npc_valkyr_icc' WHERE `entry` = 36609;
+UPDATE `creature_template` SET `ScriptName`='npc_vile_spirit_icc' WHERE `entry`= 37799;
+UPDATE `creature_template` SET `ScriptName`='npc_ooze_little' WHERE `entry`= 36897;
+UPDATE `creature_template` SET `ScriptName`='npc_ooze_big' WHERE `entry`= 36899;
+UPDATE `creature_template` SET `ScriptName`='npc_shade' WHERE `entry` = 38222;
+UPDATE `creature_template` SET `ScriptName`='npc_dreamcloud_icc' WHERE `entry` = 37985;
+UPDATE `creature_template` SET `ScriptName`='npc_dreamportal_icc' WHERE `entry` IN (38186,37945,38429,38430);
+UPDATE `creature_template` SET `ScriptName`='npc_cult_fanatic_and_adherent' WHERE `entry` IN (37949,38010,38136,37890,38009,38135);
+UPDATE `creature_template` SET `ScriptName`='npc_rimefang' WHERE `entry`= 37533;
+UPDATE `creature_template` SET `ScriptName`='npc_spinestalker' WHERE `entry`= 37534;
+UPDATE `creature_template` SET `ScriptName`='npc_ice_tomb' WHERE `entry`= 36980;
+UPDATE `creature_template` SET `ScriptName`='npc_icc_puddle_stalker' WHERE `entry`= 37824;
+UPDATE `creature_template` SET `ScriptName`='npc_ooze_explode_stalker' WHERE `entry` = 38107;
+UPDATE `creature_template` SET `ScriptName`='npc_gas_cloud_icc' WHERE `entry` = 37562;
+UPDATE `creature_template` SET `ScriptName`='npc_bomb_icc' WHERE `entry` = 38159;
+UPDATE `creature_template` SET `ScriptName`='npc_stinky_icc' WHERE `entry` = 37025;
+UPDATE `creature_template` SET `ScriptName`='npc_precious_icc' WHERE `entry` = 37217;
+UPDATE `creature_template` SET `ScriptName`='npc_icc_combat_stalker' WHERE `entry` = 38752;
+UPDATE `creature_template` SET `ScriptName`='npc_valithria_alternative' WHERE `entry` = 37950;
+UPDATE `creature_template` SET `ScriptName`='boss_blood_council_controller' WHERE `entry`=38008;
+UPDATE `creature_template` SET `ScriptName`='npc_blood_queen_lana_thel' WHERE `entry`=38004;
+UPDATE `creature_template` SET `ScriptName`='npc_kinetic_bomb' WHERE `entry`=38454;
+UPDATE `creature_template` SET `ScriptName`='npc_dark_nucleus' WHERE `entry`=38369;
+UPDATE `creature_template` SET `ScriptName`='npc_ball_of_flame' WHERE `entry` IN (38332,38451);
+
+-- Other
+UPDATE `creature_template` SET `minlevel` = 82, `maxlevel` = 82, `faction_A` = 14, `faction_H` = 14, `unit_flags` = 33554434, `type_flags` = 1024 WHERE `entry` = 36672;
+UPDATE `creature_template` SET `minlevel` = 82, `maxlevel` = 82, `faction_A` = 35, `faction_H` = 35 WHERE `entry` = 37950;
+UPDATE `creature_template` SET `minlevel` = 80, `maxlevel` = 80, `faction_A` = 14, `faction_H` = 14, `unit_flags` = 0, type_flags = 0, `VehicleId` = 533 WHERE `entry` IN (36619,38233,38459,38460);
+UPDATE `creature_template` SET `faction_A`=2068, `faction_H`=2068 WHERE `entry` IN (36899,38123,3689902,3689903);
+UPDATE `creature_template` SET `faction_A` = 21, `faction_H` = 21, `unit_flags` = 33600, `vehicleId` = 639 WHERE `entry` IN (37813,38402,38582,38583);
+UPDATE `creature_template` SET `faction_A` = 35, `faction_H` = 35, `type_flags` = 67113036 WHERE `entry` IN (36789,38174);
+UPDATE `creature_template` SET `faction_A` = 14, `faction_H` = 14, `minlevel` = 80, `maxlevel` = 80 WHERE `entry` IN (37006,37013,37986,38107,38548,36659,37690,37562,38159);
+UPDATE `creature_template` SET `vehicleId` = 532 WHERE `entry` IN (36609,39120,39121,39122);
+UPDATE `creature_model_info` SET `bounding_radius` = 5,`combat_reach` = 5 WHERE `modelid` = 31119;
+UPDATE `creature_template` SET `mechanic_immune_mask` = 634339327 WHERE `entry` IN (36855,38106,38296,38297);
+UPDATE `creature_template` SET `flags_extra` = 2 WHERE `entry` IN (37007,38301);
+UPDATE `creature_template` SET `spell1` = 70360, `spell2`= 70539, `spell3`= 70542, `VehicleId` = 591 WHERE `entry`= 37672;
+UPDATE `creature_template` SET `spell1` = 72527, `spell2`= 72457, `spell3`= 70542, `VehicleId` = 591 WHERE `entry`= 38285;
+UPDATE `creature_template` SET `dynamicflags` = 8, `npcflag` = 0, `unit_flags` = 32832 WHERE `entry` = 38995;
+UPDATE `creature_template` SET `faction_A` = 14, `faction_H` = 14 WHERE `entry` IN (36899,38123);
+UPDATE `creature_template` SET `MovementType` = 1 WHERE `entry` IN(37985,37799,39284,39285,39286);
+UPDATE `creature_template` SET `InhabitType`=5,`flags_extra`=`flags_extra`|0x80 WHERE `entry`=30298;
+UPDATE `creature_template` SET `InhabitType`=5,`minlevel`=82,`maxlevel`=82,`faction_A`=14,`faction_H`=14,`speed_walk`=0.142857 WHERE `entry` IN (38454,38775,38776,38777); -- Kinetic Bomb
+UPDATE `creature_template` SET `minlevel`=82,`maxlevel`=82,`flags_extra`=`flags_extra`|0x80 WHERE `entry`=38458; -- Kinetic Bomb Target
+UPDATE `creature_template` SET `minlevel`=82,`maxlevel`=82,`exp`=2,`flags_extra`=`flags_extra`|0x80 WHERE `entry`=38422; -- Shock Vortex
+UPDATE `creature_template` SET `minlevel`=82,`maxlevel`=82,`exp`=2,`speed_walk`=1.57143,`unit_flags`=33554432,`flags_extra`=`flags_extra`|0x80 WHERE `entry`=38332; -- Ball of Flame
+UPDATE `creature_template` SET `minlevel`=82,`maxlevel`=82,`exp`=2,`speed_walk`=1.57143,`unit_flags`=33554432,`flags_extra`=`flags_extra`|0x80 WHERE `entry`=38451; -- Ball of Inferno Flame
+UPDATE `creature_template` SET `unit_flags`=536904000,`RegenHealth`=0,`equipment_id`=10092,`speed_run`=1.428571,`speed_walk`=1.6 WHERE `entry` IN (37970,38401,38784,38785); -- Prince Valanar
+UPDATE `creature_template` SET `unit_flags`=536904000,`RegenHealth`=0,`equipment_id`=10077,`speed_run`=1.428571,`speed_walk`=1.6 WHERE `entry` IN (37972,38399,38769,38770); -- Prince Keleseth
+UPDATE `creature_template` SET `unit_flags`=536904000,`RegenHealth`=0,`equipment_id`=10091,`speed_run`=1.428571,`speed_walk`=1.6 WHERE `entry` IN (37973,38400,38771,38772); -- Prince Taldaram
+UPDATE `creature_model_info` SET `bounding_radius`=0.5425,`combat_reach`=1.75 WHERE `modelid` IN (30856,30857,30858);
+UPDATE `creature_template` SET `RegenHealth`=0 WHERE `entry`=38369; -- Dark Nucleus
+UPDATE `creature_template` SET  `dynamicflags` = 8 WHERE entry IN (37970, 38401, 38784, 38785);
+UPDATE `creature_template` SET `RegenHealth` = '0' WHERE `entry` =38174;
+UPDATE `creature_template` SET `vehicleId` = 531 WHERE `entry` IN (36609,39120,39121,39122);
+
+-- Spell
+
+DELETE FROM `spell_script_names` WHERE `spell_id` IN(69783,69057,69140,72705,69147,69075,70834,70835,70836,70903,71236);
+
+-- Not attackable and disable move flag
+UPDATE `creature_template` SET `unit_flags` = 33555204 WHERE `entry` IN (37986,37824,38234,38317,36659,38548,37186,37006,37918,37690,38068,38163,38584,38752);
+UPDATE `creature_template` SET `unit_flags` = 33587972 WHERE `entry` = 37013;
+UPDATE `creature_template` SET `flags_extra` = 0 WHERE `entry` IN (37986,38234,38317,36659,38548,37186,37013);
+UPDATE `creature_template` SET `flags_extra` = 128 WHERE `entry` = 38234;
+UPDATE `creature_template` SET `flags_extra` = 130 WHERE `entry` = 38569;
+
+-- Instance
+UPDATE `instance_template` SET `script`='instance_icecrown_citadel' WHERE `map` = 631;
+
+-- Creature addon template
+
+DELETE FROM `creature_addon` WHERE `guid` IN (136107,104365);
+DELETE FROM `creature_template_addon` WHERE `entry` IN (37690,37672,36659,38186,37945,38429,38430,37918,37006,37186);
+
+INSERT INTO creature_addon (`guid`, `path_id`, `mount`, `bytes1`, `bytes2`, `emote`, `auras`) VALUES
+(136107, 0, 0, 0, 1, 0, '18950 0 18950 1 72242 0');
+
+INSERT INTO `creature_addon` (`guid`, `bytes1`) VALUES
+(104365,0x03000000); -- Blood Queen Lana'Thel
+
+INSERT INTO `creature_template_addon` (`entry`, `path_id`, `mount`, `bytes1`, `bytes2`, `emote`, `auras`) VALUES
+(37690, 0, 0, 0, 0, 0, '70345 0  70343 0'),
+(37672, 0, 0, 0, 0, 0, '70385 0 70405 0'),
+(38186, 0, 0, 0, 0, 0, '71304 0'),
+(37945, 0, 0, 0, 0, 0, '70763 0'),
+(38429, 0, 0, 0, 0, 0, '71986 0'),
+(38430, 0, 0, 0, 0, 0, '71994 0'),
+(37918, 0, 0, 0, 0, 0, '70715 0'),
+(37186, 0, 0, 0, 0, 0, '70022 0'),
+(37006, 0, 0, 0, 0, 0, '69776 0');
+
+-- Thanks YTDB
+
+-- Conditions
+
+DELETE FROM `conditions` WHERE `SourceEntry` IN (69508,70881,70360,36659,70781,70856,70857,70858,70859,70860,70861,69157,71614,70588,74074);
+DELETE FROM `conditions` WHERE `ConditionValue2` IN (SELECT `id` FROM `creature` WHERE `map` = 631);
+DELETE FROM `conditions` WHERE `SourceTypeOrReferenceId`=13 AND `SourceEntry` IN (70952,70982,70981,70983,71070,71081,71080);
+DELETE FROM `conditions` WHERE `SourceTypeOrReferenceId`=21 AND `SourceGroup` IN (37672,38285);
+INSERT INTO `conditions` (`SourceTypeOrReferenceId`,`SourceGroup`,`SourceEntry`,`ElseGroup`,`ConditionTypeOrReference`,`ConditionValue1`,`ConditionValue2`,`ConditionValue3`,`ErrorTextId`,`ScriptName`,`Comment`) VALUES
+(13,0,70360,0,18,1,37690,0,0, '', ''),
+(13,0,69157,0,18,1,36659,0,0, '', 'Festergut - Gaseous Blight'),
+(13,0,69162,0,18,1,36659,0,0, '', 'Festergut - Gaseous Blight'),
+(13,0,69164,0,18,1,36659,0,0, '', 'Festergut - Gaseous Blight'),
+(13,0,71614,0,18,1,38995,0,0, '', 'LichKing - Ice Lock'),
+(13,0,70588,0,18,1,36789,0,0, '', 'Valithria - Suppression'),
+(13,0,70588,0,18,1,38174,0,0, '', 'Valithria - Suppression'),
+(13,0,71617,0,18,1,38317,0,0, '', 'Putricide - Tear Gas'),
+(13,0,69125,0,18,1,37013,0,0, '', ''),
+(21,37672,71516,0,3,49888,0,0,0, '', 'Mutated Abomination - Unholy Infusion'),
+(21,38285,71516,0,3,49888,0,0,0, '', 'Mutated Abomination - Unholy Infusion'),
+(13,0,70952,0,18,1,37970,0,0, '', 'Valanar - Invocation of Blood'),
+(13,0,70982,0,18,1,37973,0,0, '', 'Taldaram - Invocation of Blood'),
+(13,0,70981,0,18,1,37972,0,0, '', 'Keleseth - Invocation of Blood'),
+(13,0,70983,0,18,1,37970,0,0, '', 'Valanar - Invocation of Blood beam'),
+(13,0,70983,0,18,1,37973,0,0, '', 'Taldaram - Invocation of Blood beam'),
+(13,0,70983,0,18,1,37972,0,0, '', 'Keleseth - Invocation of Blood beam'),
+(13,0,71070,0,18,1,37970,0,0, '', 'Valanar - Invocation of Blood visual'),
+(13,0,71081,0,18,1,37973,0,0, '', 'Taldaram - Invocation of Blood visual'),
+(13,0,71080,0,18,1,37972,0,0, '', 'Keleseth - Invocation of Blood visual'),
+(13,0,74074,0,18,1,36597,0,0, '', 'The Lich King - Plague Siphon');
+
+-- creature
+
+DELETE FROM `creature` WHERE `id` IN(37813, 37013, 36659,37950);
+INSERT INTO `creature` (`guid`, `id`, `map`, `spawnMask`, `phaseMask`, `modelid`, `equipment_id`, `position_x`, `position_y`, `position_z`, `orientation`, `spawntimesecs`, `spawndist`, `currentwaypoint`, `curhealth`, `curmana`, `DeathState`, `MovementType`, `npcflag`, `unit_flags`, `dynamicflags`) VALUES
+(48969,37013,631,1,1,11686,0,4291.18,3092.92,372.97,2.33874,300,0,0,25200,0,0,0,0,0,0), -- puddle stalker
+(48971,37013,631,1,1,11686,0,4312.14,3112.98,372.97,2.51327,300,0,0,25200,0,0,0,0,0,0),
+(48973,37013,631,1,1,11686,0,4244.04,3092.66,372.97,0.97738,300,0,0,25200,0,0,0,0,0,0),
+(48976,37013,631,1,1,11686,0,4223.47,3113.58,372.97,0.76794,300,0,0,25200,0,0,0,0,0,0),
+(48981,37013,631,1,1,11686,0,4222.44,3161.69,372.97,5.53269,300,0,0,25200,0,0,0,0,0,0),
+(48983,37013,631,1,1,11686,0,4243.89,3181.74,372.97,5.44543,300,0,0,25200,0,0,0,0,0,0),
+(48989,37013,631,1,1,11686,0,4312.36,3160.84,372.97,3.80482,300,0,0,25200,0,0,0,0,0,0),
+(48990,37013,631,1,1,11686,0,4291.45,3181.25,372.97,4.10152,300,0,0,25200,0,0,0,0,0,0),
+(93955,36659,631,15,1,11686,0,4267.87,3137.33,360.469,0,300,0,0,25200,0,0,0,0,0,0),
+(136107,37813,631,15,1,30790,0,-493.905,2211.35,541.114,3.18037,300,0,0,12299490,0,0,0,0,0,0), -- saurfang
+(1000000,37950,631,15,16,0,0,4203.65,2483.89,390.961,5.51524,604800,0,0,6000003,0,0,0,0,33540,8);
+
+-- Linked spell
+
+DELETE FROM `spell_linked_spell` WHERE `spell_trigger` IN (72202,70117);
+DELETE FROM `spell_linked_spell` WHERE `spell_effect` IN(72202,69166,70347,72380,69706,70702,70311, 69291, 70338,72846,69201,74074);
+INSERT INTO `spell_linked_spell` (`spell_trigger`,`spell_effect`,`type`,`comment`) VALUES
+(70360,70347,0,'Eat Ooze'),
+(72379,72380,0,'Blood Nova'),
+(72380,72202,0,'Blood Nova 10N'),
+(72438,72202,0,'Blood Nova 25N'),
+(72439,72202,0,'Blood Nova 10H'),
+(72440,72202,0,'Blood Nova 25H'),
+(72409,72202,0,'Rune of Blood 25N'),
+(72447,72202,0,'Rune of Blood 10H'),
+(72448,72202,0,'Rune of Blood 25H'),
+(72449,72202,0,'Rune of Blood 25H'),
+(69195,69166,0,'Pungent Blight 10N'),
+(71279,69166,0,'Pungent Blight 25N'),
+(73031,69166,0,'Pungent Blight 10H'),
+(73032,69166,0,'Pungent Blight 25H'),
+(70117,70122,0,'Sindragosa: Blistering Cold dummy'),
+(70715,70702,0,'?'),
+(-69674,69706,0, 'Rotface: Mutated Infection Summon'),
+(-71224,69706,0, 'Rotface: Mutated Infection Summon'),
+(-73022,69706,0, 'Rotface: Mutated Infection Summon'),
+(-73023,69706,0, 'Rotface: Mutated Infection Summon'),
+(-70337,70338,0, 'The Lich King: Necrotic plague initial cast'),
+(-70337,72846,0, 'The Lich King: Necrotic plague immun'),
+(-70338,70338,0, 'The Lich King: Necrotic jump'),
+(-69200,69201,0, 'The Lich King: Raging Spirit'),
+(-70338,74074,0, 'The Licg King: Plague Siphon');
+
+-- Linked Respawn
+
+DELETE FROM `creature_linked_respawn` WHERE `guid` IN (136104,136105,136107,67608,67614,67901,77641,77642,77643,115558);
+INSERT INTO `creature_linked_respawn` (`guid`,`linkedGuid`) VALUES
+(136104,136104), -- Lord Marrowgar
+(136105,136105), -- Lady Deathwhisper
+(136107,136107), -- Deathbringer Saurfang
+(67608,67608), -- Festergut
+(67614,67614), -- Rotface
+(67901,67901), -- Professor Putricide
+(77641,77641), -- Prince Keleseth
+(77642,77642), -- Prince Taldaram
+(77643,77643), -- Prince Valanar
+(115558,115558); -- Blood-Queen Lana'thel
+
+-- Npc spell click spell
+
+DELETE FROM `npc_spellclick_spells` WHERE npc_entry IN (37945,38430);
+INSERT INTO `npc_spellclick_spells` (`npc_entry`, `spell_id`, `quest_start`, `quest_start_active`, `quest_end`, `cast_flags`, `aura_required`, `aura_forbidden`, `user_type`) VALUES
+(37945,70766,0,0,0,3,0,0,0),
+(38430,70766,0,0,0,3,0,0,0);
+
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (70405,72508,72509,72510) AND `ScriptName`='spell_putricide_mutated_transformation_dismiss';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (70311,71503) AND `ScriptName`='spell_putricide_mutated_transformation';
+DELETE FROM `spell_script_names` WHERE `spell_id`=70308 AND `ScriptName`='spell_putricide_mutation_init';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (71412,71415) AND `ScriptName`='spell_putricide_ooze_summon';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (72262) AND `ScriptName`='spell_lich_king_quake';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (74361) AND `ScriptName`='spell_lich_king_valkyr_summon';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (70541,73779,73780,73781) AND `ScriptName`='spell_lich_king_infection';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (70338,73785,73786,73787) AND `ScriptName`='spell_lich_king_necrotic_plague';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (69075,70834,70835,70836) AND `ScriptName`='spell_lord_marrowgar_bone_storm';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (70157) AND `ScriptName`='spell_sindragosa_ice_tomb';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (70127,72528,72529,72530) AND `ScriptName`='spell_sindragosa_mystic_buffet';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (69766) AND `ScriptName`='spell_sindragosa_unchained_magic';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (72219,72551,72552,72553) AND `ScriptName`='spell_festergut_gastric_bloat';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (69558) AND `ScriptName`='spell_rotface_unstable_explosion';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (68981,74270,74271,74272) AND `ScriptName`='spell_lich_king_winter';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (70534) AND `ScriptName`='spell_vile_spirit_distance_check';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (69110) AND `ScriptName`='spell_ice_burst_distance_check';
+DELETE FROM `spell_script_names` WHERE `spell_id`=71598 AND `ScriptName`='spell_creature_permanent_feign_death';
+DELETE FROM `spell_script_names` WHERE `spell_id`=71806 AND `ScriptName`='spell_taldaram_glittering_sparks';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (71718,72040) AND `ScriptName`='spell_taldaram_summon_flame_ball';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (55891,55947) AND `ScriptName`='spell_taldaram_flame_ball_visual';
+DELETE FROM `spell_script_names` WHERE `spell_id` IN (71756,72782,72783,72784) AND `ScriptName`='spell_taldaram_ball_of_inferno_flame';
+DELETE FROM `spell_script_names` WHERE `spell_id`=72080 AND `ScriptName`='spell_valanar_kinetic_bomb';
+DELETE FROM `spell_script_names` WHERE `spell_id`=72087 AND `ScriptName`='spell_valanar_kinetic_bomb_knockback';
+DELETE FROM `spell_script_names` WHERE `spell_id`=73001 AND `ScriptName`='spell_blood_council_shadow_prison';
+DELETE FROM `spell_script_names` WHERE `spell_id`=72999 AND `ScriptName`='spell_blood_council_shadow_prison_damage';
+DELETE FROM `spell_script_names` WHERE `spell_id`=69538 AND `ScriptName`='spell_rotface_little_ooze_combine';
+DELETE FROM `spell_script_names` WHERE `spell_id`=69553 AND `ScriptName`='spell_rotface_large_ooze_combine';
+DELETE FROM `spell_script_names` WHERE `ScriptName`='spell_festergut_blighted_spores';
+DELETE FROM `spell_script_names` WHERE `ScriptName`='spell_lich_king_play_movie';
+DELETE FROM `spell_script_names` WHERE `ScriptName`='spell_valkyr_carry_can_cast';
+
+INSERT INTO `spell_script_names` (`spell_id`, `ScriptName`) VALUES
+(71412,'spell_putricide_ooze_summon'),
+(71415,'spell_putricide_ooze_summon'),
+(72510,'spell_putricide_mutated_transformation_dismiss'),
+(72509,'spell_putricide_mutated_transformation_dismiss'),
+(72508,'spell_putricide_mutated_transformation_dismiss'),
+(70405,'spell_putricide_mutated_transformation_dismiss'),
+(70308,'spell_putricide_mutation_init'),
+(70311,'spell_putricide_mutated_transformation'),
+(71503,'spell_putricide_mutated_transformation'),
+(74361,'spell_lich_king_valkyr_summon'),
+(70541,'spell_lich_king_infection'),
+(73779,'spell_lich_king_infection'),
+(73780,'spell_lich_king_infection'),
+(73781,'spell_lich_king_infection'),
+(70338,'spell_lich_king_necrotic_plague'),
+(73785,'spell_lich_king_necrotic_plague'),
+(73786,'spell_lich_king_necrotic_plague'),
+(73787,'spell_lich_king_necrotic_plague'),
+(69075,'spell_lord_marrowgar_bone_storm'),
+(70834,'spell_lord_marrowgar_bone_storm'),
+(70835,'spell_lord_marrowgar_bone_storm'),
+(70836,'spell_lord_marrowgar_bone_storm'),
+(70157,'spell_sindragosa_ice_tomb'),
+(70127,'spell_sindragosa_mystic_buffet'),
+(72528,'spell_sindragosa_mystic_buffet'),
+(72529,'spell_sindragosa_mystic_buffet'),
+(72530,'spell_sindragosa_mystic_buffet'),
+(69766,'spell_sindragosa_unchained_magic'),
+(72219,'spell_festergut_gastric_bloat'),
+(72551,'spell_festergut_gastric_bloat'),
+(72552,'spell_festergut_gastric_bloat'),
+(72553,'spell_festergut_gastric_bloat'),
+(69558,'spell_rotface_unstable_explosion'),
+(68981,'spell_lich_king_winter'),
+(74270,'spell_lich_king_winter'),
+(74271,'spell_lich_king_winter'),
+(74272,'spell_lich_king_winter'),
+(70534,'spell_vile_spirit_distance_check'),
+(69110,'spell_ice_burst_distance_check'),
+(72262,'spell_lich_king_quake'),
+(73159,'spell_lich_king_play_movie'),
+(74506,'spell_valkyr_carry_can_cast'),
+(71598,'spell_creature_permanent_feign_death'),
+(71806,'spell_taldaram_glittering_sparks'),
+(71718,'spell_taldaram_summon_flame_ball'),
+(72040,'spell_taldaram_summon_flame_ball'),
+(55891,'spell_taldaram_flame_ball_visual'),
+(55947,'spell_taldaram_flame_ball_visual'),
+(71756,'spell_taldaram_ball_of_inferno_flame'),
+(72782,'spell_taldaram_ball_of_inferno_flame'),
+(72783,'spell_taldaram_ball_of_inferno_flame'),
+(72784,'spell_taldaram_ball_of_inferno_flame'),
+(72080,'spell_valanar_kinetic_bomb'),
+(72087,'spell_valanar_kinetic_bomb_knockback'),
+(73001,'spell_blood_council_shadow_prison'),
+(72999,'spell_blood_council_shadow_prison_damage'),
+(69538,'spell_rotface_little_ooze_combine'),
+(69553,'spell_rotface_large_ooze_combine'),
+(69290,'spell_festergut_blighted_spores'),
+(71222,'spell_festergut_blighted_spores'),
+(73033,'spell_festergut_blighted_spores'),
+(73034,'spell_festergut_blighted_spores');
+
+-- ***_scripts table
+
+UPDATE waypoint_scripts SET delay = 3 WHERE dataint = 38879 AND command = 15;
+DELETE FROM `spell_scripts` WHERE id = 72429 AND command = 15;
+INSERT INTO `spell_scripts` VALUE
+('72429','0','3','15','72423','0','0','0','0','0','0');
+
+SET @LIGHT_S_HAMMER := 70781;
+SET @ORATORY_OF_THE_DAMNED := 70856;
+SET @RAMPART_OF_SKULLS := 70857;
+SET @DEATHBRINGER_S_RISE := 70858;
+SET @UPPER_SPIRE := 70859;
+SET @SINDRAGOSA_S_LAIR := 70861;
+SET @FROZEN_THRONE := 70860;
+
+-- Delete conditions (no longer valid)
+DELETE FROM `conditions` WHERE `SourceTypeOrReferenceId`=13 AND `SourceEntry` IN (@LIGHT_S_HAMMER,@ORATORY_OF_THE_DAMNED,@RAMPART_OF_SKULLS,@DEATHBRINGER_S_RISE,@UPPER_SPIRE,@SINDRAGOSA_S_LAIR,@FROZEN_THRONE);
+
+-- Add target coords
+DELETE FROM `spell_target_position` WHERE `id` IN (@LIGHT_S_HAMMER,@ORATORY_OF_THE_DAMNED,@RAMPART_OF_SKULLS,@DEATHBRINGER_S_RISE,@UPPER_SPIRE,@SINDRAGOSA_S_LAIR,@FROZEN_THRONE);
+INSERT INTO `spell_target_position` (`id`,`target_map`,`target_position_x`,`target_position_y`,`target_position_z`,`target_orientation`) VALUES
+(@LIGHT_S_HAMMER,631,-17.0711,2211.47,30.0546,3.14159),
+(@ORATORY_OF_THE_DAMNED,631,-503.593,2211.47,62.7621,3.14159),
+(@RAMPART_OF_SKULLS,631,-615.146,2211.47,199.909,0.0),
+(@DEATHBRINGER_S_RISE,631,-549.073,2211.29,539.223,0.0),
+(@UPPER_SPIRE,631,4199.484,2769.323,351.3722,3.124139),
+(@SINDRAGOSA_S_LAIR,631,4356.580,2565.75,220.402,4.71238),
+(@FROZEN_THRONE,631,529.3969,-2124.66,1041.37,3.14159);
+
+-- Event AI Thanks Heisei Project!
+DELETE FROM `creature_ai_scripts` WHERE `creature_id` IN (37868,36791,37863,37886,37934,38068,37698,36701);
+UPDATE `creature_template` SET `AIName`= 'EventAI' WHERE `entry` IN (37868,36791,37863,37886,37934,38068,37698,36701);
+INSERT INTO `creature_ai_scripts` VALUES
+('85021059','37868','0','0','100','7','15000','15000','27000','27000','11','71179','4','0','0','0','0','0','0','0','0','0','Risen Archmage - Cast Mana Void'),
+('85021060','37868','0','0','100','25','15000','15000','27000','27000','11','71741','4','0','0','0','0','0','0','0','0','0','Risen Archmage - Cast Mana Void'),
+('85021061','37868','0','0','100','3','10000','10000','18000','22000','11','70759','0','0','0','0','0','0','0','0','0','0','Risen Archmage - Cast Frostbolt Volley'),
+('85021062','37868','0','0','100','9','10000','10000','18000','22000','11','71889','0','0','0','0','0','0','0','0','0','0','Risen Archmage - Cast Frostbolt Volley'),
+('85021063','37868','0','0','100','5','10000','10000','18000','22000','11','72015','0','0','0','0','0','0','0','0','0','0','Risen Archmage - Cast Frostbolt Volley'),
+('85021064','37868','0','0','100','17','10000','10000','18000','22000','11','72016','0','0','0','0','0','0','0','0','0','0','Risen Archmage - Cast Frostbolt Volley'),
+('85021065','37868','0','0','100','31','18000','18000','28000','28000','11','70602','4','0','0','0','0','0','0','0','0','0','Risen Archmage - Cast Corruption'),
+('85021066','38068','0','0','100','30','30000','30000','0','0','37','0','0','1','0','0','0','0','0','0','0','0', 'Mana Void - Self Destruct'),
+('80021007','36791','0','0','100','7','8000','8000','22000','25000','11','69325','0','1','0','0','0','0','0','0','0','0','Blazing Skeleton - Casts Lay Waste'),
+('80021008','36791','0','0','100','25','8000','8000','22000','25000','11','71730','0','1','0','0','0','0','0','0','0','0','Blazing Skeleton - Casts Lay Waste'),
+('80021009','36791','0','0','100','6','0','0','0','0','21','0','0','0','0','0','0','0','0','0','0','0','Blazing Skeleton - Stop Movement on Aggro'),
+('80021010','36791','4','0','100','6','0','0','0','0','11','70754','1','0','22','6','0','0','0','0','0','0','Blazing Skeleton - Cast Fireball and Set Phase 1 on Aggro'),
+('80021011','36791','3','0','100','6','15','0','0','0','21','1','0','0','22','5','0','0','0','0','0','0','Blazing Skeleton - Start Movement and Set Phase 2 when Mana is at 15%'),
+('80021012','36791','0','6','100','7','0','0','1500','3000','11','70754','1','0','0','0','0','0','0','0','0','0','Blazing Skeleton - Cast Fireball above 15% Mana (Phase 1)'),
+('80021013','36791','3','5','100','6','100','28','0','0','21','0','0','0','22','6','0','0','0','0','0','0','Blazing Skeleton - Set Ranged Movement and Set Phase 1 when Mana is above 28% (Phase 2)'),
+('80021014','36791','9','0','100','7','30','50','0','0','22','1','0','0','0','0','0','0','0','0','0','0','Blazing Skeleton - Start Movement Beyond 30 Yards'),
+('80021015','36791','7','0','100','6','0','0','0','0','22','0','0','0','0','0','0','0','0','0','0','0','Blazing Skeleton - On Evade set Phase to 0'),
+('80021016','36791','0','0','100','24','0','0','0','0','21','0','0','0','0','0','0','0','0','0','0','0','Blazing Skeleton - Stop Movement on Aggro'),
+('80021017','36791','4','0','100','24','0','0','0','0','11','71748','1','0','22','6','0','0','0','0','0','0','Blazing Skeleton - Cast Fireball and Set Phase 1 on Aggro'),
+('80021018','36791','3','0','100','24','15','0','0','0','21','1','0','0','22','5','0','0','0','0','0','0','Blazing Skeleton - Start Movement and Set Phase 2 when Mana is at 15%'),
+('80021019','36791','0','6','100','25','0','0','1500','3000','11','71748','1','0','0','0','0','0','0','0','0','0','Blazing Skeleton - Cast Fireball above 15% Mana (Phase 1)'),
+('80021020','36791','3','5','100','24','100','28','0','0','21','0','0','0','22','6','0','0','0','0','0','0','Blazing Skeleton - Set Ranged Movement and Set Phase 1 when Mana is above 28% (Phase 2)'),
+('80021021','36791','9','0','100','25','30','50','0','0','22','1','0','0','0','0','0','0','0','0','0','0','Blazing Skeleton - Start Movement Beyond 30 Yards'),
+('80021022','36791','7','0','100','24','0','0','0','0','22','0','0','0','0','0','0','0','0','0','0','0','Blazing Skeleton - On Evade set Phase to 0'),
+('86021086','37863','4','0','100','30','0','0','0','0','11','70588','1','0','0','0','0','0','0','0','0','0','Suppresser - Cast Suppression'),
+('82021033','37886','0','0','100','7','10000','11000','22000','28000','11','70633','4','0','0','0','0','0','0','0','0','0','Gluttonous Abomination - Casts Gut Spray'),
+('82021034','37886','0','0','100','25','10000','11000','22000','28000','11','71283','4','0','0','0','0','0','0','0','0','0','Gluttonous Abomination - Casts Gut Spray'),
+('82021035','37886','6','0','100','30','0','0','0','0','11','70675','0','2','0','0','0','0','0','0','0','0', 'Gluttonous Abomination - Casts on death Summon Rot Worm'),
+('80021026','37934','2','0','100','7','10','0','12300','14900','11','70744','0','0','0','0','0','0','0','0','0','0','Blistering Zombie - Casts Acid Burst at 10% HP'),
+('80021027','37934','2','0','100','25','10','0','12300','14900','11','71733','0','0','0','0','0','0','0','0','0','0','Blistering Zombie - Casts Acid Burst at 10% HP'),
+('85021075','37698','2','0','100','6','25','0','0','0','11','72143','0','0','1','-106','0','0','0','0','0','0','Shambling Horror - Casts Enrage at 25% HP'),
+('85021076','37698','2','0','100','24','25','0','0','0','11','72146','0','0','1','-106','0','0','0','0','0','0','Shambling Horror - Casts Enrage at 25% HP'),
+('85021077','37698','0','0','100','7','7000','9000','15000','17000','11','72149','0','0','0','0','0','0','0','0','0','0','Shambling Horror - Casts Shockwave'),
+('85021078','37698','0','0','100','25','7000','9000','15000','17000','11','73794','0','0','0','0','0','0','0','0','0','0','Shambling Horror - Casts Shockwave'),
+('85021054','36701','0','0','100','7','10000','10000','25000','35000','11','69242','0','0','0','0','0','0','0','0','0','0','Raging Spirit - Cast Soul Shriek'),
+('85021055','36701','0','0','100','25','10000','10000','25000','35000','11','73800','0','0','0','0','0','0','0','0','0','0','Raging Spirit - Cast Soul Shriek');
diff --git a/sql/ICC/FULL_world_spell_proc_event.sql b/sql/ICC/FULL_world_spell_proc_event.sql
new file mode 100644
index 0000000..4d89112
--- /dev/null
+++ b/sql/ICC/FULL_world_spell_proc_event.sql
@@ -0,0 +1,53 @@
+﻿DELETE FROM `spell_proc_event` WHERE `entry` IN (70107);
+INSERT INTO `spell_proc_event` VALUES (70107, 0x08, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000054, 0x00000000, 0, 20, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (69762);
+INSERT INTO `spell_proc_event` VALUES (69762, 0x00, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00014000, 0x00000000, 0, 101, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72178);
+INSERT INTO `spell_proc_event` VALUES (72178, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00055510, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72176);
+INSERT INTO `spell_proc_event` VALUES (72176, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00051154, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (70602);
+INSERT INTO `spell_proc_event` VALUES (70602, 0x20, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x000AAA20, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (71494);
+INSERT INTO `spell_proc_event` VALUES (71494, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0, 101, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72176);
+INSERT INTO `spell_proc_event` VALUES (72176, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00051154, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72178);
+INSERT INTO `spell_proc_event` VALUES (72178, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00055510, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (71604);
+INSERT INTO `spell_proc_event` VALUES (71604, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (70001);
+INSERT INTO `spell_proc_event` VALUES (70001, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (71971);
+INSERT INTO `spell_proc_event` VALUES (71971, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72256);
+INSERT INTO `spell_proc_event` VALUES (72256, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72408);
+INSERT INTO `spell_proc_event` VALUES (72408, 0x01, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000004, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (70672);
+INSERT INTO `spell_proc_event` VALUES (70672, 0x28, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000008, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72455);
+INSERT INTO `spell_proc_event` VALUES (72455, 0x28, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000008, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72832);
+INSERT INTO `spell_proc_event` VALUES (72832, 0x28, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000008, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (72833);
+INSERT INTO `spell_proc_event` VALUES (72833, 0x28, 0x00, 0x00000000, 0x00000000, 0x00000000, 0x00000008, 0x00000000, 0, 100, 0);
+
+DELETE FROM `spell_proc_event` WHERE `entry` IN (70904);
+INSERT INTO `spell_proc_event` VALUES (70904, 0x10, 0x06, 0x00000000, 0x00000000, 0x00000000, 0x00008000, 0x00000000, 0, 100, 0);
\ No newline at end of file
diff --git a/sql/ICC/FULL_world_text.sql b/sql/ICC/FULL_world_text.sql
new file mode 100644
index 0000000..fca4e03
--- /dev/null
+++ b/sql/ICC/FULL_world_text.sql
@@ -0,0 +1,420 @@
+﻿DELETE FROM script_texts WHERE entry <= -1665902 AND entry >= -1666080;
+DELETE FROM script_texts WHERE entry <= -1810001 AND entry >= -1810032;
+
+# 1
+DELETE FROM script_texts WHERE `npc_entry` = 36612;
+INSERT INTO `script_texts` (`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(36612,-1631000,'This is the beginning AND the end, mortals. None may enter the master''s sanctum!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Смертные, ваш путь закончится так и не начавшись! Никто не смеет входить  в Обитель Господина!',16950,1,0,0,'SAY_ENTER_ZONE'),
+(36612,-1631001,'The Scourge will wash over this world as a swarm of death and destruction!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Плеть накроет этот мир волной смерти и разрушения!',16941,1,0,0,'SAY_AGGRO'),
+(36612,-1631002,'BONE STORM!',NULL,NULL, NULL,NULL,NULL,NULL,NULL,'ВИХРЬ КОСТЕЙ!',16946,1,0,0,'SAY_BONE_STORM'),
+(36612,-1631003,'Bound by bone!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Костяная хватка!',16947,1,0,0, 'SAY_BONESPIKE_1'),
+(36612,-1631004,'Stick Around!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Постой-ка тут!',16948,1,0,0,'SAY_BONESPIKE_2'),
+(36612,-1631005,'The only escape is death!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Единственный выход - это СМЕРТЬ!',16949,1,0,0,'SAY_BONESPIKE_3'),
+(36612,-1631006,'More bones for the offering!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Кости, для жертвоприношений!',16942,1,0,0,'SAY_KILL_1'),
+(36612,-1631007,'Languish in damnation!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Сгинь в вечных муках!',16943,1,0,0,'SAY_KILL_2'),
+(36612,-1631008,'I see... only darkness...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Я вижу... лишь тьму',16944,1,0,0,'SAY_DEATH'),
+(36612,-1631009,'THE MASTER''S RAGE COURSES THROUGH ME!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Во мне бушует ярость господина!',16945,1,0,0,'SAY_BERSERK'),
+(36612,-1631010,'Lord Marrowgar creates a whirling storm of bone!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,'Лорд Ребрад распадается, и его кости начинают вращаться',0,3,0,0,'SAY_BONE_STORM_EMOTE');
+
+#2
+DELETE FROM `script_texts` WHERE `entry` BETWEEN -1631028 AND -1631011;
+INSERT INTO `script_texts` (`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(36855,-1631011, 'You have found your way here, because you are among the few gifted with true vision in a world cursed with blindness.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17272,1,0,0, 'SAY_INTRO_1'),
+(36855,-1631012, 'You can see through the fog that hangs over this world like a shroud, and grasp where true power lies.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17273,1,0,0, 'SAY_INTRO_2'),
+(36855,-1631013, 'Fix your eyes upon your crude hands: the sinew, the soft meat, the dark blood coursing within.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16878,1,0,0, 'SAY_INTRO_3'),
+(36855,-1631014, 'It is a weakness; a crippling flaw.... A joke played by the Creators upon their own creations.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17268,1,0,0, 'SAY_INTRO_4'),
+(36855,-1631015, 'The sooner you come to accept your condition as a defect, the sooner you will find yourselves in a position to transcend it.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17269,1,0,0, 'SAY_INTRO_5'),
+(36855,-1631016, 'Through our Master, all things are possible. His power is without limit, and his will unbending.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17270,1,0,0, 'SAY_INTRO_6'),
+(36855,-1631017, 'Those who oppose him will be destroyed utterly, and those who serve -- who serve wholly, unquestioningly, with utter devotion of mind and soul -- elevated to heights beyond your ken.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17271,1,0,0, 'SAY_INTRO_7'),
+(36855,-1631018, 'What is this disturbance?! You dare trespass upon this hallowed ground? This shall be your final resting place.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16868,1,0,0, 'SAY_AGGRO'),
+(36855,-1631019, 'Enough! I see I must take matters into my own hands!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16877,1,0,0, 'SAY_PHASE_2'),
+(36855,-1631020, 'Lady Deathwhisper''s Mana Barrier shimmers and fades away!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0, 'SAY_PHASE_2_EMOTE'),
+(36855,-1631021, 'You are weak, powerless to resist my will!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16876,1,0,0, 'SAY_DOMINATE_MIND'),
+(36855,-1631022, 'Take this blessing and show these intruders a taste of our master''s power.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16873,1,0,0, 'SAY_DARK_EMPOWERMENT'),
+(36855,-1631023, 'I release you from the curse of flesh!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16874,1,0,0, 'SAY_DARK_TRANSFORMATION'),
+(36855,-1631024, 'Arise and exult in your pure form!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16875,1,0,0, 'SAY_ANIMATE_DEAD'),
+(36855,-1631025, 'Do you yet grasp of the futility of your actions?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16869,1,0,0, 'SAY_KILL_1'),
+(36855,-1631026, 'Embrace the darkness... Darkness eternal!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16870,1,0,0, 'SAY_KILL_2'),
+(36855,-1631027, 'This charade has gone on long enough.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16872,1,0,0, 'SAY_BERSERK'),
+(36855,-1631028, 'All part of the masters plan! Your end is... inevitable!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16871,1,0,0, 'SAY_DEATH');
+
+# 3
+INSERT INTO `script_texts` (`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(0,-1665919,'Thank the spirits for you, brothers and sisters. The Skybreaker has already left. Quickly now, to Orgrim''s Hammer! If you leave soon, you may be able to catch them.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0,0,0,''),
+(0,-1665920,'This should be helpin''ya!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,0,0,0,''),
+(0,-1665921,'Aka''Magosh, brave warriors. The alliance is in great number here.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665922,'Captain Saurfang will be pleased to see you aboard Orgrim''s Hammer. Make haste, we will secure the area until you are ready for take-off.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665923,'A screeching cry pierces the air above!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665924,'A Spire Frostwyrm lands just before Orgrim''s Hammer.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665925,'Rise up, sons and daughters of the Horde! Today we battle a hated enemy of the Horde! LOK''TAR OGAR! Kor''kron, take us out!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665926,'What is that?! Something approaching in the distance!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665927,'ALLIANCE GUNSHIP! ALL HANDS ON DECK!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665928,'Move yer jalopy or we''ll blow it out of the sky, orc! The Horde''s got no business here!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665929,'You will know our business soon! KOR''KRON, ANNIHILATE THEM!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665930,'Marines, Sergeants, attack!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665931,'You DARE board my ship? Your death will come swiftly.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665932,'Riflemen, shoot faster!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665933,'Mortar team, reload!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665934,'We''re taking hull damage, get a sorcerer out here to shut down those cannons!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665935,'The Alliance falter. Onward to the Lich King!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665936,'Damage control! Put those fires out! You haven''t seen the last of the Horde!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665937,'Thank goodness you arrived when you did, heroes. Orgrim''s Hammer has already left. Quickly now, to The Skybreaker! If you leave soon, you may be able to catch them.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665938,'This ought to help!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665939,'Skybreaker Sorcerer summons a Skybreaker Battle Standard.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665940,'You have my thanks. We were outnumbered until you arrived.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665941,'Captain Muradin is waiting aboard The Skybreaker. We''ll secure the area until you are ready for take off.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665942,'Skybreaker infantry, hold position!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665943,'A screeching cry pierces the air above!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665944,'A Spire Frostwyrm lands just before The Skybreaker. ',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665945,'Fire up the engines! We got a meetin with destiny, lads!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665946,'Hold on to yer hats!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665947,'What in the world is that? Grab me spyglass, crewman!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665948,'By me own beard! HORDE SAILIN IN FAST N HOT!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665949,'EVASIVE ACTION! MAN THE GUNS!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665950,'Cowardly dogs! Ye blindsighted us!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665951,'This is not your battle, dwarf. Back down or we will be forced to destroy your ship.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665952,'Not me battle? I dunnae who ye? think ye are, mister, but I got a score to settle with Arthas and yer not gettin in me way! FIRE ALL GUNS! FIRE! FIRE!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665953,'Reavers, Sergeants, attack!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665954,'What''s this then?! Ye won''t be takin this son o Ironforge''s vessel without a fight!.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665955,'Axethrowers, hurl faster!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665956,'Rocketeers, reload!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665957,'We''re taking hull damage, get a battle-mage out here to shut down those cannons!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665958,'Don''t say I didn''t warn ya, scoundrels! Onward, brothers and sisters!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,''),
+(0,-1665959,'Captain Bartlett, get us out of here! We''re taken too much damage to stay afloat!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,1,0,0,'');
+
+# 4
+DELETE FROM `script_texts` WHERE `entry` BETWEEN -1631077 AND -1631029;
+INSERT INTO `script_texts` (`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(37200,-1631029, 'Let''s get a move on then! Move ou...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16974,1,0,0, 'SAY_INTRO_ALLIANCE_1'),
+(37813,-1631030, 'For every Horde soldier that you killed -- for every Alliance dog that fell, the Lich King''s armies grew. Even now the val''kyr work to raise your fallen as Scourge.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16701,1,0,0, 'SAY_INTRO_ALLIANCE_2'),
+(37813,-1631031, 'Things are about to get much worse. Come, taste the power that the Lich King has bestowed upon me!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16702,1,0,0, 'SAY_INTRO_ALLIANCE_3'),
+(37200,-1631032, 'A lone orc against the might of the Alliance???',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16970,1,0,0, 'SAY_INTRO_ALLIANCE_4'),
+(37200,-1631033, 'Charge!!!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16971,1,0,0, 'SAY_INTRO_ALLIANCE_5'),
+(37813,-1631034, 'Dwarves...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16703,1,0,0, 'SAY_INTRO_ALLIANCE_6'),
+(37813,-1631035, 'Deathbringer Saurfang immobilizes Muradin and his guards.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,2,0,0, 'SAY_INTRO_ALLIANCE_7'),
+(37187,-1631036, 'Kor''kron, move out! Champions, watch your backs. The Scourge have been...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17103,1,0,22, 'SAY_INTRO_HORDE_1'),
+(37813,-1631037, 'Join me, father. Join me and we will crush this world in the name of the Scourge -- for the glory of the Lich King!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16704,1,0,0, 'SAY_INTRO_HORDE_2'),
+(37187,-1631038, 'My boy died at the Wrath Gate. I am here only to collect his body.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17097,0,0,397, 'SAY_INTRO_HORDE_3'),
+(37813,-1631039, 'Stubborn and old. What chance do you have? I am stronger, and more powerful than you ever were.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16705,1,0,5, 'SAY_INTRO_HORDE_4'),
+(37187,-1631040, 'We named him Dranosh. It means "Heart of Draenor" in orcish. I would not let the warlocks take him. My boy would be safe, hidden away by the elders of Garadar.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17098,0,0,1, 'SAY_INTRO_HORDE_5'),
+(37187,-1631041, 'I made a promise to his mother before she died; that I would cross the Dark Portal alone - whether I lived or died, my son would be safe. Untainted...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17099,0,0,1, 'SAY_INTRO_HORDE_6'),
+(37187,-1631042, 'Today, I fulfill that promise.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17100,0,0,397, 'SAY_INTRO_HORDE_7'),
+(37187,-1631043, 'High Overlord Saurfang charges!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17104,2,0,53, 'SAY_INTRO_HORDE_8'),
+(37813,-1631044, 'Pathetic old orc. Come then heroes. Come and face the might of the Scourge!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16706,1,0,15, 'SAY_INTRO_HORDE_9'),
+(37813,-1631045, 'BY THE MIGHT OF THE LICH KING!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16694,1,0,0, 'SAY_AGGRO'),
+(37813,-1631046, 'The ground runs red with your blood!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16699,1,0,0, 'SAY_MARK_OF_THE_FALLEN_CHAMPION'),
+(37813,-1631047, 'Feast, my minions!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16700,1,0,0, 'SAY_BLOOD_BEASTS'),
+(37813,-1631048, 'You are nothing!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16695,1,0,0, 'SAY_KILL_1'),
+(37813,-1631049, 'Your soul will find no redemption here!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16696,1,0,0, 'SAY_KILL_2'),
+(37813,-1631050, 'Deathbringer Saurfang goes into frenzy!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0, 'SAY_FRENZY'),
+(37813,-1631051, 'I have become...DEATH!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16698,1,0,0, 'SAY_BERSERK'),
+(37813,-1631052, 'I... Am... Released.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16697,1,0,0, 'SAY_DEATH'),
+(37200,-1631053, 'Muradin Bronzebeard gasps for air.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16975,2,0,0, 'SAY_OUTRO_ALLIANCE_1'),
+(37200,-1631054, 'That was Saurfang''s boy - the Horde commander at the Wrath Gate. Such a tragic end...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16976,0,0,0, 'SAY_OUTRO_ALLIANCE_2'),
+(37200,-1631055, 'What in the... There, in the distance!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16977,0,0,0, 'SAY_OUTRO_ALLIANCE_3'),
+(    0,-1631056, 'A Horde Zeppelin flies up to the rise.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,2,0,0, 'SAY_OUTRO_ALLIANCE_4'),
+(37200,-1631057, 'Soldiers, fall in! Looks like the Horde are comin'' to take another shot!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16978,1,0,0, 'SAY_OUTRO_ALLIANCE_5'),
+(    0,-1631058, 'The Zeppelin docks, and High Overlord Saurfang hops out, confronting the Alliance soldiers and Muradin',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,2,0,0, 'SAY_OUTRO_ALLIANCE_6'),
+(37200,-1631059, 'Don''t force me hand, orc. We can''t let ye pass.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16972,0,0,0, 'SAY_OUTRO_ALLIANCE_7'),
+(37187,-1631060, 'Behind you lies the body of my only son. Nothing will keep me from him.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17094,0,0,0, 'SAY_OUTRO_ALLIANCE_8'),
+(37200,-1631061, 'I... I can''t do it. Get back on yer ship and we''ll spare yer life.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16973,0,0,0, 'SAY_OUTRO_ALLIANCE_9'),
+(    0,-1631062, 'A mage portal from Stormwind appears between the two and Varian Wrynn and Jaina Proudmoore emerge.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,2,0,0, 'SAY_OUTRO_ALLIANCE_10'),
+(37879,-1631063, 'Stand down, Muradin. Let a grieving father pass.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16690,0,0,0, 'SAY_OUTRO_ALLIANCE_11'),
+(37187,-1631064, 'High Overlord Saurfang walks over to his son and kneels before his son''s body.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,2,0,0, 'SAY_OUTRO_ALLIANCE_12'),
+(37187,-1631065, '[Orcish] No''ku kil zil''nok ha tar.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17096,0,0,0, 'SAY_OUTRO_ALLIANCE_13'),
+(37187,-1631066, 'Higher Overlord Saurfang picks up the body of his son and walks over towards Varian',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,2,0,0, 'SAY_OUTRO_ALLIANCE_14'),
+(37187,-1631067, 'I will not forget this... kindness. I thank you, Highness',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17095,0,0,0, 'SAY_OUTRO_ALLIANCE_15'),
+(37879,-1631068, 'I... I was not at the Wrath Gate, but the soldiers who survived told me much of what happened. Your son fought with honor. He died a hero''s death. He deserves a hero''s burial.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16691,0,0,0, 'SAY_OUTRO_ALLIANCE_16'),
+(37188,-1631069, 'Lady Jaina Proudmoore cries.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16651,2,0,18, 'SAY_OUTRO_ALLIANCE_17'),
+(37879,-1631070, 'Jaina? Why are you crying?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16692,0,0,0, 'SAY_OUTRO_ALLIANCE_18'),
+(37188,-1631071, 'It was nothing, your majesty. Just... I''m proud of my king.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16652,0,0,0, 'SAY_OUTRO_ALLIANCE_19'),
+(37879,-1631072, 'Bah! Muradin, secure the deck and prepare our soldiers for an assault on the upper citadel. I''ll send out another regiment from Stormwind.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16693,0,0,0, 'SAY_OUTRO_ALLIANCE_20'),
+(37200,-1631073, 'Right away, yer majesty!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16979,0,0,0, 'SAY_OUTRO_ALLIANCE_21'),
+(37187,-1631074, 'High Overlord Saurfang coughs.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17105,2,0,0, 'SAY_OUTRO_HORDE_1'),
+(37187,-1631075, 'High Overlord Saurfang weeps over the corpse of his son.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17106,2,0,15, 'SAY_OUTRO_HORDE_2'),
+(37187,-1631076, 'You will have a proper ceremony in Nagrand next to the pyres of your mother and ancestors.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17101,0,0,0, 'SAY_OUTRO_HORDE_3'),
+(37187,-1631077, 'Honor, young heroes... no matter how dire the battle... Never forsake it!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17102,0,0,0, 'SAY_OUTRO_HORDE_4');
+
+# 5
+DELETE FROM `script_texts` WHERE `entry` BETWEEN -1631090 AND -1631078;
+INSERT INTO `script_texts` (`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(36626,-1631078, 'NOOOO! You kill Stinky! You pay!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16907,1,0,0, 'SAY_STINKY_DEAD'),
+(36626,-1631079, 'Fun time!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16901,1,0,0, 'SAY_AGGRO'),
+(36678,-1631080, 'Just an ordinary gas cloud. But watch out, because that''s no ordinary gas cloud!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17119,1,0,432, 'SAY_GASEOUS_BLIGHT'),
+(36626,-1631081, 'Festergut farts.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16911,2,0,0, 'EMOTE_GAS_SPORE'),
+(36626,-1631082, 'Festergut releases Gas Spores!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0, 'EMOTE_WARN_GAS_SPORE'),
+(36626,-1631083, 'Gyah! Uhhh, I not feel so good...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16906,1,0,0, 'SAY_PUNGENT_BLIGHT'),
+(36626,-1631084, 'Festergut begins to cast |cFFFF7F00Pungent Blight!|r',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0, 'EMOTE_WARN_PUNGENT_BLIGHT'),
+(36626,-1631085, 'Festergut vomits.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,2,0,0, 'EMOTE_PUNGENT_BLIGHT'),
+(36626,-1631086, 'Daddy, I did it!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16902,1,0,0, 'SAY_KILL_1'),
+(36626,-1631087, 'Dead, dead, dead!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16903,1,0,0, 'SAY_KILL_2'),
+(36626,-1631088, 'Fun time over!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16905,1,0,0, 'SAY_BERSERK'),
+(36626,-1631089, 'Da ... Ddy...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16904,1,0,0, 'SAY_DEATH'),
+(36678,-1631090, 'Oh, Festergut. You were always my favorite. Next to Rotface. The good news is you left behind so much gas, I can practically taste it!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17124,1,0,0, 'SAY_FESTERGUT_DEATH');
+
+# 6
+DELETE FROM `script_texts` WHERE `entry` BETWEEN -1631103 AND -1631091;
+INSERT INTO `script_texts` (`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(36678,-1631091,'Great news, everyone! The slime is flowing again!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17126,1,0,1,'SAY_ROTFACE_OOZE_FLOOD1'),
+(36678,-1631092,'Good news, everyone! I''ve fixed the poison slime pipes!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17123,1,0,1,'SAY_ROTFACE_OOZE_FLOOD2'),
+(36678,-1631093,'Terrible news, everyone, Rotface is dead! But great news everyone, he left behind plenty of ooze for me to use! Whaa...? I''m a poet, and I didn''t know it? Astounding!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17146,1,0,0,'SAY_ROTFACE_DEATH'),
+(36627,-1631094,'What? Precious? Noooooooooo!!!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16993,1,0,0,'SAY_PRECIOUS_DIES'),
+(36627,-1631095,'WEEEEEE!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16986,1,0,0,'SAY_AGGRO'),
+(36627,-1631096,'%s begins to cast Slime Spray!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_SLIME_SPRAY'),
+(36627,-1631097,'Icky sticky.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16991,1,0,0,'SAY_SLIME_SPRAY'),
+(36627,-1631098,'|TInterface\Icons\spell_shadow_unstableaffliction_2.blp:16|t%s begins to cast |cFFFF0000Unstable Ooze Explosion!|r',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_UNSTABLE_EXPLOSION'),
+(36627,-1631099,'I think I made an angry poo-poo. It gonna blow!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16992,1,0,0,'SAY_UNSTABLE_EXPLOSION'),
+(36627,-1631100,'Daddy make toys out of you!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16988,1,0,0,'SAY_KILL_1'),
+(36627,-1631101,'I brokes-ded it...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16987,1,0,0,'SAY_KILL_2'),
+(36627,-1631102,'Sleepy Time!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16990,1,0,0,'SAY_BERSERK'),
+(36627,-1631103,'Bad news daddy...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16989,1,0,0,'SAY_DEATH');
+
+# 7
+DELETE FROM `script_texts` WHERE `entry` BETWEEN -1631114 AND -1631104;
+INSERT INTO `script_texts` (`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(36678,-1631104,'Good news, everyone! I think I perfected a plague that will destroy all life on Azeroth!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17114,1,0,0,'SAY_AGGRO'),
+(36678,-1631105,'%s begins to cast Unstable Experiment!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_UNSTABLE_EXPERIMENT'),
+(36678,-1631106,'Two oozes, one room! So many delightful possibilities...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17122,1,0,0,'SAY_PHASE_TRANSITION_HEROIC'),
+(36678,-1631107,'Hmm. I don''t feel a thing. Whaa...? Where''d those come from?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17120,1,0,15,'SAY_TRANSFORM_1'),
+(36678,-1631108,'Tastes like... Cherry! Oh! Excuse me!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17121,1,0,15,'SAY_TRANSFORM_2'),
+(36678,-1631109,'|TInterface\Icons\inv_misc_herb_evergreenmoss.blp:16|t%s cast |cFF00FF00Malleable Goo!|r',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_MALLEABLE_GOO'),
+(36678,-1631110,'%s cast |cFFFF7F00Choking Gas Bomb!|r',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_CHOKING_GAS_BOMB'),
+(36678,-1631111,'Hmm... Interesting...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17115,1,0,0,'SAY_KILL_1'),
+(36678,-1631112,'That was unexpected!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17116,1,0,0,'SAY_KILL_2'),
+(36678,-1631113,'Great news, everyone!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17118,1,0,0,'SAY_BERSERK'),
+(36678,-1631114,'Bad news, everyone! I don''t think I''m going to make it.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17117,1,0,0,'SAY_DEATH');
+
+# 8
+DELETE FROM `script_texts` WHERE `entry` BETWEEN -1631139 AND -1631115;
+INSERT INTO `script_texts` (`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(38004,-1631115,'Foolish mortals. You thought us defeated so easily? The San''layn are the Lich King''s immortal soldiers! Now you shall face their might combined!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16795,1,0,1,'SAY_INTRO_1'),
+(38004,-1631116,'Rise up, brothers, and destroy our enemies.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16796,1,0,0,'SAY_INTRO_2'),
+(37972,-1631117,'Such wondrous power! The Darkfallen Orb has made me INVINCIBLE!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16727,1,0,0,'SAY_KELESETH_INVOCATION'),
+(37972,-1631118,'Invocation of Blood jumps to Prince Keleseth!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_KELESETH_INVOCATION'),
+(37972,-1631119,'Blood will flow!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16728,1,0,0,'SAY_KELESETH_SPECIAL'),
+(37972,-1631120,'Were you ever a threat?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16723,1,0,0,'SAY_KELESETH_KILL_1'),
+(37972,-1631121,'Truth is found in death.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16724,1,0,0,'SAY_KELESETH_KILL_2'),
+(37972,-1631122,'%s cackles maniacally!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16726,2,0,0,'EMOTE_KELESETH_BERSERK'),
+(37972,-1631123,'My queen... they come...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16725,1,0,0,'SAY_KELESETH_DEATH'),
+(37973,-1631124,'Tremble before Taldaram, mortals, for the power of the orb flows through me!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16857,1,0,0,'SAY_TALDARAM_INVOCATION'),
+(37973,-1631125,'Invocation of Blood jumps to Prince Taldaram!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_TALDARAM_INVOCATION'),
+(37973,-1631126,'Delight in the pain!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16858,1,0,0,'SAY_TALDARAM_SPECIAL'),
+(37973,-1631127,'Inferno Flames speed toward $N!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_TALDARAM_FLAME'),
+(37973,-1631128,'Worm food.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16853,1,0,0,'SAY_TALDARAM_KILL_1'),
+(37973,-1631129,'Beg for mercy!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16854,1,0,0,'SAY_TALDARAM_KILL_2'),
+(37973,-1631130,'%s laughs.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16856,2,0,0,'EMOTE_TALDARAM_BERSERK'),
+(37973,-1631131,'%s gurgles and dies.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16855,2,0,0,'EMOTE_TALDARAM_DEATH'),
+(37970,-1631132,'Naxxanar was merely a setback! With the power of the orb, Valanar will have his vengeance!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16685,1,0,0,'SAY_VALANAR_INVOCATION'),
+(37970,-1631133,'Invocation of Blood jumps to Prince Valanar!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_VALANAR_INVOCATION'),
+(37970,-1631134,'My cup runneth over.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16686,1,0,0,'SAY_VALANAR_SPECIAL'),
+(37970,-1631135,'%s begins casting Empowered Schock Vortex!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,0,3,0,0,'EMOTE_VALANAR_SHOCK_VORTEX'),
+(37970,-1631136,'Dinner... is served.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16681,1,0,0,'SAY_VALANAR_KILL_1'),
+(37970,-1631137,'Do you see NOW the power of the Darkfallen?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16682,1,0,0,'SAY_VALANAR_KILL_2'),
+(37970,-1631138,'BOW DOWN BEFORE THE SAN''LAYN!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16684,1,0,0,'SAY_VALANAR_BERSERK'),
+(37970,-1631139,'...why...?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16683,1,0,0,'SAY_VALANAR_DEATH');
+
+# 9
+INSERT INTO `script_texts`(`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(37955,-1666053,'Is that all you got?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16791,1,0,0,''),
+(37955,-1666054,'You have made an... unwise... decision.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16782,1,0,0,''),
+(37955,-1666055,'Just a taste...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16783,1,0,0,''),
+(37955,-1666056,'Know my hunger!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16784,1,0,0,''),
+(37955,-1666057,'SUFFER!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16786,1,0,0,''),
+(37955,-1666058,'Can you handle this?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16787,1,0,0,''),
+(37955,-1666059,'Yes... feed my precious one! You''re mine now! ',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16790,1,0,0,''),
+(37955,-1666060,'Here it comes.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16788,1,0,0,''),
+(37955,-1666061,'THIS ENDS NOW!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16793,1,0,0,''),
+(37955,-1666062,'But... we were getting along... so well...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,16794,1,0,0,'');
+
+# 10
+INSERT INTO `script_texts`(`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(36789,-1666063,'Heroes, lend me your aid! I... I cannot hold them off much longer! You must heal my wounds!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17064,1,0,0,''),
+(36789,-1666064,'I have opened a portal into the Emerald Dream. Your salvation lies within, heroes.',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17068,1,0,0,''),
+(36789,-1666065,'My strength is returning! Press on, heroes!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17070,1,0,0,''),
+(36789,-1666066,'I will not last much longer!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17069,1,0,0,''),
+(36789,-1666067,'Forgive me for what I do! I... cannot... stop... ONLY NIGHTMARES REMAIN!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17072,1,0,0,''),
+(36789,-1666068,'A tragic loss...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17066,1,0,0,''),
+(36789,-1666069,'FAILURES!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17067,1,0,0,''),
+(36789,-1666070,'I am renewed! Ysera grants me the favor to lay these foul creatures to rest!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17071,1,0,0,'');
+
+# 11
+INSERT INTO `script_texts`(`npc_entry`,`entry`,`content_default`,`content_loc1`,`content_loc2`,`content_loc3`,`content_loc4`,`content_loc5`,`content_loc6`,`content_loc7`,`content_loc8`,`sound`,`type`,`language`,`emote`,`comment`) VALUES
+(36853,-1666071,'You are fools to have come to this place! The icy winds of Northrend will consume your souls!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17007,1,0,0,''),
+(36853,-1666072,'Suffer, mortals, as your pathetic magic betrays you!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17014,1,0,0,''),
+(36853,-1666073,'Can you feel the cold hand of death upon your heart?',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17013,1,0,0,''),
+(36853,-1666074,'Aaah! It burns! What sorcery is this?!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17015,1,0,0,''),
+(36853,-1666075,'Your incursion ends here! None shall survive!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17012,1,0,0,''),
+(36853,-1666076,'Now feel my master''s limitless power and despair!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17016,1,0,0,''),
+(36853,-1666077,'Perish!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17008,1,0,0,''),
+(36853,-1666078,'A flaw of mortality...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17009,1,0,0,''),
+(36853,-1666079,'Enough! I tire of these games!',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17011,1,0,0,''),
+(36853,-1666080,'Free...at last...',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,17010,1,0,0,'');
+
+# 12
+INSERT INTO script_texts (npc_entry,entry,content_default,content_loc1,content_loc2,content_loc3,content_loc4,content_loc5,content_loc6,content_loc7,content_loc8,sound,type,language,emote,comment)VALUES
+(36597,-1810001, 'So...the Light''s vaunted justice has finally arrived. Shall I lay down Frostmourne and throw myself at your mercy, Fordring?',null,null,null,null,null,null,null,null,17349,1,0,0,''),
+(38995,-1810002, 'We will grant you a swift death, Arthas. More than can be said for the thousands you''ve tortured and slain.',null,null,null,null,null,null,null,null,17390,1,0,0,''),
+(36597,-1810003, 'You will learn of that first hand. When my work is complete, you will beg for mercy -- and I will deny you. Your anguished cries will be testament to my unbridled power.',null,null,null,null,null,null,null,null,17350,1,0,0,''),
+(38995,-1810004, 'So be it. Champions, attack!',null,null,null,null,null,null,null,null,17391,1,0,0,''),
+(36597,-1810005, 'I''ll keep you alive to witness the end, Fordring. I would not want the Light''s greatest champion to miss seeing this wretched world remade in my image.',null,null,null,null,null,null,null,null,17351,1,0,0,''),
+(38995,-1810006, 'Come then champions, feed me your rage!',null,null,null,null,null,null,null,null,17352,1,0,0,''),
+(36597,-1810007, 'I will freeze you from within until all that remains is an icy husk!',null,null,null,null,null,null,null,null,17369,1,0,0,''),
+(36597,-1810008, 'Apocalypse!',null,null,null,null,null,null,null,null,17371,1,0,0,''),
+(36597,-1810009, 'Bow down before your lord and master!',null,null,null,null,null,null,null,null,17372,1,0,0,''),
+(36597,-1810010, 'Hope wanes!',null,null,null,null,null,null,null,null,17363,1,0,0,''),
+(36597,-1810011, 'The end has come!',null,null,null,null,null,null,null,null,17364,1,0,0,''),
+(36597,-1810012, 'Face now your tragic end!',null,null,null,null,null,null,null,null,17365,1,0,0,''),
+(36597,-1810013, 'No question remains unanswered. No doubts linger. You are Azeroth''s greatest champions! You overcame every challenge I laid before you. My mightiest servants have fallen before your relentless onslaught, your unbridled fury... Is it truly righteousness that drives you? I wonder.',null,null,null,null,null,null,null,null,17353,1,0,0,''),
+(36597,-1810014, 'You trained them well, Fordring. You delivered the greatest fighting force this world has ever known... right into my hands -- exactly as I intended. You shall be rewarded for your unwitting sacrifice.',null,null,null,null,null,null,null,null,17355,1,0,0,''),
+(36597,-1810015, 'Watch now as I raise them from the dead to become masters of the Scourge. They will shroud this world in chaos and destruction. Azeroth''s fall will come at their hands -- and you will be the first to die.',null,null,null,null,null,null,null,null,17356,1,0,0,''),
+(36597,-1810016, 'I delight in the irony.',null,null,null,null,null,null,null,null,17357,1,0,0,''),
+(38995,-1810017, 'LIGHT, GRANT ME ONE FINAL BLESSING. GIVE ME THE STRENGTH... TO SHATTER THESE BONDS!',null,null,null,null,null,null,null,null,17392,1,0,0,''),
+(36597,-1810018, 'Impossible...',null,null,null,null,null,null,null,null,17358,1,0,0,''),
+(38995,-1810020, 'No more, Arthas! No more lives will be consumed by your hatred!',null,null,null,null,null,null,null,null,17393,1,0,0,''),
+(38579,-1810021, 'Free at last! It is over, my son. This is the moment of reckoning.',null,null,null,null,null,null,null,null,17397,1,0,0,''),
+(38995,-1810022, 'The Lich King must fall!',null,null,null,null,null,null,null,null,17389,1,0,0,''),
+(38579,-1810023, 'Rise up, champions of the Light!',null,null,null,null,null,null,null,null,17398,1,0,0,''),
+(36597,-1810024, 'Now I stand, the lion before the lambs... and they do not fear.',null,null,null,null,null,null,null,null,17361,1,0,0,''),
+(36597,-1810025, 'They cannot fear.',null,null,null,null,null,null,null,null,17362,1,0,0,''),
+(0,-1810026, 'Argh... Frostmourne, obey me!',null,null,null,null,null,null,null,null,17367,1,0,0,''),
+(36597,-1810027, 'Frostmourne hungers...',null,null,null,null,null,null,null,null,17366,1,0,0,''),
+(0,-1810028, 'Frostmourne feeds on the soul of your fallen ally!',null,null,null,null,null,null,null,null,17368,1,0,0,''),
+(36597,-1810029, 'Val''kyr, your master calls!',null,null,null,null,null,null,null,null,17373,1,0,0,''),
+(36597,-1810030, 'Watch as the world around you collapses!',null,null,null,null,null,null,null,null,17370,1,0,0,''),
+(36597,-1810031, 'You gnats actually hurt me! Perhaps I''ve toyed with you long enough, now taste the vengeance of the grave!',null,null,null,null,null,null,null,null,17359,1,0,0,''),
+(36597,-1810032, 'The Lich King begins to cast Defile',null,null,null,null,null,null,null,null,0,3,0,0,'');
+
+# Locale
+
+# Леди
+
+UPDATE `script_texts` SET `content_loc8`='Вы здесь потому, что наделены особым знанием: вы понимаете, что на мир пало проклятье слепоты!' WHERE `entry`=-1631011;
+UPDATE `script_texts` SET `content_loc8`='Вам удалось сквозь пелену лжи разглядеть источник истиной силы!' WHERE `entry`=-1631012;
+UPDATE `script_texts` SET `content_loc8`='Посмотрите на свои руки, задумайтесь над нелепостью их строения!' WHERE `entry`=-1631013;
+UPDATE `script_texts` SET `content_loc8`='Кожа, мускулы, кровь, что пульсирует в жилах, все это говорит о вашем не совершенстве, вашей слабостью. Создатели жестоко пошутили над вами!' WHERE `entry`=-1631014;
+UPDATE `script_texts` SET `content_loc8`='Чем раньше вы осознаете собственную ущербность, тем скорее выберете иной путь!' WHERE `entry`=-1631015;
+UPDATE `script_texts` SET `content_loc8`='Для нашего господина нет ничего невозможного, его сила не знает границ, ничто не может сломить его волю!' WHERE `entry`=-1631016;
+UPDATE `script_texts` SET `content_loc8`='Тот, кто откажется повиноваться будет уничтожен. Тот же, кто будет служить ему верой и правдой, достигнет таких высот, о которых вы не в силах даже помыслить!' WHERE `entry`=-1631017;
+UPDATE `script_texts` SET `content_loc8`='Как вы смеете ступать в эти священные покои, это место станет вашей могилой!' WHERE `entry`=-1631018;
+UPDATE `script_texts` SET `content_loc8`='Довольно! Пришла пора взять все в свои руки!' WHERE `entry`=-1631019;
+UPDATE `script_texts` SET `content_loc8`='Прими это благословение и покажи чужакам мощь нашего господина!' WHERE `entry`=-1631022;
+UPDATE `script_texts` SET `content_loc8`='Я освобождаю тебя от проклятья плоти, мой верный слуга!' WHERE `entry`=-1631023;
+UPDATE `script_texts` SET `content_loc8`='Восстань и обрети истинную форму!' WHERE `entry`=-1631024;
+UPDATE `script_texts` SET `content_loc8`='Ты не в силах противится моей воле!' WHERE `entry`=-1631021;
+UPDATE `script_texts` SET `content_loc8`='Мне надоел этот фарс!' WHERE `entry`=-1631027;
+UPDATE `script_texts` SET `content_loc8`='На все воля господина...Ваша смерть неизбежна...' WHERE `entry`=-1631028;
+UPDATE `script_texts` SET `content_loc8`='Вы осознали бессмысленность своих действий?' WHERE `entry`=-1631025;
+UPDATE `script_texts` SET `content_loc8`='Ступай во тьму... Вечную тьму!' WHERE `entry`=-1631026;
+
+# Саурфанг
+
+UPDATE `script_texts` SET `content_loc8`='ВО ИМЯ КОРОЛЯ-ЛИЧА!' WHERE `entry`=-1631045;
+UPDATE `script_texts` SET `content_loc8`='Земля обагрится вашей кровью!' WHERE `entry`=-1631046;
+UPDATE `script_texts` SET `content_loc8`='Веселитесь, слуги мои!' WHERE `entry`=-1631047;
+UPDATE `script_texts` SET `content_loc8`='Ты ничтожество!' WHERE `entry`=-1631048;
+UPDATE `script_texts` SET `content_loc8`='Твоя душа не обретет покоя!' WHERE `entry`=-1631049;
+UPDATE `script_texts` SET `content_loc8`='Я... Cтал СМЕРТЬЮ!' WHERE `entry`=-1631051;
+UPDATE `script_texts` SET `content_loc8`='Я... Освободился.' WHERE `entry`=-1631052;
+UPDATE `script_texts` SET `content_loc8`='Все павшие войны Орды. Все дохлые псы Альянса. Все пополнят Армию Короля-лича. Даже сейчас Валь`киры воскрешают ваших покойников, чтобы те стали частью Плети!' WHERE `entry`=-1631030;
+UPDATE `script_texts` SET `content_loc8`='Сейчас всё будет ещё хуже. Идите сюда, я покажу вам какой силой меня наделил Король-лич!' WHERE `entry`=-1631031;
+UPDATE `script_texts` SET `content_loc8`='Ха-ха-ха! Дворфы...' WHERE `entry`=-1631034;
+UPDATE `script_texts` SET `content_loc8`='Присоеденись ко мне, отец. Перейди на мою сторону, и вместе мы разрушим этот мир во имя Плети и во славу Короля-лича!' WHERE `entry`=-1631037;
+UPDATE `script_texts` SET `content_loc8`='Старый упрямец. У тебя нет шансов! Я сильнее и могущественнее, чем ты можешь представить!' WHERE `entry`=-1631039;
+UPDATE `script_texts` SET `content_loc8`='Жалкий старик! Ну что ж, герои. Хотите узнать, сколь могущественна Плеть?' WHERE `entry`=-1631044;
+UPDATE `script_texts` SET `content_loc8`='Один орк против мощи Альянса?' WHERE `entry`=-1631032;
+UPDATE `script_texts` SET `content_loc8`='Кор''крон, выдвигайтесь! Герои, будьте начеку. Плеть только что...' WHERE `entry`=-1631036;
+UPDATE `script_texts` SET `content_loc8`='Мой мальчик погиб у Врат Гнева. Я здесь, чтобы забрать его тело.' WHERE `entry`=-1631038;
+UPDATE `script_texts` SET `content_loc8`='Мы назвали его Дранош - на орочьем это значит "Сердце Дренора". Я бы не позволил чернокнижникам збрать его. Он был бы в безопасности в Гарадаре под защитой старейшин.' WHERE `entry`=-1631040;
+UPDATE `script_texts` SET `content_loc8`='Я пообещал его матери, когда она умирала, что пройду через Темный Портал один. неважно, умер бы я или выжил - мой сын остался бы цел. И чист...' WHERE `entry`=-1631041;
+UPDATE `script_texts` SET `content_loc8`='Сегодня я исполню это обещание.' WHERE `entry`=-1631042;
+UPDATE `script_texts` SET `content_loc8`='Мы похороним тебя как подобает, в Награнде, рядом с матерью и предками...' WHERE `entry`=-1666002;
+UPDATE `script_texts` SET `content_loc8`='Помните о чести, герои... какой бы жестокой не была битва... никогда не трекайтесь от неё.' WHERE `entry`=-1666003;
+UPDATE `script_texts` SET `content_loc8`='Мурадин защищай палубу, и приготовь солдат к штурму верхних этажей Цитадели. Я вызову из Штормграда подкрепление.' WHERE `entry`=-1665998;
+UPDATE `script_texts` SET `content_loc8`='Отступи, Мурадин. Позволь пройти скорбящему отцу.' WHERE `entry`=-1631063;
+UPDATE `script_texts` SET `content_loc8`='Я... Я не был у Врат Гнева. Но многое узнал от выживших солдат. Твой сын сражался достойно. Он пал смертью героя. И заслуживает погребения с почестями.' WHERE `entry`=-1631068;
+UPDATE `script_texts` SET `content_loc8`='Джайна, почему ты плачешь?' WHERE `entry`=-1631070;
+
+# Гниломорд
+
+UPDATE `script_texts` SET `content_loc8`='Что? Прелесть? Нееееееееееееет!!!' WHERE `entry`=-1631094;
+UPDATE `script_texts` SET `content_loc8`='УУИИИИИИ!' WHERE `entry`=-1631095;
+UPDATE `script_texts` SET `content_loc8`='Отличные новости, народ! Слизь снова потелка!' WHERE `entry`=-1631091;
+UPDATE `script_texts` SET `content_loc8`='Отличные новости, народ! Я починил трубы для подачи ядовитой слизи!' WHERE `entry`=-1631092;
+UPDATE `script_texts` SET `content_loc8`='Папочка сделает новые игрушки из вас!' WHERE `entry`=-1631100;
+UPDATE `script_texts` SET `content_loc8`='Я это заломал...' WHERE `entry`=-1631101;
+UPDATE `script_texts` SET `content_loc8`='Папочка, не огорчайся…' WHERE `entry`=-1631103;
+UPDATE `script_texts` SET `content_loc8`='Я сделал очень злую каку! Сейчас взорвется!' WHERE `entry`=-1631099;
+
+# Тухлопуз
+
+UPDATE `script_texts` SET `content_loc8`='Тухлопуз, ты всегда был моим любимчиком, как и Гниломорд! Молодец, что оставил столько газа. Я его даже чувствую!' WHERE `entry`=-1631090;
+UPDATE `script_texts` SET `content_loc8`='Нет! Вы убили Вонючку! Сейчас получите!' WHERE `entry`=-1631078;
+UPDATE `script_texts` SET `content_loc8`='Повеселимся?' WHERE `entry`=-1631079;
+UPDATE `script_texts` SET `content_loc8`='Что-то мне нехорошо...' WHERE `entry`=-1631083;
+UPDATE `script_texts` SET `content_loc8`='Веселью конец!' WHERE `entry`=-1631088;
+UPDATE `script_texts` SET `content_loc8`='Па-па...' WHERE `entry`=-1631089;
+UPDATE `script_texts` SET `content_loc8`='Мер-твец, мер-твец, мер-твец!' WHERE `entry`=-1631087;
+UPDATE `script_texts` SET `content_loc8`='Папочка! У меня получилось!' WHERE `entry`=-1631086;
+UPDATE `script_texts` SET `content_loc8`='Это обычное облаго газа, только будьте осторожны, не такое уж оно и обычное!' WHERE `entry`=-1631080;
+
+# Профессор Мерзоцоид
+
+UPDATE `script_texts` SET `content_loc8`='Отличные новости, народ! Я усовершенствовал штамм чумы, которая уничтожит весь Азерот!' WHERE `entry`=-1666026;
+UPDATE `script_texts` SET `content_loc8`='Хм, что-то я ничего не чувствую. Что?! Это еще откуда?' WHERE `entry`=-1666029;
+UPDATE `script_texts` SET `content_loc8`='На вкус, как вишенка! ОЙ! Извиниите!' WHERE `entry`=-1666030;
+UPDATE `script_texts` SET `content_loc8`='Плохие новости, народ… Похоже, у меня ничего не выйдет…' WHERE `entry`=-1666034;
+UPDATE `script_texts` SET `content_loc8`='Герои, вы должны мне помочь! Мои силы... на исходе. Залечите мои раны...' WHERE `entry`=-1666063;
+UPDATE `script_texts` SET `content_loc8`='Я открыла портал в Изумруднй Сон. Там вы найдете спасение, герои.' WHERE `entry`=-1666064;
+UPDATE `script_texts` SET `content_loc8`='Силы возвращаются ко мне. Герои, ещё немного!' WHERE `entry`=-1666065;
+UPDATE `script_texts` SET `content_loc8`='Я долго не продержусь!' WHERE `entry`=-1666066;
+UPDATE `script_texts` SET `content_loc8`='Прискорбная потеря...' WHERE `entry`=-1666068;
+UPDATE `script_texts` SET `content_loc8`='Простите меня! Я... не могу... оста... ВСЁ ВО ВЛАСТИ КОШМАРА!' WHERE `entry`=-1666067;
+UPDATE `script_texts` SET `content_loc8`='НЕУДАЧНИКИ!' WHERE `entry`=-16660690;
+UPDATE `script_texts` SET `content_loc8`='Я ИЗЛЕЧИЛАСЬ! Изера, даруй мне силу покончить с этими нечистивыми тварями.' WHERE `entry`=-1666070;
+
+# Синдрагоса
+
+UPDATE `script_texts` SET `content_loc8`='Глупцы, зачем вы сюда явились! Ледяные ветра Нордскола унесут ваши души!' WHERE `entry`=-1666071;
+UPDATE `script_texts` SET `content_loc8`='Трепещите, смертные, ибо ваша жалкая магия теперь бессильна!' WHERE `entry`=-1666072;
+UPDATE `script_texts` SET `content_loc8`='Вы чувствуете?' WHERE `entry`=-1666073;
+UPDATE `script_texts` SET `content_loc8`='Ааах! Жжется! Что это за магия?!' WHERE `entry`=-1666074;
+UPDATE `script_texts` SET `content_loc8`='Сейчас вы почуствуете всю мощь нашего господина!' WHERE `entry`=-1666076;
+UPDATE `script_texts` SET `content_loc8`='Погибни!' WHERE `entry`=-1666077;
+UPDATE `script_texts` SET `content_loc8`='Удел смертных...' WHERE `entry`=-1666078;
+UPDATE `script_texts` SET `content_loc8`='Довольно! Я устала от этих игр!' WHERE `entry`=-1666079;
+UPDATE `script_texts` SET `content_loc8`='Наконец-то...свободна...' WHERE `entry`=-1666080;
+
+# КОРОЛЬ-ЛИЧ
+
+UPDATE `script_texts` SET `content_loc8`='Неужели прибыли наконец хваленые силы Света? Мне бросить Ледяную Скорбь и сдаться на твою милось, Фордринг?' WHERE `entry`=-1810001;
+UPDATE `script_texts` SET `content_loc8`='Мы даруем тебе быструю смерть, Артас. Более быструю, чем ты заслуживаешь за то, что замучал и погубил десятки тысяч душ' WHERE `entry`=-1810002;
+UPDATE `script_texts` SET `content_loc8`='Ты пройдешь через эти мучения сам. И будешь МОЛИТЬ о пощаде, но я не буду слушать. Твои отчаянные крики послужат доказательством моей безграничной мощи.' WHERE `entry`=-1810003;
+UPDATE `script_texts` SET `content_loc8`='Да будет так. Чемпионы, в атаку!' WHERE `entry`=-1810004;
+UPDATE `script_texts` SET `content_loc8`='Я оставлю тебя в живых, чтобы ты увидел финал. Не могу допустить, чтобы величайший служитель Света пропустил рождение МОЕГО МИРА.' WHERE `entry`=-1810005;
+UPDATE `script_texts` SET `content_loc8`='Я проморожу вас насквозь - и вы разлетитесь на ледяные осколки.' WHERE `entry`=-1810007;
+UPDATE `script_texts` SET `content_loc8`='КОНЕЦ СВЕТА!' WHERE `entry`=-1810008;
+UPDATE `script_texts` SET `content_loc8`='Склонись перед своим господином и повелителем!.' WHERE `entry`=-1810009;
+UPDATE `script_texts` SET `content_loc8`='Надежда тает!' WHERE `entry`=-1810010;
+UPDATE `script_texts` SET `content_loc8`='Пришел КОНЕЦ!' WHERE `entry`=-1810011;
+UPDATE `script_texts` SET `content_loc8`='Встречайте трагический финал!' WHERE `entry`=-1810012;
+UPDATE `script_texts` SET `content_loc8`='Сомнений нет, вы величайшие герои Азерота! Вы преодолели все препятствия, которые я воздвиг перед вами. Сильнейшие из моих слуг пали под вашим натиском, сгорели в пламени вашей ярости!' WHERE `entry`=-1810013;
+UPDATE `script_texts` SET `content_loc8`='Ты отлично их обучил, Фордринг! ' WHERE `entry`=-1810014;
+UPDATE `script_texts` SET `content_loc8`='Смотри, как я буду всокрешать их, и превращать в воинов Плети! Они повергнут этот мир в пучину хаоса. Азерот падет от их рук! и ты станешь первой жертвой.' WHERE `entry`=-1810015;
+UPDATE `script_texts` SET `content_loc8`='Мне по душе эта ирония.' WHERE `entry`=-1810016;
+UPDATE `script_texts` SET `content_loc8`='СВЕТ, ДАРУЙ МНЕ ПОСЛЕДНЕЕ БЛАГОСЛОВЛЕНИЕ... ДАЙ МНЕ СИЛЫ РАЗБИТЬ ЭТИ ОКОВЫ!' WHERE `entry`=-1810017;
+UPDATE `script_texts` SET `content_loc8`='Невозможно...' WHERE `entry`=-1810018;
+UPDATE `script_texts` SET `content_loc8`='Аах! Вы меня и правда ранили. Я слишком долго с вами играл! Испытайте на себе Возмездие СМЕРТИ!' WHERE `entry`=-1666080;
+UPDATE `script_texts` SET `content_loc8`='И вот я стою как лев пред агнцами... И не дрожат они.' WHERE `entry`=-1810024;
+UPDATE `script_texts` SET `content_loc8`='Им неведом страх.' WHERE `entry`=-1810025;
+UPDATE `script_texts` SET `content_loc8`='Ну же герои, в вашей ярости моя сила!' WHERE `entry`=-1810006;
+UPDATE `script_texts` SET `content_loc8`='Ледяная Скорбь жаждет крови!' WHERE `entry`=-1810027;
+UPDATE `script_texts` SET `content_loc8`='Ледяная Скорбь поглотит душу вашего товарища.' WHERE `entry`=-1810028;
+UPDATE `script_texts` SET `content_loc8`='Смотрите как мир рушится вокруг вас!' WHERE `entry`=-1810030;
+UPDATE `script_texts` SET `content_loc8`='Валь''кира, твой гсоподин зовет!' WHERE `entry`=-1810029;
+UPDATE `script_texts` SET `content_loc8`='Хватит, Артас! Твоя ненависть не заберет больше ни одной жизни!' WHERE `entry`=-1810020;
+UPDATE `script_texts` SET `content_loc8`='Вы пришли, что бы вершить суд над Артасом? Что бы уничтожить Короля-лича?' WHERE `entry`=-1666080;
+UPDATE `script_texts` SET `content_loc8`='Вы не должны оказаться во власти Ледяной Скорби. Иначе, как и я, будете навек порабощены этим проклятым клинком!' WHERE `entry`=-1666080;
+UPDATE `script_texts` SET `content_loc8`='Помогите мне уничтожить эти истерзанные души! Вместе мы вытянем силу из Ледяной Скорби и ослабим Короля-лича!' WHERE `entry`=-1666080;
+UPDATE `script_texts` SET `content_loc8`='Наконец я свободен! Всё кончено, сын мой... Настал час расплаты!' WHERE `entry`=-1810021;
+UPDATE `script_texts` SET `content_loc8`='Поднимитесь, Воины Света!' WHERE `entry`=-1810023;
+UPDATE `script_texts` SET `content_loc8`='Король-лич падет!' WHERE `entry`=-1810022;
\ No newline at end of file
diff --git a/src/server/game/Entities/Unit/Unit.cpp b/src/server/game/Entities/Unit/Unit.cpp
index 6802974..91e7dc3 100755
--- a/src/server/game/Entities/Unit/Unit.cpp
+++ b/src/server/game/Entities/Unit/Unit.cpp
@@ -7926,6 +7926,15 @@ bool Unit::HandleProcTriggerSpell(Unit *pVictim, uint32 damage, AuraEffect* trig
                             CastSpell(pVictim, 27526, true, castItem, triggeredByAura);
                         return true;
                     }
+                    // Mark of the Fallen Champion
+                    case 72293:
+                        if(pVictim && pVictim->HasAura(72293) && !pVictim->isAlive())
+                        {
+                            Creature* saurfang = pVictim->FindNearestCreature(37813, 500.0f, true);
+                                if(saurfang && saurfang->isAlive())
+                                   saurfang->CastSpell(saurfang, 72260, true);
+                        }
+                        return true;
                 }
                 break;
             case SPELLFAMILY_MAGE:
@@ -8622,10 +8631,6 @@ bool Unit::HandleProcTriggerSpell(Unit *pVictim, uint32 damage, AuraEffect* trig
                 return false;
             break;
         }
-        // Deathbringer Saurfang - Blood Link
-        case 72202:
-            target = FindNearestCreature(37813, 75.0f); // NPC_DEATHBRINGER_SAURFANG = 37813
-            break;
         // Shadow's Fate (Shadowmourne questline)
         case 71169:
         {
diff --git a/src/server/game/Scripting/ScriptLoader.cpp b/src/server/game/Scripting/ScriptLoader.cpp
index ec534b6..291894b 100755
--- a/src/server/game/Scripting/ScriptLoader.cpp
+++ b/src/server/game/Scripting/ScriptLoader.cpp
@@ -463,16 +463,19 @@ void AddSC_instance_halls_of_reflection();   // Halls of Reflection
 void AddSC_halls_of_reflection();
 void AddSC_boss_falric();
 void AddSC_boss_marwyn();
-void AddSC_boss_lord_marrowgar();       // Icecrown Citadel
-void AddSC_boss_lady_deathwhisper();
-void AddSC_boss_deathbringer_saurfang();
+void AddSC_instance_icecrown_citadel(); //Icecrown Citadel
+void AddSC_boss_deathbringer_saurfang();
 void AddSC_boss_festergut();
-void AddSC_boss_rotface();
+void AddSC_boss_lady_deathwhisper();
+void AddSC_boss_lord_marrowgar();
 void AddSC_boss_professor_putricide();
-void AddSC_boss_blood_prince_council();
+void AddSC_boss_sindragosa();
+void AddSC_boss_lichking();
+void AddSC_boss_rotface();
+void AddSC_boss_rat_des_blutes();
+void AddSC_icecrown_citadel();
 void AddSC_boss_blood_queen_lana_thel();
-void AddSC_icecrown_citadel_teleport();
-void AddSC_instance_icecrown_citadel();
+void AddSC_boss_valithria();
 
 void AddSC_dalaran();
 void AddSC_borean_tundra();
@@ -1149,16 +1152,19 @@ void AddNorthrendScripts()
     AddSC_halls_of_reflection();
     AddSC_boss_falric();
     AddSC_boss_marwyn();
-    AddSC_boss_lord_marrowgar();        // Icecrown Citadel
-    AddSC_boss_lady_deathwhisper();
-    AddSC_boss_deathbringer_saurfang();
+    AddSC_instance_icecrown_citadel(); //Icecrown Citadel
+    AddSC_boss_deathbringer_saurfang();
     AddSC_boss_festergut();
-    AddSC_boss_rotface();
+    AddSC_boss_lady_deathwhisper();
+    AddSC_boss_lord_marrowgar();
     AddSC_boss_professor_putricide();
-    AddSC_boss_blood_prince_council();
+    AddSC_boss_sindragosa();
+    AddSC_boss_lichking();
+    AddSC_boss_rotface();
+    AddSC_boss_rat_des_blutes();
+    AddSC_icecrown_citadel();
     AddSC_boss_blood_queen_lana_thel();
-    AddSC_icecrown_citadel_teleport();
-    AddSC_instance_icecrown_citadel();
+    AddSC_boss_valithria();
 
     AddSC_dalaran();
     AddSC_borean_tundra();
diff --git a/src/server/game/Spells/Auras/SpellAuraEffects.cpp b/src/server/game/Spells/Auras/SpellAuraEffects.cpp
index e735632..d808500 100755
--- a/src/server/game/Spells/Auras/SpellAuraEffects.cpp
+++ b/src/server/game/Spells/Auras/SpellAuraEffects.cpp
@@ -1888,6 +1888,8 @@ void AuraEffect::PeriodicTick(AuraApplication * aurApp, Unit * caster) const
                 target->CastSpell((Unit*)NULL , GetAmount() , true);
             break;
         case SPELL_AURA_PERIODIC_DUMMY:
+            if(GetId() == 72178)
+                caster->CastSpell(caster, 72202, true);
             PeriodicDummyTick(target, caster);
             break;
         case SPELL_AURA_PERIODIC_TRIGGER_SPELL:
diff --git a/src/server/game/Spells/Spell.cpp b/src/server/game/Spells/Spell.cpp
index 51498ff..2c3f2a3 100755
--- a/src/server/game/Spells/Spell.cpp
+++ b/src/server/game/Spells/Spell.cpp
@@ -5105,6 +5105,12 @@ SpellCastResult Spell::CheckCast(bool strict)
                     if (m_caster->IsInWater())
                         return SPELL_FAILED_ONLY_ABOVEWATER;
                 }
+				else if (m_spellInfo->Id == 72202) //Blood Link
+				{
+				    Creature* saurfang = m_caster->FindNearestCreature(37813, 500.0f, true);
+					if(saurfang && saurfang->isAlive())
+					    saurfang->CastSpell(saurfang, 72195, true);
+				}
                 else if (m_spellInfo->SpellIconID == 156)    // Holy Shock
                 {
                     // spell different for friends and enemies
diff --git a/src/server/scripts/Northrend/CMakeLists.txt b/src/server/scripts/Northrend/CMakeLists.txt
index cad7688..55dc9c0 100644
--- a/src/server/scripts/Northrend/CMakeLists.txt
+++ b/src/server/scripts/Northrend/CMakeLists.txt
@@ -142,16 +142,20 @@ set(scripts_STAT_SRCS
   Northrend/VioletHold/boss_xevozz.cpp
   Northrend/VioletHold/boss_erekem.cpp
   Northrend/VioletHold/violet_hold.cpp
-  Northrend/IcecrownCitadel/instance_icecrown_citadel.cpp
+  Northrend/IcecrownCitadel/boss_sindragosa.cpp
+  Northrend/IcecrownCitadel/boss_the_lich_king.cpp
+  Northrend/IcecrownCitadel/boss_valithria_dreamwalker.cpp
+  Northrend/IcecrownCitadel/icecrown_citadel.cpp
   Northrend/IcecrownCitadel/icecrown_citadel.h
-  Northrend/IcecrownCitadel/icecrown_citadel_teleport.cpp
-  Northrend/IcecrownCitadel/boss_lord_marrowgar.cpp
-  Northrend/IcecrownCitadel/boss_lady_deathwhisper.cpp
+  Northrend/IcecrownCitadel/instance_icecrown_citadel.cpp
   Northrend/IcecrownCitadel/boss_deathbringer_saurfang.cpp
   Northrend/IcecrownCitadel/boss_festergut.cpp
-  Northrend/IcecrownCitadel/boss_rotface.cpp
+  Northrend/IcecrownCitadel/boss_gunship_battle.cpp
+  Northrend/IcecrownCitadel/boss_lady_deathwhisper.cpp
+  Northrend/IcecrownCitadel/boss_lord_marrowgar.cpp
   Northrend/IcecrownCitadel/boss_professor_putricide.cpp
-  Northrend/IcecrownCitadel/boss_blood_prince_council.cpp
+  Northrend/IcecrownCitadel/boss_rat_des_blutes.cpp
+  Northrend/IcecrownCitadel/boss_rotface.cpp
   Northrend/IcecrownCitadel/boss_blood_queen_lana_thel.cpp
   Northrend/zuldrak.cpp
   Northrend/icecrown.cpp
diff --git a/src/server/scripts/Northrend/IcecrownCitadel/boss_blood_queen_lana_thel.cpp b/src/server/scripts/Northrend/IcecrownCitadel/boss_blood_queen_lana_thel.cpp
index 60cd356..fc8f44d 100644
--- a/src/server/scripts/Northrend/IcecrownCitadel/boss_blood_queen_lana_thel.cpp
+++ b/src/server/scripts/Northrend/IcecrownCitadel/boss_blood_queen_lana_thel.cpp
@@ -1,591 +1,288 @@
-/*
- * Copyright (C) 2008-2010 TrinityCore <http://www.trinitycore.org/>
- *
- * This program is free software; you can redistribute it and/or modify it
- * under the terms of the GNU General Public License as published by the
- * Free Software Foundation; either version 2 of the License, or (at your
- * option) any later version.
- *
- * This program is distributed in the hope that it will be useful, but WITHOUT
- * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
- * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
- * more details.
- *
- * You should have received a copy of the GNU General Public License along
- * with this program. If not, see <http://www.gnu.org/licenses/>.
- */
-
-#include "ObjectMgr.h"
-#include "ScriptMgr.h"
-#include "ScriptedCreature.h"
-#include "SpellScript.h"
-#include "Spell.h"
-#include "SpellAuraEffects.h"
+/* Copyright (C) 2009 - 2010 TrinityCore <http://www.trinitycore.org/>
+*
+* This program is free software; you can redistribute it and/or modify
+* it under the terms of the GNU General Public License as published by
+* the Free Software Foundation; either version 2 of the License, or
+* (at your option) any later version.
+*
+* This program is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+* GNU General Public License for more details.
+*
+* You should have received a copy of the GNU General Public License
+* along with this program; if not, write to the Free Software
+* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
+*/
+
+#include "ScriptPCH.h"
 #include "icecrown_citadel.h"
 
-enum eTexts
+enum Yells
 {
-    SAY_AGGRO                   = 0,
-    SAY_VAMPIRIC_BITE           = 1,
-    SAY_MIND_CONTROL            = 2,
-    EMOTE_BLOODTHIRST           = 3,
-    SAY_SWARMING_SHADOWS        = 4,
-    EMOTE_SWARMING_SHADOWS      = 5,
-    SAY_PACT_OF_THE_DARKFALLEN  = 6,
-    SAY_AIR_PHASE               = 7,
-    SAY_KILL                    = 8,
-    SAY_WIPE                    = 9,
-    SAY_BERSERK                 = 10,
-    SAY_DEATH                   = 11,
+    SAY_AGGRO            = -1666054,
+    SAY_VAMP_BITE_1      = -1666055,
+    SAY_VAMP_BITE_2      = -1666056,
+    SAY_SWARM_SHADOWS    = -1666057,
+    SAY_PACT_DARKFALLEN  = -1666058,
+    SAY_MIND_CONTROLL    = -1666059,
+    SAY_AIR_PHASE        = -1666060,
+    SAY_BERSERK          = -1666061,
+    SAY_DEATH            = -1666062
 };
 
-enum eSpells
+enum Spells
 {
-    SPELL_SHROUD_OF_SORROW                  = 70986,
-    SPELL_FRENZIED_BLOODTHIRST_VISUAL       = 71949,
-    SPELL_VAMPIRIC_BITE                     = 71726,
-    SPELL_ESSENCE_OF_THE_BLOOD_QUEEN_PLR    = 70879,
-    SPELL_FRENZIED_BLOODTHIRST              = 70877,
-    SPELL_UNCONTROLLABLE_FRENZY             = 70923,
-    SPELL_PRESENCE_OF_THE_DARKFALLEN        = 71952,
-    SPELL_BLOOD_MIRROR_DAMAGE               = 70821,
-    SPELL_BLOOD_MIRROR_VISUAL               = 71510,
-    SPELL_BLOOD_MIRROR_DUMMY                = 70838,
-    SPELL_DELIRIOUS_SLASH                   = 71623,
-    SPELL_PACT_OF_THE_DARKFALLEN_TARGET     = 71336,
-    SPELL_PACT_OF_THE_DARKFALLEN            = 71340,
-    SPELL_SWARMING_SHADOWS                  = 71264,
-    SPELL_TWILIGHT_BLOODBOLT_TARGET         = 71445,
-    SPELL_TWILIGHT_BLOODBOLT                = 71446,
-    SPELL_INCITE_TERROR                     = 73070,
-    SPELL_BLOODBOLT_WHIRL                   = 71772,
+    SPELL_PRESENCE_OF_DARKFALLEN    = 71952,
+    SPELL_SHROUD_OF_SORROW          = 72981,
+    SPELL_DELIRIOUS_SLASH           = 71623,
+    SPELL_BLOOD_MIRROR_1            = 70821,
+    SPELL_BLOOD_MIRROR_2            = 71510,
+    SPELL_VAMPIRIC_BITE             = 71726,
+    SPELL_PACT_OF_THE_DARKFALLEN_1  = 71340,
+    SPELL_PACT_OF_THE_DARKFALLEN_2  = 71341,
+    SPELL_SWARMING_SHADOWS          = 71264,
+    SPELL_TWILIGHT_BLOODBOLT        = 71446,
+    SPELL_BLOODBOLT_WHIRL           = 71899,
+    SPELL_BLOODBOLT_SPLASH          = 71447,
+    SPELL_INCITE_TERROR             = 73070,
+    SPELL_SWARMING_SHADOWS_VISUAL   = 71267,
+    SPELL_SWARMING_SHADOW           = 71267,
+    SPELL_ESSENCE_OF_BLOOD_QWEEN    = 70867,
+    SPELL_FRENZIED_BLOODTHIRST      = 70877,
+    SPELL_UNCONTROLLABLE_FRENZY     = 70923
 };
 
-enum eShadowmourne
+const Position SpawnLoc[]=
 {
-    QUEST_BLOOD_INFUSION                    = 24756,
-    ITEM_SHADOW_S_EDGE                      = 49888,
-
-    SPELL_GUSHING_WOUND                     = 72132,
-    SPELL_THIRST_QUENCHED                   = 72154,
-};
-
-static const uint32 vampireAuras[3][MAX_DIFFICULTY] =
-{
-    {70867, 71473, 71532, 71533},
-    {70879, 71525, 71530, 71531},
-    {70877, 71474, 70877, 71474},
-};
-
-#define ESSENCE_OF_BLOOD_QUEEN     RAID_MODE<uint32>(70867,71473,71532,71533)
-#define ESSENCE_OF_BLOOD_QUEEN_PLR RAID_MODE<uint32>(70879,71525,71530,71531)
-#define FRENZIED_BLOODTHIRST       RAID_MODE<uint32>(70877,71474,70877,71474)
-
-enum eEvents
-{
-    EVENT_BERSERK                   = 1,
-    EVENT_VAMPIRIC_BITE             = 2,
-    EVENT_BLOOD_MIRROR              = 3,
-    EVENT_DELIRIOUS_SLASH           = 4,
-    EVENT_PACT_OF_THE_DARKFALLEN    = 5,
-    EVENT_SWARMING_SHADOWS          = 6,
-    EVENT_TWILIGHT_BLOODBOLT        = 7,
-    EVENT_AIR_PHASE                 = 8,
-    EVENT_AIR_START_FLYING          = 9,
-    EVENT_AIR_FLY_DOWN              = 10,
-
-    EVENT_GROUP_NORMAL              = 1,
-    EVENT_GROUP_CANCELLABLE         = 2,
+    {4595.640f, 2769.195f, 400.137f, 0.0f}, //phase 2 pos
+    {4595.904f, 2769.315f, 421.838f, 0.0f} //fly pos
 };
 
-#define GUID_VAMPIRE 1
-
-enum ePoints
-{
-    POINT_CENTER    = 1,
-    POINT_AIR       = 2,
-    POINT_GROUND    = 3,
-};
-
-static const Position centerPos = {4595.7090f, 2769.4190f, 400.6368f, 0.0000f};
-static const Position airPos    = {4595.7090f, 2769.4190f, 422.3893f, 0.0000f};
-
-bool IsVampire(Unit const* unit)
-{
-    for (uint8 i = 0; i < 3; ++i)
-        if (unit->HasAura(vampireAuras[i][unit->GetMap()->GetSpawnMode()]))
-            return true;
-    return false;
-}
-
-class boss_blood_queen_lana_thel : public CreatureScript
+class boss_blood_queen_lanathel : public CreatureScript
 {
     public:
-        boss_blood_queen_lana_thel() : CreatureScript("boss_blood_queen_lana_thel") { }
+        boss_blood_queen_lanathel() : CreatureScript("boss_blood_queen_lanathel") { }
 
-        struct boss_blood_queen_lana_thelAI : public BossAI
+        struct boss_blood_queen_lanathelAI : public BossAI
         {
-            boss_blood_queen_lana_thelAI(Creature* creature) : BossAI(creature, DATA_BLOOD_QUEEN_LANA_THEL)
+            boss_blood_queen_lanathelAI(Creature* pCreature) : BossAI(pCreature, DATA_BLOOD_QUEEN_LANA_THEL)
             {
-            }
-
-            void InitializeAI()
-            {
-                if (!instance || static_cast<InstanceMap*>(me->GetMap())->GetScriptId() != GetScriptId(ICCScriptName))
-                    me->IsAIEnabled = false;
-                else if (!me->isDead())
-                    Reset();
+                pInstance = me->GetInstanceScript();
             }
 
             void Reset()
             {
-                events.Reset();
-                events.ScheduleEvent(EVENT_BERSERK, 330000);
-                events.ScheduleEvent(EVENT_VAMPIRIC_BITE, 15000);
-                events.ScheduleEvent(EVENT_BLOOD_MIRROR, 2500, EVENT_GROUP_CANCELLABLE);
-                events.ScheduleEvent(EVENT_DELIRIOUS_SLASH, urand(20000, 24000), EVENT_GROUP_NORMAL);
-                events.ScheduleEvent(EVENT_PACT_OF_THE_DARKFALLEN, 15000, EVENT_GROUP_NORMAL);
-                events.ScheduleEvent(EVENT_SWARMING_SHADOWS, 30500, EVENT_GROUP_NORMAL);
-                events.ScheduleEvent(EVENT_TWILIGHT_BLOODBOLT, urand(20000, 25000), EVENT_GROUP_NORMAL);
-                events.ScheduleEvent(EVENT_AIR_PHASE, 124000 + uint32(Is25ManRaid() ? 3000 : 0));
-                me->SetSpeed(MOVE_FLIGHT, 0.642857f, true);
-                offtank = NULL;
-                vampires.clear();
-
-                instance->SetBossState(DATA_BLOOD_QUEEN_LANA_THEL, NOT_STARTED);
+                m_uiPhase = 1;
+                m_uiPhaseTimer = 90000;
+                m_uiTwilightBloodboltTimer = 10000;
+                m_uiVampBiteTimer  = 15000;
+                m_uiSwarmingShadowsTimer = 30000;
+                m_uiPactofDarkfallenTimer  = 5000;
+                m_uiSetHoverTimer = 90000;
+                m_uiBloodboldSplashTimer = 900000;
+                m_uiLandingTimer = 900000;
+                m_uiFlyingFalseTimer = 900000;
+                m_uiBerserkTimer = 330000;
+
+                memset(&Darkfallen, 0, sizeof(Darkfallen));
+
+                if (pInstance && me->isAlive())
+                    pInstance->SetData(DATA_BLOOD_QUEEN_LANA_THEL, NOT_STARTED);
             }
 
             void EnterCombat(Unit* /*who*/)
             {
-                DoZoneInCombat();
-                Talk(SAY_AGGRO);
-                instance->SetBossState(DATA_BLOOD_QUEEN_LANA_THEL, IN_PROGRESS);
-
-                DoCast(me, SPELL_SHROUD_OF_SORROW, true);
-                DoCast(me, SPELL_FRENZIED_BLOODTHIRST_VISUAL, true);
-            }
+                DoScriptText(SAY_AGGRO, me);
+                DoCast(SPELL_SHROUD_OF_SORROW);
 
-            void JustDied(Unit* /*killer*/)
-            {
-                Talk(SAY_DEATH);
-                instance->DoRemoveAurasDueToSpellOnPlayers(ESSENCE_OF_BLOOD_QUEEN);
-                instance->DoRemoveAurasDueToSpellOnPlayers(ESSENCE_OF_BLOOD_QUEEN_PLR);
-                instance->DoRemoveAurasDueToSpellOnPlayers(FRENZIED_BLOODTHIRST);
-                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_UNCONTROLLABLE_FRENZY);
-                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_BLOOD_MIRROR_DAMAGE);
-                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_BLOOD_MIRROR_VISUAL);
-                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_BLOOD_MIRROR_DUMMY);
-                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_DELIRIOUS_SLASH);
-                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_PACT_OF_THE_DARKFALLEN);
-                instance->SetBossState(DATA_BLOOD_QUEEN_LANA_THEL, DONE);
+                if (pInstance)
+                    pInstance->SetData(DATA_BLOOD_QUEEN_LANA_THEL, IN_PROGRESS);
             }
 
-            void JustReachedHome()
+            void KilledUnit(Unit* pVictim)
             {
-                Talk(SAY_WIPE);
-                instance->SetBossState(DATA_BLOOD_QUEEN_LANA_THEL, FAIL);
+                pVictim->RemoveAllAuras();
             }
 
-            void KilledUnit(Unit* victim)
+            void JustDied(Unit* /*Killer*/)
             {
-                if (victim->GetTypeId() == TYPEID_PLAYER)
-                    Talk(SAY_KILL);
-            }
+                DoScriptText(SAY_DEATH, me);
 
-            void SetGUID(const uint64& guid, int32 type = 0)
-            {
-                if (type == GUID_VAMPIRE)
-                    vampires.insert(guid);
-            }
-
-            void MovementInform(uint32 type, uint32 id)
-            {
-                if (type != POINT_MOTION_TYPE)
-                    return;
-
-                switch (id)
-                {
-                    case POINT_CENTER:
-                        DoCast(me, SPELL_INCITE_TERROR);
-                        events.ScheduleEvent(EVENT_AIR_PHASE, 100000 + uint32(Is25ManRaid() ? 0 : 20000));
-                        events.RescheduleEvent(EVENT_SWARMING_SHADOWS, 30500, EVENT_GROUP_NORMAL);
-                        events.RescheduleEvent(EVENT_PACT_OF_THE_DARKFALLEN, 25500, EVENT_GROUP_NORMAL);
-                        events.ScheduleEvent(EVENT_AIR_START_FLYING, 5000);
-                        break;
-                    case POINT_AIR:
-                        DoCast(me, SPELL_BLOODBOLT_WHIRL);
-                        Talk(SAY_AIR_PHASE);
-                        events.ScheduleEvent(EVENT_AIR_FLY_DOWN, 10000);
-                        break;
-                    case POINT_GROUND:
-                        me->RemoveUnitMovementFlag(MOVEMENTFLAG_LEVITATING);
-                        me->RemoveByteFlag(UNIT_FIELD_BYTES_1, 3, 0x01);
-                        me->SetFlying(false);
-                        me->SetReactState(REACT_AGGRESSIVE);
-                        AttackStart(me->getVictim());
-                        events.ScheduleEvent(EVENT_BLOOD_MIRROR, 2500, EVENT_GROUP_CANCELLABLE);
-                        break;
-                    default:
-                        break;
-                }
+                if (pInstance)
+                    pInstance->SetData(DATA_BLOOD_QUEEN_LANA_THEL, DONE);
             }
 
-            void UpdateAI(const uint32 diff)
+            void UpdateAI(const uint32 uiDiff)
             {
-                if (!UpdateVictim() || !CheckInRoom())
+                if (!UpdateVictim())
                     return;
 
-                events.Update(diff);
+                if (!me->HasAura(SPELL_SHROUD_OF_SORROW))
+                    DoCast(me, SPELL_SHROUD_OF_SORROW);
 
-                if (me->HasUnitState(UNIT_STAT_CASTING))
-                    return;
+                if (m_uiBerserkTimer < uiDiff)
+                {
+                    DoScriptText(SAY_BERSERK, me);
+                    DoCast(me, SPELL_BERSERK);
+                    m_uiBerserkTimer = 330000;
+                } else m_uiBerserkTimer -= uiDiff;
 
-                while (uint32 eventId = events.ExecuteEvent())
+                if (m_uiPhase == 1)
                 {
-                    switch (eventId)
+                    if (m_uiPactofDarkfallenTimer <= uiDiff)
                     {
-                        case EVENT_BERSERK:
-                            DoScriptText(EMOTE_GENERIC_BERSERK_RAID, me);
-                            Talk(SAY_BERSERK);
-                            DoCast(me, SPELL_BERSERK);
-                            break;
-                        case EVENT_VAMPIRIC_BITE:
-                            if (Player* target = SelectRandomTarget(false))
-                            {
-                                DoCast(target, SPELL_VAMPIRIC_BITE);
-                                Talk(SAY_VAMPIRIC_BITE);
-                                vampires.insert(target->GetGUID());
-                            }
-                            break;
-                        case EVENT_BLOOD_MIRROR:
-                        {
-                            Player* newOfftank = SelectRandomTarget(true);
-                            if (offtank != newOfftank)
-                            {
-                                offtank = newOfftank;
-                                if (offtank)
-                                {
-                                    offtank->CastSpell(me->getVictim(), SPELL_BLOOD_MIRROR_DAMAGE, true);
-                                    me->getVictim()->CastSpell(offtank, SPELL_BLOOD_MIRROR_DUMMY, true);
-                                    DoCastVictim(SPELL_BLOOD_MIRROR_VISUAL);
-                                    if (Item* shadowsEdge = offtank->GetWeaponForAttack(BASE_ATTACK, true))
-                                        if (!offtank->HasAura(SPELL_THIRST_QUENCHED) && shadowsEdge->GetEntry() == ITEM_SHADOW_S_EDGE && !offtank->HasAura(SPELL_GUSHING_WOUND))
-                                            offtank->CastSpell(offtank, SPELL_GUSHING_WOUND, true);
-
-                                }
-                            }
-                            events.ScheduleEvent(EVENT_BLOOD_MIRROR, 2500, EVENT_GROUP_CANCELLABLE);
-                            break;
-                        }
-                        case EVENT_DELIRIOUS_SLASH:
-                            if (offtank && !me->HasByteFlag(UNIT_FIELD_BYTES_1, 3, 0x03))
-                                DoCast(offtank, SPELL_DELIRIOUS_SLASH);
-                            events.ScheduleEvent(EVENT_DELIRIOUS_SLASH, urand(20000, 24000), EVENT_GROUP_NORMAL);
-                            break;
-                        case EVENT_PACT_OF_THE_DARKFALLEN:
-                        {
-                            std::list<Player*> targets;
-                            SelectRandomTarget(false, &targets);
-                            uint32 targetCount = 2;
-                            // do not combine these checks! we want it incremented TWICE when both conditions are met
-                            if (IsHeroic())
-                                ++targetCount;
-                            if (Is25ManRaid())
-                                ++targetCount;
-                            Trinity::RandomResizeList<Player*>(targets, targetCount);
-                            if (targets.size() > 1)
-                            {
-                                Talk(SAY_PACT_OF_THE_DARKFALLEN);
-                                for (std::list<Player*>::iterator itr = targets.begin(); itr != targets.end(); ++itr)
-                                    DoCast(*itr, SPELL_PACT_OF_THE_DARKFALLEN);
-                            }
-                            events.ScheduleEvent(EVENT_PACT_OF_THE_DARKFALLEN, 30500, EVENT_GROUP_NORMAL);
-                            break;
-                        }
-                        case EVENT_SWARMING_SHADOWS:
-                            if (Player* target = SelectRandomTarget(false))
-                            {
-                                Talk(EMOTE_SWARMING_SHADOWS, target->GetGUID());
-                                Talk(SAY_SWARMING_SHADOWS);
-                                DoCast(target, SPELL_SWARMING_SHADOWS);
-                            }
-                            events.ScheduleEvent(EVENT_SWARMING_SHADOWS, 30500, EVENT_GROUP_NORMAL);
-                            break;
-                        case EVENT_TWILIGHT_BLOODBOLT:
-                        {
-                            std::list<Player*> targets;
-                            SelectRandomTarget(false, &targets);
-                            Trinity::RandomResizeList<Player*>(targets, uint32(Is25ManRaid() ? 4 : 2));
-                            for (std::list<Player*>::iterator itr = targets.begin(); itr != targets.end(); ++itr)
-                                DoCast(*itr, SPELL_TWILIGHT_BLOODBOLT);
-                            DoCast(me, SPELL_TWILIGHT_BLOODBOLT_TARGET);
-                            events.ScheduleEvent(EVENT_TWILIGHT_BLOODBOLT, urand(10000, 15000), EVENT_GROUP_NORMAL);
-                            break;
-                        }
-                        case EVENT_AIR_PHASE:
-                            DoStopAttack();
-                            me->SetReactState(REACT_PASSIVE);
-                            events.DelayEvents(7000, EVENT_GROUP_NORMAL);
-                            events.CancelEventsByGCD(EVENT_GROUP_CANCELLABLE);
-                            me->GetMotionMaster()->MovePoint(POINT_CENTER, centerPos);
-                            break;
-                        case EVENT_AIR_START_FLYING:
-                            me->AddUnitMovementFlag(MOVEMENTFLAG_LEVITATING);
-                            me->SetByteFlag(UNIT_FIELD_BYTES_1, 3, 0x01);
-                            me->SetFlying(true);
-                            me->GetMotionMaster()->MovePoint(POINT_AIR, airPos);
-                            break;
-                        case EVENT_AIR_FLY_DOWN:
-                            me->GetMotionMaster()->MovePoint(POINT_GROUND, centerPos);
-                            break;
-                        default:
-                            break;
-                    }
-                }
-
-                DoMeleeAttackIfReady();
-            }
-
-            bool WasVampire(uint64 guid)
-            {
-                return vampires.count(guid) != 0;
-            }
+                        DoScriptText(SAY_PACT_DARKFALLEN, me);
+                        m_uiPactofDarkfallenExplosionCount = 0;
+                        m_uiPactofDarkfallenExplodeTimer = 2000;
+                        m_uiPactofDarkfallenTimer = 25000;
+                    } else m_uiPactofDarkfallenTimer -= uiDiff;
 
-        private:
-            // offtank for this encounter is the player standing closest to main tank
-            Player* SelectRandomTarget(bool includeOfftank, std::list<Player*>* targetList = NULL)
-            {
-                const std::list<HostileReference*> &threatlist = me->getThreatManager().getThreatList();
-                std::list<Player*> tempTargets;
-
-                if (threatlist.empty())
-                    return NULL;
+                    if (m_uiSwarmingShadowsTimer < uiDiff)
+                    {
+                        if(Unit* pTarget = SelectUnit(SELECT_TARGET_RANDOM, 1))
+                        DoCast(pTarget, SPELL_SWARMING_SHADOWS);
+                        m_uiSwarmingShadowsTimer = 30000;
+                    } else m_uiSwarmingShadowsTimer -= uiDiff;
 
-                for (std::list<HostileReference*>::const_iterator itr = threatlist.begin(); itr != threatlist.end(); ++itr)
-                    if (Unit* refTarget = (*itr)->getTarget())
-                        if (refTarget != me->getVictim() && refTarget->GetTypeId() == TYPEID_PLAYER && (includeOfftank ? true : (refTarget != offtank)))
-                            tempTargets.push_back(refTarget->ToPlayer());
+                    if (m_uiTwilightBloodboltTimer < uiDiff)
+                    {
+                        if(Unit* pTarget = SelectUnit(SELECT_TARGET_RANDOM, 1))
+                        DoCast(pTarget, SPELL_TWILIGHT_BLOODBOLT);
+                        m_uiTwilightBloodboltTimer = 9000;
+                    } else m_uiTwilightBloodboltTimer -= uiDiff;
 
-                if (tempTargets.empty())
-                    return NULL;
+                    if (m_uiVampBiteTimer < uiDiff)
+                    {
+                        DoScriptText(RAND(SAY_VAMP_BITE_1,SAY_VAMP_BITE_2), me);
+                        DoCast(me->getVictim(), SPELL_VAMPIRIC_BITE);
+                        m_uiVampBiteTimer = 40000;
+                    } else m_uiVampBiteTimer -= uiDiff;
 
-                if (targetList)
-                {
-                    *targetList = tempTargets;
-                    return NULL;
+                    if (m_uiPhaseTimer < uiDiff)
+                    {
+                        DoScriptText(SAY_AIR_PHASE, me);
+                        DoCast(me, SPELL_INCITE_TERROR);
+                        me->GetMotionMaster()->MovePoint(0, SpawnLoc[0]);
+                        me->SetReactState(REACT_PASSIVE);
+                        me->AttackStop();
+                        m_uiPhase = 2;
+                        m_uiPhaseTimer = 90000;
+                        m_uiSetHoverTimer = 5000;
+                        m_uiBloodboldSplashTimer = 10000;
+                        m_uiLandingTimer = 26000;
+                        m_uiFlyingFalseTimer = 30000;
+                    } else m_uiPhaseTimer -= uiDiff;
                 }
 
-                if (includeOfftank)
+                if (m_uiPhase == 2)
                 {
-                    tempTargets.sort(Trinity::ObjectDistanceOrderPred(me->getVictim()));
-                    return tempTargets.front();
-                }
-
-                std::list<Player*>::iterator itr = tempTargets.begin();
-                std::advance(itr, urand(0, tempTargets.size()-1));
-                return *itr;
-            }
-
-            Player* offtank;
-            std::set<uint64> vampires;
-        };
-
-        CreatureAI* GetAI(Creature* creature) const
-        {
-            return new boss_blood_queen_lana_thelAI(creature);
-        }
-};
-
-// helper for shortened code
-typedef boss_blood_queen_lana_thel::boss_blood_queen_lana_thelAI LanaThelAI;
-
-class spell_blood_queen_vampiric_bite : public SpellScriptLoader
-{
-    public:
-        spell_blood_queen_vampiric_bite() : SpellScriptLoader("spell_blood_queen_vampiric_bite") { }
-
-        class spell_blood_queen_vampiric_bite_SpellScript : public SpellScript
-        {
-            PrepareSpellScript(spell_blood_queen_vampiric_bite_SpellScript);
-
-            bool Validate(SpellEntry const* /*spell*/)
-            {
-                if (!sSpellStore.LookupEntry(SPELL_ESSENCE_OF_THE_BLOOD_QUEEN_PLR))
-                    return false;
-                if (!sSpellStore.LookupEntry(SPELL_FRENZIED_BLOODTHIRST))
-                    return false;
-                if (!sSpellStore.LookupEntry(SPELL_PRESENCE_OF_THE_DARKFALLEN))
-                    return false;
-                return true;
-            }
-
-            void OnCast()
-            {
-                if (GetCaster()->GetTypeId() != TYPEID_PLAYER)
-                    return;
+                    if (m_uiSetHoverTimer < uiDiff)
+                    {
+                        me->GetMotionMaster()->MovePoint(0, SpawnLoc[1]);
+                        me->SetUnitMovementFlags(MOVEMENTFLAG_JUMPING);
+                        me->SetFlying(true);
+                        m_uiSetHoverTimer = 90000;
+                    } else m_uiSetHoverTimer -= uiDiff;
 
-                if (IsVampire(GetHitUnit()))
-                {
-                    PreventHitDamage();
-                    PreventHitDefaultEffect(EFFECT_1);
-                    Spell::SendCastResult(GetCaster()->ToPlayer(), GetSpellInfo(), 0, SPELL_FAILED_BAD_TARGETS);
-                    return;
-                }
+                    if (m_uiBloodboldSplashTimer < uiDiff)
+                    {
+                        std::list<Unit*> targets;
+                        SelectTargetList(targets, 5, SELECT_TARGET_RANDOM, 80, true);
+                        for (std::list<Unit*>::const_iterator i = targets.begin(); i != targets.end(); ++i)
+                            DoCast(*i, SPELL_TWILIGHT_BLOODBOLT);
+                        m_uiBloodboldSplashTimer = 2000;
+                    } else m_uiBloodboldSplashTimer -= uiDiff;
+
+                    if (m_uiLandingTimer < uiDiff)
+                    {
+                        me->GetMotionMaster()->MovePoint(0, SpawnLoc[0]);
+                        me->SetUnitMovementFlags(MOVEMENTFLAG_JUMPING);
+                        m_uiLandingTimer = 900000;
+                        m_uiBloodboldSplashTimer = 900000;
+                    } else m_uiLandingTimer -= uiDiff;
 
-                SpellEntry const* spell = sSpellStore.LookupEntry(SPELL_FRENZIED_BLOODTHIRST);
-                spell = sSpellMgr->GetSpellForDifficultyFromSpell(spell, GetCaster());
-                GetCaster()->RemoveAura(spell->Id, 0, 0, AURA_REMOVE_BY_ENEMY_SPELL);
-                GetCaster()->CastSpell(GetCaster(), SPELL_ESSENCE_OF_THE_BLOOD_QUEEN_PLR, true);
-                // Presence of the Darkfallen buff on Blood-Queen
-                if (GetCaster()->GetMap()->IsHeroic())
-                    GetCaster()->CastSpell(GetCaster(), SPELL_PRESENCE_OF_THE_DARKFALLEN, true);
-                // Shadowmourne questline
-                if (GetCaster()->ToPlayer()->GetQuestStatus(QUEST_BLOOD_INFUSION) == QUEST_STATUS_INCOMPLETE)
-                {
-                    if (Aura* aura = GetCaster()->GetAura(SPELL_GUSHING_WOUND))
+                    if (m_uiFlyingFalseTimer < uiDiff)
                     {
-                        if (aura->GetStackAmount() == 3)
-                        {
-                            GetCaster()->CastSpell(GetCaster(), SPELL_THIRST_QUENCHED, true);
-                            GetCaster()->RemoveAura(aura);
-                        }
-                        else
-                            GetCaster()->CastSpell(GetCaster(), SPELL_GUSHING_WOUND, true);
-                    }
+                        me->SetFlying(false);
+                        me->RemoveAllAuras();
+                        me->SetReactState(REACT_AGGRESSIVE);
+                        me->GetMotionMaster()->MoveChase(me->getVictim());
+                        m_uiPhase = 1;
+                        m_uiFlyingFalseTimer = 900000;
+                    } else m_uiFlyingFalseTimer -= uiDiff;
                 }
-                if (InstanceScript* instance = GetCaster()->GetInstanceScript())
-                    if (Creature* bloodQueen = ObjectAccessor::GetCreature(*GetCaster(), instance->GetData64(DATA_BLOOD_QUEEN_LANA_THEL)))
-                        bloodQueen->AI()->SetGUID(GetHitUnit()->GetGUID(), GUID_VAMPIRE);
-            }
 
-            void Register()
-            {
-                BeforeHit += SpellHitFn(spell_blood_queen_vampiric_bite_SpellScript::OnCast);
+                DoMeleeAttackIfReady();
             }
+        private:
+            InstanceScript* pInstance;
+
+            uint32 m_uiTwilightBloodboltTimer;
+            uint32 m_uiPhaseTimer;
+            uint32 m_uiVampBiteTimer;
+            uint32 m_uiSwarmingShadowsTimer;
+            uint32 m_uiPactofDarkfallenTimer;
+            uint32 m_uiPactofDarkfallenExplodeTimer;
+            uint32 m_uiPactofDarkfallenExplosionCount;
+            uint32 m_uiPhase;
+            uint32 m_uiBerserkTimer;
+            uint32 m_uiSetHoverTimer;
+            uint32 m_uiLandingTimer;
+            uint32 m_uiFlyingFalseTimer;
+            uint32 m_uiBloodboldSplashTimer;
+            uint32 m_uiResetTimer;
+            Unit* Darkfallen[5];
         };
 
-        SpellScript* GetSpellScript() const
+        CreatureAI* GetAI(Creature* pCreature) const
         {
-            return new spell_blood_queen_vampiric_bite_SpellScript();
+            return new boss_blood_queen_lanathelAI(pCreature);
         }
 };
 
-class spell_blood_queen_frenzied_bloodthirst : public SpellScriptLoader
+class npc_swarming_shadows : public CreatureScript
 {
     public:
-        spell_blood_queen_frenzied_bloodthirst() : SpellScriptLoader("spell_blood_queen_frenzied_bloodthirst") { }
+        npc_swarming_shadows() : CreatureScript("npc_swarming_shadows") { }
 
-        class spell_blood_queen_frenzied_bloodthirst_AuraScript : public AuraScript
+        struct npc_swarming_shadowsAI : public Scripted_NoMovementAI
         {
-            PrepareAuraScript(spell_blood_queen_frenzied_bloodthirst_AuraScript);
-
-            void OnApply(AuraEffect const* /*aurEff*/, AuraEffectHandleModes /*mode*/)
+            npc_swarming_shadowsAI(Creature *pCreature) : Scripted_NoMovementAI(pCreature)
             {
-                if (InstanceScript* instance = GetTarget()->GetInstanceScript())
-                    if (Creature* bloodQueen = ObjectAccessor::GetCreature(*GetTarget(), instance->GetData64(DATA_BLOOD_QUEEN_LANA_THEL)))
-                        bloodQueen->AI()->Talk(EMOTE_BLOODTHIRST);
+                pInstance = pCreature->GetInstanceScript();
             }
 
-            void OnRemove(AuraEffect const* /*aurEff*/, AuraEffectHandleModes /*mode*/)
+            void Reset()
             {
-                Unit* target = GetTarget();
-                if (GetTargetApplication()->GetRemoveMode() == AURA_REMOVE_BY_EXPIRE)
-                    if (InstanceScript* instance = target->GetInstanceScript())
-                        if (Creature* bloodQueen = ObjectAccessor::GetCreature(*target, instance->GetData64(DATA_BLOOD_QUEEN_LANA_THEL)))
-                        {
-                            // this needs to be done BEFORE charm aura or we hit an assert in Unit::SetCharmedBy
-                            if (target->GetVehicleKit())
-                                target->RemoveVehicleKit();
-
-                            bloodQueen->AI()->Talk(SAY_MIND_CONTROL);
-                            bloodQueen->CastSpell(target, SPELL_UNCONTROLLABLE_FRENZY, true);
-                        }
+                m_uiSwarmingShadowTimer = 1200;
             }
 
-            void Register()
+            void UpdateAI(const uint32 uiDiff)
             {
-                OnEffectRemove += AuraEffectRemoveFn(spell_blood_queen_frenzied_bloodthirst_AuraScript::OnRemove, EFFECT_0, SPELL_AURA_OVERRIDE_SPELLS, AURA_EFFECT_HANDLE_REAL);
-            }
-        };
+                if (!me->HasAura(SPELL_SWARMING_SHADOWS_VISUAL))
+                    DoCast(me, SPELL_SWARMING_SHADOWS_VISUAL);
 
-        AuraScript* GetAuraScript() const
-        {
-            return new spell_blood_queen_frenzied_bloodthirst_AuraScript();
-        }
-};
-
-class spell_blood_queen_bloodbolt : public SpellScriptLoader
-{
-    public:
-        spell_blood_queen_bloodbolt() : SpellScriptLoader("spell_blood_queen_bloodbolt") { }
-
-        class spell_blood_queen_bloodbolt_SpellScript : public SpellScript
-        {
-            PrepareSpellScript(spell_blood_queen_bloodbolt_SpellScript);
-
-            bool Validate(SpellEntry const* /*spell*/)
-            {
-                if (!sSpellStore.LookupEntry(SPELL_TWILIGHT_BLOODBOLT))
-                    return false;
-                return true;
-            }
-
-            void HandleDummy()
-            {
-                if (GetHitUnit()->GetTypeId() == TYPEID_PLAYER)
-                    GetCaster()->CastSpell(GetHitUnit(), SPELL_TWILIGHT_BLOODBOLT, true);
+                if (m_uiSwarmingShadowTimer < uiDiff)
+                {
+                    DoCast(me, SPELL_SWARMING_SHADOW);
+                    m_uiSwarmingShadowTimer = 2000;
+                } else m_uiSwarmingShadowTimer -= uiDiff;
             }
+        private:
+            InstanceScript* pInstance;
 
-            void Register()
-            {
-                AfterHit += SpellHitFn(spell_blood_queen_bloodbolt_SpellScript::HandleDummy);
-            }
+            uint32 m_uiSwarmingShadowTimer;
         };
 
-        SpellScript* GetSpellScript() const
-        {
-            return new spell_blood_queen_bloodbolt_SpellScript();
-        }
-};
-
-class achievement_once_bitten_twice_shy_n : public AchievementCriteriaScript
-{
-    public:
-        achievement_once_bitten_twice_shy_n() : AchievementCriteriaScript("achievement_once_bitten_twice_shy_n") { }
-
-        bool OnCheck(Player* source, Unit* target)
+        CreatureAI* GetAI(Creature* pCreature) const
         {
-            if (!target)
-                return false;
-
-            if (LanaThelAI* lanaThelAI = CAST_AI(LanaThelAI, target->GetAI()))
-                return !lanaThelAI->WasVampire(source->GetGUID());
-            return false;
-        }
-};
-
-class achievement_once_bitten_twice_shy_v : public AchievementCriteriaScript
-{
-    public:
-        achievement_once_bitten_twice_shy_v() : AchievementCriteriaScript("achievement_once_bitten_twice_shy_v") { }
-
-        bool OnCheck(Player* source, Unit* target)
-        {
-            if (!target)
-                return false;
-
-            if (LanaThelAI* lanaThelAI = CAST_AI(LanaThelAI, target->GetAI()))
-                return lanaThelAI->WasVampire(source->GetGUID());
-            return false;
+            return new npc_swarming_shadowsAI(pCreature);
         }
 };
 
 void AddSC_boss_blood_queen_lana_thel()
 {
-    new boss_blood_queen_lana_thel();
-    new spell_blood_queen_vampiric_bite();
-    new spell_blood_queen_frenzied_bloodthirst();
-    new spell_blood_queen_bloodbolt();
-    new achievement_once_bitten_twice_shy_n();
-    new achievement_once_bitten_twice_shy_v();
+    new boss_blood_queen_lanathel();
+    new npc_swarming_shadows();
 }
diff --git a/src/server/scripts/Northrend/IcecrownCitadel/boss_gunship_battle.cpp b/src/server/scripts/Northrend/IcecrownCitadel/boss_gunship_battle.cpp
new file mode 100644
index 0000000..8d1b351
--- /dev/null
+++ b/src/server/scripts/Northrend/IcecrownCitadel/boss_gunship_battle.cpp
@@ -0,0 +1,21 @@
+/*
+ * Copyright (C) 2008-2010 Trinity <http://www.trinitycore.org/>
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License as published by
+ * the Free Software Foundation; either version 2 of the License, or
+ * (at your option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful,
+ * but WITHOUT ANY WARRANTY; without even the implied warranty of
+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
+ * GNU General Public License for more details.
+ *
+ * You should have received a copy of the GNU General Public License
+ * along with this program; if not, write to the Free Software
+ * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
+ */
+
+#include "ScriptPCH.h"
+#include "icecrown_citadel.h"
+#include "MapManager.h"
\ No newline at end of file
diff --git a/src/server/scripts/Northrend/IcecrownCitadel/boss_rat_des_blutes.cpp b/src/server/scripts/Northrend/IcecrownCitadel/boss_rat_des_blutes.cpp
new file mode 100644
index 0000000..459557d
--- /dev/null
+++ b/src/server/scripts/Northrend/IcecrownCitadel/boss_rat_des_blutes.cpp
@@ -0,0 +1,1470 @@
+/*
+ * Copyright (C) 2008-2010 TrinityCore <http://www.trinitycore.org/>
+ *
+ * This program is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU General Public License as published by the
+ * Free Software Foundation; either version 2 of the License, or (at your
+ * option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful, but WITHOUT
+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+ * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
+ * more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program. If not, see <http://www.gnu.org/licenses/>.
+ */
+
+#include "ScriptMgr.h"
+#include "ScriptedCreature.h"
+#include "SpellScript.h"
+#include "SpellAuraEffects.h"
+#include "icecrown_citadel.h"
+
+enum eTexts
+{
+    // Blood Queen Lana'Thel
+    SAY_INTRO_1                 = -1631115,
+    SAY_INTRO_2                 = -1631116,
+
+    // Prince Keleseth
+    SAY_KELESETH_INVOCATION     = -1631117,
+    EMOTE_KELESETH_INVOCATION   = -1631118,
+    SAY_KELESETH_SPECIAL        = -1631119,
+    SAY_KELESETH_KILL_1         = -1631120,
+    SAY_KELESETH_KILL_2         = -1631121,
+    EMOTE_KELESETH_BERSERK      = -1631122,
+    SAY_KELESETH_DEATH          = -1631123,
+
+    // Prince Taldaram
+    SAY_TALDARAM_INVOCATION     = -1631124,
+    EMOTE_TALDARAM_INVOCATION   = -1631125,
+    SAY_TALDARAM_SPECIAL        = -1631126,
+    EMOTE_TALDARAM_FLAME        = -1631127,
+    SAY_TALDARAM_KILL_1         = -1631128,
+    SAY_TALDARAM_KILL_2         = -1631129,
+    EMOTE_TALDARAM_BERSERK      = -1631130,
+    EMOTE_TALDARAM_DEATH        = -1631131,
+
+    // Prince Valanar
+    SAY_VALANAR_INVOCATION      = -1631132,
+    EMOTE_VALANAR_INVOCATION    = -1631133,
+    SAY_VALANAR_SPECIAL         = -1631134,
+    EMOTE_VALANAR_SHOCK_VORTEX  = -1631135,
+    SAY_VALANAR_KILL_1          = -1631136,
+    SAY_VALANAR_KILL_2          = -1631137,
+    SAY_VALANAR_BERSERK         = -1631138,
+    SAY_VALANAR_DEATH           = -1631139
+};
+
+enum Spells
+{
+    SPELL_FEIGN_DEATH                   = 71598,
+    SPELL_OOC_INVOCATION_VISUAL         = 70934,
+    SPELL_INVOCATION_VISUAL_ACTIVE      = 71596,
+
+    // Heroic mode
+    SPELL_SHADOW_PRISON                 = 72998,
+    SPELL_SHADOW_PRISON_DAMAGE          = 72999,
+    SPELL_SHADOW_PRISON_DUMMY           = 73001,
+
+    // Prince Keleseth
+    SPELL_INVOCATION_OF_BLOOD_KELESETH  = 70981,
+    SPELL_SHADOW_RESONANCE              = 71943,
+    SPELL_SHADOW_LANCE                  = 71405,
+    SPELL_EMPOWERED_SHADOW_LANCE        = 71815,
+
+    // Dark Nucleus
+    SPELL_SHADOW_RESONANCE_AURA         = 72980,
+    SPELL_SHADOW_RESONANCE_RESIST       = 71822,
+
+    // Prince Taldaram
+    SPELL_INVOCATION_OF_BLOOD_TALDARAM  = 70982,
+    SPELL_GLITTERING_SPARKS             = 71806,
+    SPELL_CONJURE_FLAME                 = 71718,
+    SPELL_CONJURE_EMPOWERED_FLAME       = 72040,
+
+    // Ball of Flame
+    SPELL_FLAME_SPHERE_SPAWN_EFFECT     = 55891, // cast from creature_template_addon (needed cast before entering world)
+    SPELL_BALL_OF_FLAMES_VISUAL         = 71706,
+    SPELL_BALL_OF_FLAMES                = 71714,
+    SPELL_FLAMES                        = 71393,
+    SPELL_FLAME_SPHERE_DEATH_EFFECT     = 55947,
+
+    // Ball of Inferno Flame
+    SPELL_BALL_OF_FLAMES_PROC           = 71756,
+    SPELL_BALL_OF_FLAMES_PERIODIC       = 71709,
+
+    // Prince Valanar
+    SPELL_INVOCATION_OF_BLOOD_VALANAR   = 70952,
+    SPELL_KINETIC_BOMB_TARGET           = 72053,
+    SPELL_KINETIC_BOMB                  = 72080,
+    SPELL_SHOCK_VORTEX                  = 72037,
+    SPELL_EMPOWERED_SHOCK_VORTEX        = 72039,
+
+    // Kinetic Bomb
+    SPELL_UNSTABLE                      = 72059,
+    SPELL_KINETIC_BOMB_VISUAL           = 72054,
+    SPELL_KINETIC_BOMB_EXPLOSION        = 72052,
+
+    // Shock Vortex
+    SPELL_SHOCK_VORTEX_PERIODIC         = 71945,
+    SPELL_SHOCK_VORTEX_DUMMY            = 72633,
+};
+
+enum eEvents
+{
+    EVENT_INTRO_1               = 1,
+    EVENT_INTRO_2               = 2,
+
+    EVENT_INVOCATION_OF_BLOOD   = 3,
+    EVENT_BERSERK               = 4,
+
+    // Keleseth
+    EVENT_SHADOW_RESONANCE      = 5,
+    EVENT_SHADOW_LANCE          = 6,
+
+    // Taldaram
+    EVENT_GLITTERING_SPARKS     = 7,
+    EVENT_CONJURE_FLAME         = 8,
+
+    // Valanar
+    EVENT_KINETIC_BOMB          = 9,
+    EVENT_SHOCK_VORTEX          = 10,
+    EVENT_BOMB_DESPAWN          = 11,
+    EVENT_CONTINUE_FALLING      = 12,
+};
+
+enum eActions
+{
+    ACTION_STAND_UP             = 1,
+    ACTION_CAST_INVOCATION      = 2,
+    ACTION_REMOVE_INVOCATION    = 3,
+    ACTION_KINETIC_BOMB_JUMP    = 4,
+    ACTION_FLAME_BALL_CHASE     = 5,
+};
+
+enum ePoints
+{
+    POINT_INTRO_DESPAWN         = 380040,
+    POINT_KINETIC_BOMB_IMPACT   = 384540,
+};
+
+enum eDisplays
+{
+    DISPLAY_KINETIC_BOMB        = 31095,
+};
+
+class StandUpEvent : public BasicEvent
+{
+    public:
+        StandUpEvent(Creature& owner) : BasicEvent(), m_owner(owner) { }
+        bool Execute(uint64 /*eventTime*/, uint32 /*diff*/)
+        {
+            m_owner.HandleEmoteCommand(EMOTE_ONESHOT_ROAR);
+            return true;
+        }
+
+    private:
+        Creature& m_owner;
+};
+
+static const Position introFinalPos = {4660.490f, 2769.200f, 430.0000f, 0.000000f};
+static const Position triggerPos    = {4680.231f, 2769.134f, 379.9256f, 3.121708f};
+static const Position triggerEndPos = {4680.180f, 2769.150f, 365.5000f, 3.121708f};
+
+class boss_blood_council_controller : public CreatureScript
+{
+    public:
+        boss_blood_council_controller() : CreatureScript("boss_blood_council_controller") { }
+
+        struct boss_blood_council_controllerAI : public BossAI
+        {
+            boss_blood_council_controllerAI(Creature* creature) : BossAI(creature, DATA_BLOOD_PRINCES_CONTROL)
+            {
+                instance = creature->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                events.Reset();
+                me->SetReactState(REACT_PASSIVE);
+                invocationStage = 0;
+
+                if(instance)
+                    instance->SetData(DATA_BLOOD_PRINCE_COUNCIL, NOT_STARTED);
+            }
+
+            void EnterCombat(Unit* who)
+            {
+                if(!instance)
+                    return;
+
+                instance->SetData(DATA_BLOOD_PRINCE_COUNCIL, IN_PROGRESS);
+
+                DoCast(me, SPELL_INVOCATION_OF_BLOOD_VALANAR);
+
+                if (Creature* keleseth = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_PRINCE_KELESETH_GUID)))
+                    if (!keleseth->isInCombat())
+                        DoZoneInCombat(keleseth);
+
+                if (Creature* taldaram = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_PRINCE_TALDARAM_GUID)))
+                    if (!taldaram->isInCombat())
+                        DoZoneInCombat(taldaram);
+
+                if (Creature* valanar = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_PRINCE_VALANAR_GUID)))
+                    if (!valanar->isInCombat())
+                        DoZoneInCombat(valanar);
+
+                events.ScheduleEvent(EVENT_INVOCATION_OF_BLOOD, 30000);
+
+                invocationOrder[0] = InvocationData(instance->GetData(DATA_PRINCE_VALANAR_GUID), SPELL_INVOCATION_OF_BLOOD_VALANAR, EMOTE_VALANAR_INVOCATION, 71070);
+                if (urand(0, 1))
+                {
+                    invocationOrder[1] = InvocationData(instance->GetData64(DATA_PRINCE_TALDARAM_GUID), SPELL_INVOCATION_OF_BLOOD_TALDARAM, EMOTE_TALDARAM_INVOCATION, 71081);
+                    invocationOrder[2] = InvocationData(instance->GetData64(DATA_PRINCE_KELESETH_GUID), SPELL_INVOCATION_OF_BLOOD_KELESETH, EMOTE_KELESETH_INVOCATION, 71080);
+                }
+                else
+                {
+                    invocationOrder[1] = InvocationData(instance->GetData64(DATA_PRINCE_KELESETH_GUID), SPELL_INVOCATION_OF_BLOOD_KELESETH, EMOTE_KELESETH_INVOCATION, 71080);
+                    invocationOrder[2] = InvocationData(instance->GetData64(DATA_PRINCE_TALDARAM_GUID), SPELL_INVOCATION_OF_BLOOD_TALDARAM, EMOTE_TALDARAM_INVOCATION, 71081);
+                }
+
+                if (IsHeroic())
+                {
+                    Map::PlayerList const &PlList = me->GetMap()->GetPlayers();
+                    if (PlList.isEmpty())
+                        return;
+
+                    for (Map::PlayerList::const_iterator i = PlList.begin(); i != PlList.end(); ++i)
+                    {
+                        if (Player* player = i->getSource())
+                        {
+                            if (player->isGameMaster())
+                                continue;
+
+                            if (player->isAlive())
+                                player->AddAura(SPELL_SHADOW_PRISON_DUMMY, player);
+                        }
+                    }
+                }
+            }
+
+            void JustReachedHome()
+            {
+                if(instance)
+                    instance->SetBossState(DATA_BLOOD_PRINCE_COUNCIL, FAIL);
+            }
+
+            void JustDied(Unit* /*killer*/)
+            {
+                _JustDied();
+                // kill the other 2 princes too
+                for (uint8 i = 0; i < 2; ++i)
+                {
+                    if (++invocationStage == 3)
+                        invocationStage = 0;
+
+                    if (Creature* prince = ObjectAccessor::GetCreature(*me, invocationOrder[invocationStage].guid))
+                        prince->Kill(prince);
+                }
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!UpdateVictim() || me->HasUnitState(UNIT_STAT_CASTING))
+                    return;
+
+                events.Update(diff);
+
+                while (uint32 eventId = events.ExecuteEvent())
+                {
+                    switch (eventId)
+                    {
+                        case EVENT_INVOCATION_OF_BLOOD:
+                        {
+                            Creature* oldPrince = ObjectAccessor::GetCreature(*me, invocationOrder[invocationStage].guid);
+                            if (++invocationStage == 3)
+                                invocationStage = 0;
+
+                            Creature* newPrince = ObjectAccessor::GetCreature(*me, invocationOrder[invocationStage].guid);
+                            if (oldPrince)
+                            {
+                                oldPrince->AI()->DoAction(ACTION_REMOVE_INVOCATION);
+                                if (newPrince)
+                                    oldPrince->CastSpell(newPrince, invocationOrder[invocationStage].visualSpell, true);
+                            }
+
+                            if (newPrince)
+                                newPrince->SetHealth(me->GetHealth());
+
+                            DoCast(me, invocationOrder[invocationStage].spellId);
+                            DoScriptText(invocationOrder[invocationStage].textId, me);
+                            events.ScheduleEvent(EVENT_INVOCATION_OF_BLOOD, 30000);
+                            break;
+                        }
+                        default:
+                            break;
+                    }
+                }
+            }
+
+        private:
+            struct InvocationData
+            {
+                uint64 guid;
+                uint32 spellId;
+                int32  textId;
+                uint32 visualSpell;
+
+                InvocationData(uint64 _guid, uint32 _spellId, int32 _textId, uint32 _visualSpell)
+                {
+                    guid = _guid;
+                    spellId = _spellId;
+                    textId = _textId;
+                    visualSpell = _visualSpell;
+                }
+
+                InvocationData() : guid(0), spellId(0), textId(0), visualSpell(0) { }
+            } invocationOrder[3];
+            uint8 invocationStage;
+            InstanceScript* instance;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new boss_blood_council_controllerAI(creature);
+        }
+};
+
+class boss_prince_keleseth_icc : public CreatureScript
+{
+    public:
+        boss_prince_keleseth_icc() : CreatureScript("boss_blood_elf_keleset_icc") { }
+
+        struct boss_prince_kelesethAI : public BossAI
+        {
+            boss_prince_kelesethAI(Creature* creature) : BossAI(creature, DATA_PRINCE_KELESETH_GUID)
+            {
+                bIsEmpowered = false;
+                spawnHealth = creature->GetMaxHealth();
+                instance = creature->GetInstanceScript();
+            }
+
+            void InitializeAI()
+            {
+                if (CreatureData const* data = sObjectMgr->GetCreatureData(me->GetDBTableGUIDLow()))
+                    if (data->curhealth)
+                        spawnHealth = data->curhealth;
+
+                me->SetReactState(REACT_DEFENSIVE);
+            }
+
+            void Reset()
+            {
+                events.Reset();
+                summons.DespawnAll();
+
+                me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_OOC_NOT_ATTACKABLE);
+                bIsEmpowered = false;
+                me->SetHealth(spawnHealth);
+                me->SetReactState(REACT_DEFENSIVE);
+                if (IsHeroic())
+                    DoCast(me, SPELL_SHADOW_PRISON);
+            }
+
+            void MoveInLineOfSight(Unit* /*who*/)
+            {
+            }
+
+            void EnterCombat(Unit* /*who*/)
+            {
+                if (Creature* controller = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_BLOOD_PRINCES_CONTROL)))
+                    if (!controller->isInCombat())
+                        DoZoneInCombat(controller);
+
+                events.ScheduleEvent(EVENT_BERSERK, 600000);
+                events.ScheduleEvent(EVENT_SHADOW_RESONANCE, urand(10000, 15000));
+                events.ScheduleEvent(EVENT_SHADOW_LANCE, 2000);
+            }
+
+            void JustDied(Unit* /*killer*/)
+            {
+                DoScriptText(SAY_KELESETH_DEATH, me);
+            }
+
+            void JustRespawned()
+            {
+                DoCast(me, SPELL_FEIGN_DEATH);
+                me->SetHealth(spawnHealth);
+            }
+
+            void SpellHit(Unit* /*caster*/, SpellEntry const* spell)
+            {
+                if (spell->Id == SPELL_INVOCATION_OF_BLOOD_KELESETH)
+                    DoAction(ACTION_CAST_INVOCATION);
+            }
+
+            void JustSummoned(Creature* summon)
+            {
+                summons.Summon(summon);
+            }
+
+            void DamageTaken(Unit* /*attacker*/, uint32& damage)
+            {
+                if (!bIsEmpowered)
+                    damage = 0;
+            }
+
+            void KilledUnit(Unit *victim)
+            {
+                if (victim->GetTypeId() == TYPEID_PLAYER)
+                    DoScriptText(RAND(SAY_KELESETH_KILL_1, SAY_KELESETH_KILL_2), me);
+            }
+
+            void DoAction(const int32 action)
+            {
+                switch (action)
+                {
+                    case ACTION_STAND_UP:
+                        me->RemoveAurasDueToSpell(SPELL_FEIGN_DEATH);
+                        me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NOT_SELECTABLE | UNIT_FLAG_OOC_NOT_ATTACKABLE);
+                        me->RemoveFlag(UNIT_DYNAMIC_FLAGS, UNIT_DYNFLAG_DEAD);
+                        me->RemoveFlag(UNIT_FIELD_FLAGS_2, UNIT_FLAG2_FEIGN_DEATH);
+                        me->ForceValuesUpdateAtIndex(UNIT_NPC_FLAGS);   // was in sniff. don't ask why
+                        me->m_Events.AddEvent(new StandUpEvent(*me), me->m_Events.CalculateTime(1000));
+                        break;
+                    case ACTION_CAST_INVOCATION:
+                        DoScriptText(SAY_KELESETH_INVOCATION, me);
+                        DoCast(me, SPELL_INVOCATION_VISUAL_ACTIVE, true);
+                        bIsEmpowered = true;
+                        break;
+                    case ACTION_REMOVE_INVOCATION:
+                        me->SetHealth(spawnHealth);
+                        me->RemoveAurasDueToSpell(SPELL_INVOCATION_VISUAL_ACTIVE);
+                        me->RemoveAurasDueToSpell(SPELL_INVOCATION_OF_BLOOD_KELESETH);
+                        bIsEmpowered = false;
+                        break;
+                    default:
+                        break;
+                }
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!UpdateVictim() || !CheckInRoom() || me->HasUnitState(UNIT_STAT_CASTING))
+                    return;
+
+                events.Update(diff);
+
+                while (uint32 eventId = events.ExecuteEvent())
+                {
+                    switch (eventId)
+                    {
+                        case EVENT_BERSERK:
+                            DoCast(me, SPELL_BERSERK);
+                            DoScriptText(EMOTE_KELESETH_BERSERK, me);
+                            break;
+                        case EVENT_SHADOW_RESONANCE:
+                            DoScriptText(SAY_KELESETH_SPECIAL, me);
+                            DoCast(me, SPELL_SHADOW_RESONANCE);
+                            events.ScheduleEvent(EVENT_SHADOW_RESONANCE, urand(10000, 15000));
+                            break;
+                        case EVENT_SHADOW_LANCE:
+                            if (bIsEmpowered)
+                                DoCastVictim(SPELL_EMPOWERED_SHADOW_LANCE);
+                            else
+                                DoCastVictim(SPELL_SHADOW_LANCE);
+                            events.ScheduleEvent(EVENT_SHADOW_LANCE, 2000);
+                            break;
+                        default:
+                            break;
+                    }
+                }
+
+                // does not melee
+            }
+
+        private:
+            bool bIsEmpowered;  // bool check faster than map lookup
+            uint32 spawnHealth;
+            InstanceScript* instance;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new boss_prince_kelesethAI(creature);
+        }
+};
+
+class boss_prince_taldaram_icc : public CreatureScript
+{
+    public:
+        boss_prince_taldaram_icc() : CreatureScript("boss_blood_elf_taldaram_icc") { }
+
+        struct boss_prince_taldaramAI : public BossAI
+        {
+            boss_prince_taldaramAI(Creature* creature) : BossAI(creature, DATA_PRINCE_TALDARAM_GUID)
+            {
+                bIsEmpowered = false;
+                spawnHealth = creature->GetMaxHealth();
+                instance = creature->GetInstanceScript();
+            }
+
+            void InitializeAI()
+            {
+                if (CreatureData const* data = sObjectMgr->GetCreatureData(me->GetDBTableGUIDLow()))
+                    if (data->curhealth)
+                        spawnHealth = data->curhealth;
+
+                me->SetReactState(REACT_DEFENSIVE);
+            }
+
+            void Reset()
+            {
+                events.Reset();
+                summons.DespawnAll();
+
+                me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_OOC_NOT_ATTACKABLE);
+                bIsEmpowered = false;
+                me->SetHealth(spawnHealth);
+                me->SetReactState(REACT_DEFENSIVE);
+                if (IsHeroic())
+                    DoCast(me, SPELL_SHADOW_PRISON);
+            }
+
+            void EnterCombat(Unit* /*who*/)
+            {
+                if (Creature* controller = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_BLOOD_PRINCES_CONTROL)))
+                    if (!controller->isInCombat())
+                        DoZoneInCombat(controller);
+
+                events.ScheduleEvent(EVENT_BERSERK, 600000);
+                events.ScheduleEvent(EVENT_GLITTERING_SPARKS, urand(12000,15000));
+                events.ScheduleEvent(EVENT_CONJURE_FLAME, 20000);
+            }
+
+            void JustDied(Unit* /*killer*/)
+            {
+                DoScriptText(EMOTE_TALDARAM_DEATH, me);
+            }
+
+            void JustRespawned()
+            {
+                DoCast(me, SPELL_FEIGN_DEATH);
+                me->SetHealth(spawnHealth);
+            }
+
+            void SpellHit(Unit* /*caster*/, SpellEntry const* spell)
+            {
+                if (spell->Id == SPELL_INVOCATION_OF_BLOOD_TALDARAM)
+                    DoAction(ACTION_CAST_INVOCATION);
+            }
+
+            void JustSummoned(Creature* summon)
+            {
+                summons.Summon(summon);
+                Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, -10.0f, true); // first try at distance
+                if (!target)
+                    target = SelectTarget(SELECT_TARGET_RANDOM, 0/*1*/, 0.0f, true);     // too bad for you raiders, its going to boom
+
+                if (summon->GetEntry() == CREATURE_BALL_OF_INFERNO_FLAME)
+                    DoScriptText(EMOTE_TALDARAM_FLAME, summon, target);             // safe, has NULL checks
+
+                if (target)
+                    summon->AI()->SetGUID(target->GetGUID());
+            }
+
+            void DamageTaken(Unit* /*attacker*/, uint32& damage)
+            {
+                if (!bIsEmpowered)
+                    damage = 0;
+            }
+
+            void KilledUnit(Unit *victim)
+            {
+                if (victim->GetTypeId() == TYPEID_PLAYER)
+                    DoScriptText(RAND(SAY_TALDARAM_KILL_1, SAY_TALDARAM_KILL_2), me);
+            }
+
+            void DoAction(const int32 action)
+            {
+                switch (action)
+                {
+                    case ACTION_STAND_UP:
+                        me->RemoveAurasDueToSpell(SPELL_FEIGN_DEATH);
+                        me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NOT_SELECTABLE | UNIT_FLAG_OOC_NOT_ATTACKABLE);
+                        me->RemoveFlag(UNIT_DYNAMIC_FLAGS, UNIT_DYNFLAG_DEAD);
+                        me->RemoveFlag(UNIT_FIELD_FLAGS_2, UNIT_FLAG2_FEIGN_DEATH);
+                        me->ForceValuesUpdateAtIndex(UNIT_NPC_FLAGS);   // was in sniff. don't ask why
+                        me->m_Events.AddEvent(new StandUpEvent(*me), me->m_Events.CalculateTime(1000));
+                        break;
+                    case ACTION_CAST_INVOCATION:
+                        DoScriptText(SAY_TALDARAM_INVOCATION, me);
+                        DoCast(me, SPELL_INVOCATION_VISUAL_ACTIVE, true);
+                        bIsEmpowered = true;
+                        break;
+                    case ACTION_REMOVE_INVOCATION:
+                        me->SetHealth(spawnHealth);
+                        me->RemoveAurasDueToSpell(SPELL_INVOCATION_VISUAL_ACTIVE);
+                        me->RemoveAurasDueToSpell(SPELL_INVOCATION_OF_BLOOD_TALDARAM);
+                        bIsEmpowered = false;
+                        break;
+                    default:
+                        break;
+                }
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!UpdateVictim() || !CheckInRoom() || me->HasUnitState(UNIT_STAT_CASTING))
+                    return;
+
+                events.Update(diff);
+
+                while (uint32 eventId = events.ExecuteEvent())
+                {
+                    switch (eventId)
+                    {
+                        case EVENT_BERSERK:
+                            DoCast(me, SPELL_BERSERK);
+                            DoScriptText(EMOTE_TALDARAM_BERSERK, me);
+                            break;
+                        case EVENT_GLITTERING_SPARKS:
+                            DoCastVictim(SPELL_GLITTERING_SPARKS);
+                            events.ScheduleEvent(EVENT_GLITTERING_SPARKS, urand(15000, 50000));
+                            break;
+                        case EVENT_CONJURE_FLAME:
+                            if (bIsEmpowered)
+                            {
+                                DoCast(me, SPELL_CONJURE_EMPOWERED_FLAME);
+                                events.ScheduleEvent(EVENT_CONJURE_FLAME, urand(15000, 25000));
+                            }
+                            else
+                            {
+                                DoCast(me, SPELL_CONJURE_FLAME);
+                                events.ScheduleEvent(EVENT_CONJURE_FLAME, urand(20000, 30000));
+                            }
+                            DoScriptText(SAY_TALDARAM_SPECIAL, me);
+                            break;
+                        default:
+                            break;
+                    }
+                }
+
+                DoMeleeAttackIfReady();
+            }
+
+        private:
+            bool bIsEmpowered;  // bool check faster than map lookup
+            uint32 spawnHealth;
+            InstanceScript* instance;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new boss_prince_taldaramAI(creature);
+        }
+};
+
+class boss_prince_valanar_icc : public CreatureScript
+{
+    public:
+        boss_prince_valanar_icc() : CreatureScript("boss_blood_elf_valanar_icc") { }
+
+        struct boss_prince_valanarAI : public BossAI
+        {
+            boss_prince_valanarAI(Creature* creature) : BossAI(creature, DATA_PRINCE_VALANAR_GUID)
+            {
+                bIsEmpowered = false;
+                spawnHealth = creature->GetMaxHealth();
+                instance = creature->GetInstanceScript();
+            }
+
+            void InitializeAI()
+            {
+                if (CreatureData const* data = sObjectMgr->GetCreatureData(me->GetDBTableGUIDLow()))
+                    if (data->curhealth)
+                        spawnHealth = data->curhealth;
+
+                me->SetReactState(REACT_DEFENSIVE);
+            }
+
+            void Reset()
+            {
+                events.Reset();
+                summons.DespawnAll();
+
+                me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_OOC_NOT_ATTACKABLE);
+                bIsEmpowered = false;
+                me->SetHealth(me->GetMaxHealth());
+                me->SetReactState(REACT_DEFENSIVE);
+                if (IsHeroic())
+                    DoCast(me, SPELL_SHADOW_PRISON);
+            }
+
+            void EnterCombat(Unit* /*who*/)
+            {
+                if (Creature* controller = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_BLOOD_PRINCES_CONTROL)))
+                    if (!controller->isInCombat())
+                        DoZoneInCombat(controller);
+
+                events.ScheduleEvent(EVENT_BERSERK, 600000);
+                events.ScheduleEvent(EVENT_KINETIC_BOMB, urand(18000, 24000));
+                events.ScheduleEvent(EVENT_SHOCK_VORTEX, urand(15000, 20000));
+            }
+
+            void JustDied(Unit* /*killer*/)
+            {
+                DoScriptText(SAY_VALANAR_DEATH, me);
+            }
+
+            void JustRespawned()
+            {
+                DoCast(me, SPELL_FEIGN_DEATH);
+                me->SetHealth(spawnHealth);
+            }
+
+            void JustSummoned(Creature* summon)
+            {
+                switch (summon->GetEntry())
+                {
+                    case CREATURE_KINETIC_BOMB_TARGET:
+                        summon->SetReactState(REACT_PASSIVE);
+                        summon->CastSpell(summon, SPELL_KINETIC_BOMB, true, NULL, NULL, me->GetGUID());
+                        break;
+                    case CREATURE_KINETIC_BOMB:
+                    {
+                        float x, y, z;
+                        summon->GetPosition(x, y, z);
+                        float ground_Z = summon->GetMap()->GetHeight(x, y, z, true, 500.0f);
+                        summon->GetMotionMaster()->MovePoint(POINT_KINETIC_BOMB_IMPACT, x, y, ground_Z);
+                        break;
+                    }
+                    case CREATURE_SHOCK_VORTEX:
+                        summon->CastSpell(summon, SPELL_SHOCK_VORTEX_DUMMY, true);
+                        summon->CastSpell(summon, SPELL_SHOCK_VORTEX_PERIODIC, true);
+                        break;
+                }
+                summons.Summon(summon);
+                if (me->isInCombat())
+                    DoZoneInCombat(summon);
+            }
+
+            void SpellHit(Unit* /*caster*/, SpellEntry const* spell)
+            {
+                if (spell->Id == SPELL_INVOCATION_OF_BLOOD_VALANAR)
+                    DoAction(ACTION_CAST_INVOCATION);
+            }
+
+            void DamageTaken(Unit* /*attacker*/, uint32& damage)
+            {
+                if (!bIsEmpowered)
+                    damage = 0;
+            }
+
+            void KilledUnit(Unit *victim)
+            {
+                if (victim->GetTypeId() == TYPEID_PLAYER)
+                    DoScriptText(RAND(SAY_VALANAR_KILL_1, SAY_VALANAR_KILL_2), me);
+            }
+
+            void DoAction(const int32 action)
+            {
+                switch (action)
+                {
+                    case ACTION_STAND_UP:
+                        me->RemoveAurasDueToSpell(SPELL_FEIGN_DEATH);
+                        me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NOT_SELECTABLE | UNIT_FLAG_OOC_NOT_ATTACKABLE);
+                        me->RemoveFlag(UNIT_DYNAMIC_FLAGS, UNIT_DYNFLAG_DEAD);
+                        me->RemoveFlag(UNIT_FIELD_FLAGS_2, UNIT_FLAG2_FEIGN_DEATH);
+                        me->ForceValuesUpdateAtIndex(UNIT_NPC_FLAGS);   // was in sniff. don't ask why
+                        me->m_Events.AddEvent(new StandUpEvent(*me), me->m_Events.CalculateTime(1000));
+                        break;
+                    case ACTION_CAST_INVOCATION:
+                        DoScriptText(SAY_VALANAR_INVOCATION, me);
+                        DoCast(me, SPELL_INVOCATION_VISUAL_ACTIVE, true);
+                        bIsEmpowered = true;
+                        break;
+                    case ACTION_REMOVE_INVOCATION:
+                        me->SetHealth(spawnHealth);
+                        me->RemoveAurasDueToSpell(SPELL_INVOCATION_VISUAL_ACTIVE);
+                        me->RemoveAurasDueToSpell(SPELL_INVOCATION_OF_BLOOD_VALANAR);
+                        bIsEmpowered = false;
+                        break;
+                    default:
+                        break;
+                }
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!UpdateVictim() || !CheckInRoom() || me->HasUnitState(UNIT_STAT_CASTING))
+                    return;
+
+                events.Update(diff);
+
+                while (uint32 eventId = events.ExecuteEvent())
+                {
+                    switch (eventId)
+                    {
+                        case EVENT_BERSERK:
+                            DoCast(me, SPELL_BERSERK);
+                            DoScriptText(SAY_VALANAR_BERSERK, me);
+                            break;
+                        case EVENT_KINETIC_BOMB:
+                            if (Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 0.0f, true))
+                            {
+                                DoCast(target, SPELL_KINETIC_BOMB_TARGET);
+                                DoScriptText(SAY_VALANAR_SPECIAL, me);
+                            }
+                            events.ScheduleEvent(EVENT_KINETIC_BOMB, urand(18000, 24000));
+                            break;
+                        case EVENT_SHOCK_VORTEX:
+                            if (bIsEmpowered)
+                            {
+                                DoCast(me, SPELL_EMPOWERED_SHOCK_VORTEX);
+                                DoScriptText(EMOTE_VALANAR_SHOCK_VORTEX, me);
+                                events.ScheduleEvent(EVENT_SHOCK_VORTEX, 30000);
+                            }
+                            else
+                            {
+                                if (Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 0.0f, true))
+                                    DoCast(target, SPELL_SHOCK_VORTEX);
+                                events.ScheduleEvent(EVENT_SHOCK_VORTEX, urand(18000, 23000));
+                            }
+                            break;
+                        default:
+                            break;
+                    }
+                }
+
+                DoMeleeAttackIfReady();
+            }
+
+        private:
+            bool bIsEmpowered;  // bool check faster than map lookup
+            uint32 spawnHealth;
+            InstanceScript* instance;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new boss_prince_valanarAI(creature);
+        }
+};
+
+class npc_blood_queen_lana_thel : public CreatureScript
+{
+    public:
+        npc_blood_queen_lana_thel() : CreatureScript("npc_blood_queen_lana_thel") { }
+
+        struct npc_blood_queen_lana_thelAI : public ScriptedAI
+        {
+            npc_blood_queen_lana_thelAI(Creature* creature) : ScriptedAI(creature)
+            {
+                bIntroDone = false;
+                instance = creature->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                events.Reset();
+                me->SetVisible(true);
+                me->AddUnitMovementFlag(MOVEMENTFLAG_LEVITATING);
+            }
+
+            void MoveInLineOfSight(Unit* who)
+            {
+                if (bIntroDone)
+                    return;
+
+                if (!me->IsWithinDistInMap(who, 35.0f))
+                    return;
+
+                bIntroDone = true;
+                DoScriptText(SAY_INTRO_1, me);
+                events.SetPhase(1);
+                events.ScheduleEvent(EVENT_INTRO_1, 14000);
+                // summon a visual trigger
+                if (Creature* summon = DoSummon(CREATURE_FLOATING_TRIGGER, triggerPos, 15000, TEMPSUMMON_TIMED_DESPAWN))
+                {
+                    summon->CastSpell(summon, SPELL_OOC_INVOCATION_VISUAL, true);
+                    summon->SetSpeed(MOVE_FLIGHT, 0.15f, true);
+                    summon->GetMotionMaster()->MovePoint(0, triggerEndPos);
+                }
+            }
+
+            void MovementInform(uint32 type, uint32 id)
+            {
+                if (type == POINT_MOTION_TYPE && id == POINT_INTRO_DESPAWN)
+                    me->SetVisible(false);
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!events.GetPhaseMask() || !instance)
+                    return;
+
+                events.Update(diff);
+
+                if (events.ExecuteEvent() == EVENT_INTRO_1)
+                {
+                    DoScriptText(SAY_INTRO_2, me);
+                    me->GetMotionMaster()->MovePoint(POINT_INTRO_DESPAWN, introFinalPos);
+                    events.Reset();
+
+                    // remove Feign Death from princes
+                    if (Creature* keleseth = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_PRINCE_KELESETH_GUID)))
+                        keleseth->AI()->DoAction(ACTION_STAND_UP);
+
+                    if (Creature* taldaram = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_PRINCE_TALDARAM_GUID)))
+                        taldaram->AI()->DoAction(ACTION_STAND_UP);
+
+                    if (Creature* valanar = ObjectAccessor::GetCreature(*me, instance->GetData64(DATA_PRINCE_VALANAR_GUID)))
+                    {
+                        valanar->AI()->DoAction(ACTION_STAND_UP);
+                        valanar->SetHealth(valanar->GetMaxHealth());
+                    }
+                }
+            }
+
+        private:
+            bool bIntroDone;
+            EventMap events;
+            InstanceScript* instance;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_blood_queen_lana_thelAI(creature);
+        }
+};
+
+class npc_ball_of_flame : public CreatureScript
+{
+    public:
+        npc_ball_of_flame() : CreatureScript("npc_ball_of_flame") { }
+
+        struct npc_ball_of_flameAI : public ScriptedAI
+        {
+            npc_ball_of_flameAI(Creature* creature) : ScriptedAI(creature)
+            {
+                despawnTimer = 0;
+            }
+
+            void Reset()
+            {
+                me->CastSpell(me, SPELL_BALL_OF_FLAMES_VISUAL, true);
+                if (me->GetEntry() == CREATURE_BALL_OF_INFERNO_FLAME)
+                {
+                    me->CastSpell(me, SPELL_BALL_OF_FLAMES_PROC, true);
+                    me->CastSpell(me, SPELL_BALL_OF_FLAMES_PERIODIC, true);
+                }
+            }
+
+            void MovementInform(uint32 type, uint32 id)
+            {
+                if (type == TARGETED_MOTION_TYPE && id == GUID_LOPART(chaseGUID) && chaseGUID)
+                {
+                    me->RemoveAurasDueToSpell(SPELL_BALL_OF_FLAMES_PERIODIC);
+                    DoCastAOE(SPELL_FLAMES);
+                    despawnTimer = 1000;
+                    chaseGUID = 0;
+                }
+            }
+
+            void SetGUID(const uint64& guid, int32 /*type*/)
+            {
+                chaseGUID = guid;
+            }
+
+            void DoAction(const int32 action)
+            {
+                if (action == ACTION_FLAME_BALL_CHASE)
+                    if (Player* target = ObjectAccessor::GetPlayer(*me, chaseGUID))
+                    {
+                        // need to clear states now because this call is before AuraEffect is fully removed
+                        me->ClearUnitState(UNIT_STAT_CASTING | UNIT_STAT_STUNNED);
+                        if (target && me->Attack(target, true))
+                            me->GetMotionMaster()->MoveChase(target, 1.0f);
+                    }
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!despawnTimer)
+                    return;
+
+                if (despawnTimer <= diff)
+                {
+                    despawnTimer = 0;
+                    DoCast(me, SPELL_FLAME_SPHERE_DEATH_EFFECT);
+                }
+                else
+                    despawnTimer -= diff;
+            }
+
+        private:
+            uint32 despawnTimer;
+            uint64 chaseGUID;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_ball_of_flameAI(creature);
+        }
+};
+
+class npc_kinetic_bomb : public CreatureScript
+{
+    public:
+        npc_kinetic_bomb() : CreatureScript("npc_kinetic_bomb") { }
+
+        struct npc_kinetic_bombAI : public ScriptedAI
+        {
+            npc_kinetic_bombAI(Creature* creature) : ScriptedAI(creature) { }
+
+            void Reset()
+            {
+                events.Reset();
+                me->SetDisplayId(DISPLAY_KINETIC_BOMB);
+                me->CastSpell(me, SPELL_UNSTABLE, true);
+                me->CastCustomSpell(SPELL_KINETIC_BOMB_VISUAL, SPELLVALUE_BASE_POINT0, 0x7FFFFFFF, me, true);
+                me->SetReactState(REACT_PASSIVE);
+                me->SetSpeed(MOVE_FLIGHT, IsHeroic() ? 0.3f : 0.15f, true);
+                me->GetPosition(x, y, groundZ);
+                groundZ = me->GetMap()->GetHeight(x, y, groundZ, true, 500.0f);
+            }
+
+            void DoAction(const int32 action)
+            {
+                if (action == SPELL_KINETIC_BOMB_EXPLOSION)
+                    events.ScheduleEvent(EVENT_BOMB_DESPAWN, 1000);
+                else if (action == ACTION_KINETIC_BOMB_JUMP)
+                {
+                    me->GetMotionMaster()->Clear();
+                    me->GetMotionMaster()->MoveJump(x, y, me->GetPositionZ()+7.0f, 1.0f, 7.0f);
+                    events.ScheduleEvent(EVENT_CONTINUE_FALLING, 700);
+                }
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                events.Update(diff);
+
+                while (uint32 eventId = events.ExecuteEvent())
+                {
+                    switch (eventId)
+                    {
+                        case EVENT_BOMB_DESPAWN:
+                            me->SetVisible(false);
+                            break;
+                        case EVENT_CONTINUE_FALLING:
+                            me->GetMotionMaster()->Clear();
+                            me->GetMotionMaster()->MovePoint(POINT_KINETIC_BOMB_IMPACT, x, y, groundZ);
+                            break;
+                        default:
+                            break;
+                    }
+                }
+            }
+
+        private:
+            EventMap events;
+            float x, y, groundZ;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_kinetic_bombAI(creature);
+        }
+};
+
+class npc_dark_nucleus : public CreatureScript
+{
+    public:
+        npc_dark_nucleus() : CreatureScript("npc_dark_nucleus") { }
+
+        struct npc_dark_nucleusAI : public ScriptedAI
+        {
+            npc_dark_nucleusAI(Creature* creature) : ScriptedAI(creature)
+            {
+                lockedTarget = false;
+                targetAuraCheck = 0;
+            }
+
+            void Reset()
+            {
+                me->SetReactState(REACT_PASSIVE);
+                me->CastSpell(me, SPELL_SHADOW_RESONANCE_AURA, true);
+            }
+
+            void EnterCombat(Unit* who)
+            {
+                targetAuraCheck = 1000;
+                if (me->GetDistance(who) >= 15.0f)
+                {
+                    DoStartMovement(who);
+                    return;
+                }
+
+                DoCast(who, SPELL_SHADOW_RESONANCE_RESIST);
+                me->ClearUnitState(UNIT_STAT_CASTING);
+            }
+
+            void MoveInLineOfSight(Unit* who)
+            {
+                if (me->GetDistance(who) >= 15.0f)
+                    return;
+
+                ScriptedAI::MoveInLineOfSight(who);
+            }
+
+            void DamageTaken(Unit* attacker, uint32& /*damage*/)
+            {
+                if (attacker == me)
+                    return;
+
+                if (!lockedTarget)
+                    if (me->getVictim() == attacker)
+                        lockedTarget = true;
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!me->isInCombat())
+                    return;
+
+                if (targetAuraCheck <= diff)
+                {
+                    targetAuraCheck = 1000;
+                    if (Unit *victim = me->getVictim())
+                        if (me->GetDistance(victim) < 15.0f &&
+                            !victim->HasAura(SPELL_SHADOW_RESONANCE_RESIST, me->GetGUID()))
+                        {
+                            DoCast(victim, SPELL_SHADOW_RESONANCE_RESIST);
+                            me->ClearUnitState(UNIT_STAT_CASTING);
+                        }
+                }
+                else
+                    targetAuraCheck -= diff;
+
+                if (!lockedTarget)
+                {
+                    if (Unit *victim = me->SelectVictim())
+                    {
+                        if (me->getVictim() && me->getVictim() != victim)
+                        {
+                            me->getVictim()->RemoveAurasDueToSpell(SPELL_SHADOW_RESONANCE_RESIST, me->GetGUID());
+                            lockedTarget = true;
+                        }
+
+                        lockedTarget = true;
+                        AttackStart(victim);
+                        DoCast(victim, SPELL_SHADOW_RESONANCE_RESIST);
+                        me->ClearUnitState(UNIT_STAT_CASTING);
+                    }
+                }
+            }
+
+        private:
+            uint32 targetAuraCheck; // no point for EventMap with only one timer
+            bool lockedTarget;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_dark_nucleusAI(creature);
+        }
+};
+
+class spell_taldaram_glittering_sparks : public SpellScriptLoader
+{
+    public:
+        spell_taldaram_glittering_sparks() : SpellScriptLoader("spell_taldaram_glittering_sparks") { }
+
+        class spell_taldaram_glittering_sparks_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_taldaram_glittering_sparks_SpellScript);
+
+            void HandleScript(SpellEffIndex effIndex)
+            {
+                PreventHitDefaultEffect(effIndex);
+                GetCaster()->CastSpell(GetCaster(), GetEffectValue(), true);
+            }
+
+            void Register()
+            {
+                OnEffect += SpellEffectFn(spell_taldaram_glittering_sparks_SpellScript::HandleScript, EFFECT_0, SPELL_EFFECT_SCRIPT_EFFECT);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_taldaram_glittering_sparks_SpellScript();
+        }
+};
+
+class spell_taldaram_summon_flame_ball : public SpellScriptLoader
+{
+    public:
+        spell_taldaram_summon_flame_ball() : SpellScriptLoader("spell_taldaram_summon_flame_ball") { }
+
+        class spell_taldaram_summon_flame_ball_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_taldaram_summon_flame_ball_SpellScript);
+
+            void HandleScript(SpellEffIndex effIndex)
+            {
+                PreventHitDefaultEffect(effIndex);
+                GetCaster()->CastSpell(GetCaster(), GetEffectValue(), true);
+            }
+
+            void Register()
+            {
+                OnEffect += SpellEffectFn(spell_taldaram_summon_flame_ball_SpellScript::HandleScript, EFFECT_0, SPELL_EFFECT_DUMMY);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_taldaram_summon_flame_ball_SpellScript();
+        }
+};
+
+class spell_taldaram_flame_ball_visual : public SpellScriptLoader
+{
+    public:
+        spell_taldaram_flame_ball_visual() : SpellScriptLoader("spell_taldaram_flame_ball_visual") { }
+
+        class spell_flame_ball_visual_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_flame_ball_visual_AuraScript);
+
+            bool Load()
+            {
+                if (GetCaster()->GetEntry() == CREATURE_BALL_OF_FLAME || GetCaster()->GetEntry() == CREATURE_BALL_OF_INFERNO_FLAME)
+                    return true;
+                return false;
+            }
+
+            void OnRemove(AuraEffect const* /*aurEff*/, AuraEffectHandleModes /*mode*/)
+            {
+                Creature* target = GetTarget()->ToCreature();
+                if (!target)
+                    return;
+
+                // SPELL_FLAME_SPHERE_SPAWN_EFFECT
+                if (GetSpellProto()->Id == SPELL_FLAME_SPHERE_SPAWN_EFFECT)
+                {
+                    target->CastSpell(target, SPELL_BALL_OF_FLAMES, true);
+                    target->AI()->DoAction(ACTION_FLAME_BALL_CHASE);
+                }
+                else // SPELL_FLAME_SPHERE_DEATH_EFFECT
+                {
+                    if (TempSummon* summ = target->ToTempSummon())
+                        summ->UnSummon();
+                    else
+                        target->ForcedDespawn();
+                }
+            }
+
+            void Register()
+            {
+                OnEffectRemove += AuraEffectRemoveFn(spell_flame_ball_visual_AuraScript::OnRemove, EFFECT_0, SPELL_AURA_MOD_STUN, AURA_EFFECT_HANDLE_REAL);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_flame_ball_visual_AuraScript();
+        }
+};
+
+class spell_taldaram_ball_of_inferno_flame : public SpellScriptLoader
+{
+    public:
+        spell_taldaram_ball_of_inferno_flame() : SpellScriptLoader("spell_taldaram_ball_of_inferno_flame") { }
+
+        class spell_taldaram_ball_of_inferno_flame_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_taldaram_ball_of_inferno_flame_SpellScript);
+
+            void ModAuraStack()
+            {
+                if (Aura* aur = GetHitAura())
+                    aur->SetStackAmount(GetSpellInfo()->StackAmount);
+            }
+
+            void Register()
+            {
+                AfterHit += SpellHitFn(spell_taldaram_ball_of_inferno_flame_SpellScript::ModAuraStack);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_taldaram_ball_of_inferno_flame_SpellScript();
+        }
+};
+
+class spell_valanar_kinetic_bomb : public SpellScriptLoader
+{
+    public:
+        spell_valanar_kinetic_bomb() : SpellScriptLoader("spell_valanar_kinetic_bomb") { }
+
+        class spell_valanar_kinetic_bomb_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_valanar_kinetic_bomb_SpellScript);
+
+            void ChangeSummonPos(SpellEffIndex /*effIndex*/)
+            {
+                WorldLocation* summonPos = GetTargetDest();
+                Position offset = {0.0f, 0.0f, 20.0f, 0.0f};
+                summonPos->RelocateOffset(offset);  // +20 in height
+            }
+
+            void Register()
+            {
+                OnEffect += SpellEffectFn(spell_valanar_kinetic_bomb_SpellScript::ChangeSummonPos, EFFECT_0, SPELL_EFFECT_SUMMON);
+            }
+        };
+
+        class spell_valanar_kinetic_bomb_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_valanar_kinetic_bomb_AuraScript);
+
+            void HandleDummyTick(AuraEffect const* /*aurEff*/)
+            {
+                Unit* target = GetTarget();
+                if (target->GetTypeId() != TYPEID_UNIT)
+                    return;
+
+                if (Creature* bomb = target->FindNearestCreature(CREATURE_KINETIC_BOMB, 1.0f, true))
+                {
+                    bomb->CastSpell(bomb, SPELL_KINETIC_BOMB_EXPLOSION, true);
+                    bomb->RemoveAurasDueToSpell(SPELL_KINETIC_BOMB_VISUAL);
+                    target->RemoveAura(GetAura());
+                    bomb->AI()->DoAction(SPELL_KINETIC_BOMB_EXPLOSION);
+                }
+            }
+
+            void Register()
+            {
+                OnEffectPeriodic += AuraEffectPeriodicFn(spell_valanar_kinetic_bomb_AuraScript::HandleDummyTick, EFFECT_1, SPELL_AURA_PERIODIC_DUMMY);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_valanar_kinetic_bomb_SpellScript();
+        }
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_valanar_kinetic_bomb_AuraScript();
+        }
+};
+
+class spell_valanar_kinetic_bomb_knockback : public SpellScriptLoader
+{
+    public:
+        spell_valanar_kinetic_bomb_knockback() : SpellScriptLoader("spell_valanar_kinetic_bomb_knockback") { }
+
+        class spell_valanar_kinetic_bomb_knockback_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_valanar_kinetic_bomb_knockback_SpellScript);
+
+            void KnockIntoAir()
+            {
+                if (Creature* target = GetHitCreature())
+                    target->AI()->DoAction(ACTION_KINETIC_BOMB_JUMP);
+            }
+
+            void Register()
+            {
+                AfterHit += SpellHitFn(spell_valanar_kinetic_bomb_knockback_SpellScript::KnockIntoAir);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_valanar_kinetic_bomb_knockback_SpellScript();
+        }
+};
+
+class spell_blood_council_shadow_prison : public SpellScriptLoader
+{
+    public:
+        spell_blood_council_shadow_prison() : SpellScriptLoader("spell_blood_council_shadow_prison") { }
+
+        class spell_blood_council_shadow_prison_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_blood_council_shadow_prison_AuraScript);
+
+            void HandleDummyTick(AuraEffect const* aurEff)
+            {
+                if (GetTarget()->isMoving())
+                        GetTarget()->CastSpell(GetTarget(), SPELL_SHADOW_PRISON_DAMAGE, true, NULL, aurEff);
+            }
+
+            void Register()
+            {
+                OnEffectPeriodic += AuraEffectPeriodicFn(spell_blood_council_shadow_prison_AuraScript::HandleDummyTick, EFFECT_0, SPELL_AURA_PERIODIC_DUMMY);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_blood_council_shadow_prison_AuraScript();
+        }
+};
+
+class spell_blood_council_shadow_prison_damage : public SpellScriptLoader
+{
+    public:
+        spell_blood_council_shadow_prison_damage() : SpellScriptLoader("spell_blood_council_shadow_prison_damage") { }
+
+        class spell_blood_council_shadow_prison_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_blood_council_shadow_prison_SpellScript);
+
+            void AddExtraDamage()
+            {
+                if (Aura* aur = GetHitUnit()->GetAura(GetSpellInfo()->Id))
+                    if (AuraEffect const* eff = aur->GetEffect(1))
+                        SetHitDamage(GetHitDamage()+eff->GetAmount());
+            }
+
+            void Register()
+            {
+                OnHit += SpellHitFn(spell_blood_council_shadow_prison_SpellScript::AddExtraDamage);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_blood_council_shadow_prison_SpellScript();
+        }
+};
+
+void AddSC_boss_rat_des_blutes()
+{
+    new boss_blood_council_controller();
+    new boss_prince_keleseth_icc();
+    new boss_prince_taldaram_icc();
+    new boss_prince_valanar_icc();
+    new npc_blood_queen_lana_thel();
+    new npc_ball_of_flame();
+    new npc_kinetic_bomb();
+    new npc_dark_nucleus();
+    new spell_taldaram_glittering_sparks();
+    new spell_taldaram_summon_flame_ball();
+    new spell_taldaram_flame_ball_visual();
+    new spell_taldaram_ball_of_inferno_flame();
+    new spell_valanar_kinetic_bomb();
+    new spell_valanar_kinetic_bomb_knockback();
+    new spell_blood_council_shadow_prison();
+    new spell_blood_council_shadow_prison_damage();
+}
diff --git a/src/server/scripts/Northrend/IcecrownCitadel/boss_sindragosa.cpp b/src/server/scripts/Northrend/IcecrownCitadel/boss_sindragosa.cpp
new file mode 100644
index 0000000..9328638
--- /dev/null
+++ b/src/server/scripts/Northrend/IcecrownCitadel/boss_sindragosa.cpp
@@ -0,0 +1,650 @@
+/*
+* Copyright (C) 2009 - 2010 TrinityCore <http://www.trinitycore.org/>
+*
+* This program is free software; you can redistribute it and/or modify
+* it under the terms of the GNU General Public License as published by
+* the Free Software Foundation; either version 2 of the License, or
+* (at your option) any later version.
+*
+* This program is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+* GNU General Public License for more details.
+*
+* You should have received a copy of the GNU General Public License
+* along with this program; if not, write to the Free Software
+* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
+*/
+
+/*
+*Need correct timers
+*Need add  Sindragossa fly in fly phase
+*/
+
+#include "ScriptMgr.h"
+#include "SpellScript.h"
+#include "SpellAuraEffects.h"
+#include "icecrown_citadel.h"
+
+enum Yells
+{
+    SAY_AGGRO            = -1666071,
+    SAY_UNCHAIND_MAGIC   = -1666072,
+    SAY_BLISTERING_COLD  = -1666073,
+    SAY_BREATH           = -1666074,
+    SAY_AIR_PHASE        = -1666075,
+    SAY_PHASE_3          = -1666076,
+    SAY_KILL_1           = -1666077,
+    SAY_KILL_2           = -1666078,
+    SAY_BERSERK          = -1666079,
+    SAY_DEATH            = -1666080
+};
+
+enum Spells
+{
+    SPELL_FROST_AURA          = 70084,
+    SPELL_CLEAVE              = 19983,
+    SPELL_TAIL_SMASH          = 71077,
+    SPELL_FROST_BREATH        = 73061,
+    SPELL_PERMEATING_CHILL    = 70109,
+    SPELL_UNCHAINED_MAGIC     = 69762, //     
+    SPELL_ICY_TRIP_PULL       = 70117,
+    SPELL_BOMB_VISUAL_1       = 64624,
+    SPELL_BOMB_VISUAL_2       = 69016,
+    SPELL_BLISTERING_COLD     = 71047,
+    SPELL_FROST_BOMB_TRIGGER  = 69846,
+    SPELL_FROST_BEACON        = 70126,
+    SPELL_ICE_TOMB            = 70157,
+    SPELL_FROST_BOMB          = 69845,
+    SPELL_MYSTIC_BUFFED       = 70128,
+    SPELL_ASPHYXATION         = 71665,
+    SPELL_FROST_AURA_ADD      = 71387,
+    SPELL_FROST_BREATH_ADD    = 71386,
+    SPELL_ICE_BLAST           = 71376,
+    SPELL_BELLOWING_ROAR      = 36922,
+    SPELL_CLEAVE_ADD          = 40505,
+    SPELL_TAIL_SWEEP          = 71369
+    //70521
+};
+
+enum ePoints
+{
+    POINT_PHASE_FLY                = 1,
+    POINT_PHASE_NORMAL             = 2
+};
+
+//need add correct coords
+const Position SpawnLoc[]=
+{
+    {4523.889f, 2486.907f, 280.249f, 3.155f}, //fly pos
+    {4407.439f, 2484.905f, 203.374f, 3.166f}, //center
+    {4407.439f, 2484.905f, 230.374f, 3.166f}, //center Z + 30
+    {4671.521f, 2481.815f, 343.365f, 3.166f} //spawn pos
+};
+
+class boss_sindragosa : public CreatureScript
+{
+    public:
+        boss_sindragosa() : CreatureScript("boss_sindragosa") { }
+
+        struct boss_sindragosaAI : public BossAI
+        {
+            boss_sindragosaAI(Creature* creature) : BossAI(creature, DATA_SINDRAGOSA)
+            {
+                instance = me->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                uiPhase = 1;
+
+                uiBreathTimer = 15000;
+                uiTailSmashTimer = 15000;
+                uiBlisteringColdTimer = 30000;
+                uiMarkTimer = 25000;
+                uiBerserkTimer = 600000;
+                uiChangePhaseTimer = 110000;
+                uiUnchainedMagicTimer = 12000;
+                uiBombTimer = 7000;
+                uiCleaveTimer = 5000;
+                uiBombCount = 0;
+
+                me->SetFlying(true);
+                SetCombatMovement(true);
+                me->SetSpeed(MOVE_FLIGHT, 2.5f, true);
+
+                bMystic = false;
+                bCanSwitch = false;
+
+                if(instance)
+                    instance->SetData(DATA_SINDRAGOSA, NOT_STARTED);
+
+                if (me->GetMotionMaster()->GetCurrentMovementGeneratorType() == POINT_MOTION_TYPE)
+                    me->GetMotionMaster()->MovementExpired();
+            }
+
+            void EnterCombat(Unit* /*who*/)
+            {
+                if(instance)
+                    instance->SetData(DATA_SINDRAGOSA, IN_PROGRESS);
+
+                DoCast(me, SPELL_FROST_AURA);
+                DoCast(me, SPELL_PERMEATING_CHILL);
+                DoScriptText(SAY_AGGRO, me);
+            }
+
+            void JustDied(Unit* /*killer*/)
+            {
+                if (!instance)
+                    return;
+
+                DoScriptText(SAY_DEATH, me);
+
+                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_UNCHAINED_MAGIC);
+                instance->SetData(DATA_SINDRAGOSA, DONE);
+                if(instance->GetData(DATA_ALL_YOU_CAN_EAT) == DONE)
+                    instance->DoCompleteAchievement(RAID_MODE(ACHIEV_ALL_YOU_CAN_EAT_10,ACHIEV_ALL_YOU_CAN_EAT_25));
+            }
+
+            void KilledUnit(Unit* victim)
+            {
+                if (victim->GetTypeId() == TYPEID_PLAYER)
+                {
+                    switch(rand()%1)
+                    {
+                        case 0: DoScriptText(SAY_KILL_1, me); break;
+                        case 1: DoScriptText(SAY_KILL_2, me); break;
+                    }
+                }
+            }
+
+            void JustReachedHome()
+            {
+                if (!instance)
+                    return;
+
+                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_UNCHAINED_MAGIC);
+                instance->SetData(DATA_SINDRAGOSA, FAIL);
+            }
+
+            void DamageTaken(Unit* /*done_by*/, uint32& /*damage*/)
+            {
+                if(uiPhase == 1)
+                {
+                    if(!HealthAbovePct(85) && !bCanSwitch)
+                    {
+                        DoScriptText(SAY_AIR_PHASE, me);
+                        uiPhase = 2;
+                        bCanSwitch = true;
+                        SetCombatMovement(false);
+                        me->GetMotionMaster()->MovePoint(POINT_PHASE_FLY, me->GetPositionX(), me->GetPositionY(), me->GetPositionZ() + 30);
+                        me->SetReactState(REACT_PASSIVE);
+                        me->AttackStop();
+                        me->SetInCombatWithZone();
+                    }
+                    if(HealthAbovePct(36))
+                        return;
+
+                    DoScriptText(SAY_PHASE_3, me);
+                    uiPhase = 3;
+                }
+            }
+
+
+            void UpdateAI(const uint32 uiDiff)
+            {
+                if (!UpdateVictim())
+                    return;
+
+                if (uiBerserkTimer <= uiDiff)
+                {
+                    DoScriptText(SAY_BERSERK, me);
+                    DoCast(me, SPELL_BERSERK);
+                    uiBerserkTimer = 600000;
+                } else uiBerserkTimer -= uiDiff;
+
+                if(uiPhase == 1)
+                {
+                    if(uiUnchainedMagicTimer <= uiDiff)
+                    {
+                        for (uint8 i = 1; i <= urand(2, 4); ++i)
+                        {
+                            if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, -10.0f, true, -SPELL_UNCHAINED_MAGIC))
+                                DoCast(target, SPELL_UNCHAINED_MAGIC);
+                        }
+                        DoScriptText(SAY_UNCHAIND_MAGIC, me);
+                        uiUnchainedMagicTimer = 12000;
+                    } else uiUnchainedMagicTimer -= uiDiff;
+
+                    if (uiBreathTimer <= uiDiff)
+                    {
+                        DoScriptText(SAY_BREATH, me);
+                        DoCastVictim(SPELL_FROST_BREATH);
+                        uiBreathTimer = 15000;
+                    } else uiBreathTimer -= uiDiff;
+
+                    if (uiCleaveTimer <= uiDiff)
+                    {
+                        DoCastVictim(SPELL_CLEAVE);
+                        uiCleaveTimer = 6000;
+                    } else uiCleaveTimer -= uiDiff;
+
+                    if (uiTailSmashTimer <= uiDiff)
+                    {
+                        DoCast(SPELL_TAIL_SMASH);
+                        uiTailSmashTimer = 15000;
+                    } else uiTailSmashTimer -= uiDiff;
+
+                    if (uiBlisteringColdTimer <= uiDiff)
+                    {
+                        DoCast(SPELL_ICY_TRIP_PULL);
+                        DoCast(SPELL_BLISTERING_COLD);
+                        DoScriptText(SAY_BLISTERING_COLD, me);
+                        uiBlisteringColdTimer = 30000;
+                    } else uiBlisteringColdTimer -= uiDiff;
+                }
+
+                if(uiPhase == 2)
+                {
+                    if (uiMarkTimer < uiDiff)
+                    {
+                        for (uint8 i = 1; i <= RAID_MODE(2,5,2,5); ++i)
+                        {
+                            if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true, -SPELL_FROST_BEACON))
+                                DoCast(target, SPELL_FROST_BEACON);
+                        }
+                        uiMarkTimer = 25000;
+                    } else uiMarkTimer -= uiDiff;
+
+                    if (uiBombTimer <= uiDiff)
+                    {
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 150.0f, true))
+                            DoCast(target, SPELL_FROST_BOMB);
+                        ++uiBombCount;
+                        uiBombTimer = 7000;
+                    } else uiBombTimer -= uiDiff;
+
+                    if(uiBombCount >= RAID_MODE(4,8,4,8))
+                    {
+                        me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_ONESHOT_NONE);
+                        SetCombatMovement(true);
+                        me->SetReactState(REACT_AGGRESSIVE);
+                        me->AttackStop();
+                        me->SetInCombatWithZone();
+                        me->GetMotionMaster()->MovePoint(POINT_PHASE_NORMAL, SpawnLoc[1]);
+                        uiPhase = 1;
+                        uiBombCount = 0;
+                    }
+                }
+
+                if(uiPhase == 3)
+                {
+                    if (uiMarkTimer < uiDiff)
+                    {
+                        for (uint8 i = 1; i <= RAID_MODE(2,5,2,5); ++i)
+                        {
+                            if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true, -SPELL_FROST_BEACON))
+                                DoCast(target, SPELL_FROST_BEACON);
+                        }
+                        uiMarkTimer = 25000;
+                    } else uiMarkTimer -= uiDiff;
+
+                    if (uiBreathTimer <= uiDiff)
+                    {
+                        DoScriptText(SAY_BREATH, me);
+                        DoCast(SPELL_FROST_BREATH);
+                        uiBreathTimer = 15000;
+                    } else uiBreathTimer -= uiDiff;
+
+                    if(!bMystic)
+                    {
+                       DoCast(me, SPELL_MYSTIC_BUFFED);
+                       bMystic = true;
+                    }
+                }
+
+                if(!bCanSwitch || uiPhase != 1)
+                    return;
+
+                if (uiChangePhaseTimer < uiDiff)
+                {
+                    DoScriptText(SAY_AIR_PHASE, me);
+                    uiPhase = 2;
+                    SetCombatMovement(false);
+                    me->GetMotionMaster()->MovePoint(POINT_PHASE_FLY, SpawnLoc[2]);
+                    me->SetReactState(REACT_PASSIVE);
+                    me->AttackStop();
+                    me->SetInCombatWithZone();
+                    uiChangePhaseTimer = 110000;
+                } else uiChangePhaseTimer -= uiDiff;
+
+                DoMeleeAttackIfReady();
+            }
+
+        private:
+            InstanceScript* instance;
+
+            uint8 uiPhase;
+            uint8 uiBombCount;
+            uint32 uiBreathTimer;
+            uint32 uiCleaveTimer;
+            uint32 uiTailSmashTimer;
+            uint32 uiBlisteringColdTimer;
+            uint32 uiBerserkTimer;
+            uint32 uiMarkTimer;
+            uint32 uiChangePhaseTimer;
+            uint32 uiUnchainedMagicTimer;
+            uint32 uiBombTimer;
+
+            bool bMystic;
+            bool bCanSwitch;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new boss_sindragosaAI(creature);
+        }
+};
+
+class npc_ice_tomb : public CreatureScript
+{
+    public:
+        npc_ice_tomb() : CreatureScript("npc_ice_tomb") { }
+
+        struct npc_ice_tombAI: public Scripted_NoMovementAI
+        {
+            npc_ice_tombAI(Creature* creature) : Scripted_NoMovementAI(creature)
+            {
+                uiTargetGUID = 0;
+            }
+
+            void SetGUID(const uint64& guid)
+            {
+                uiTargetGUID = guid;
+            }
+
+            void Reset()
+            {
+                uiTargetGUID = 0;
+            }
+
+            void JustDied(Unit* killer)
+            {
+                if (Player* IceTomb = ObjectAccessor::GetPlayer(*me, uiTargetGUID))
+                {
+                    IceTomb->RemoveAurasDueToSpell(SPELL_ICE_TOMB);
+                    IceTomb->RemoveAurasDueToSpell(SPELL_ASPHYXATION);
+                }
+            }
+
+            void KilledUnit(Unit* victim)
+            {
+                me->Kill(me);
+            }
+
+            void UpdateAI(const uint32 /*uiDiff*/)
+            {
+                if(!uiTargetGUID)
+                    return;
+
+                if (Player* IceTomb = ObjectAccessor::GetPlayer(*me, uiTargetGUID))
+                    if (!IceTomb->HasAura(SPELL_ICE_TOMB))
+                        me->Kill(me);
+            }
+
+        private:
+            uint64 uiTargetGUID;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_ice_tombAI(creature);
+        }
+};
+
+class npc_rimefang : public CreatureScript
+{
+    public:
+        npc_rimefang() : CreatureScript("npc_rimefang") { }
+
+        struct npc_rimefangAI: public ScriptedAI
+        {
+            npc_rimefangAI(Creature* creature) : ScriptedAI(creature)
+            {
+                instance = creature->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                uiFrostBreathTimer = 5000;
+                uiIceBlastTimer = 7000;
+                me->SetFlying(true);
+            }
+
+            void EnterCombat(Unit* /*who*/)
+            {
+                DoCast(me, SPELL_FROST_AURA_ADD);
+            }
+
+            void JustDied(Unit* /*killer*/)
+            {
+                if(instance)
+                    if(instance->GetData(DATA_SINDRAGOSA) != DONE)
+                        instance->SetData(DATA_SPAWN, +1);
+            }
+
+            void UpdateAI(const uint32 uiDiff)
+            {
+                if (!UpdateVictim())
+                    return;
+
+                if (uiFrostBreathTimer <= uiDiff)
+                {
+                    DoCastVictim( SPELL_FROST_BREATH_ADD);
+                    uiFrostBreathTimer = 6000;
+                } else uiFrostBreathTimer -= uiDiff;
+
+                if (uiIceBlastTimer <= uiDiff)
+                {
+                    DoCast(me, SPELL_ICE_BLAST);
+                    uiIceBlastTimer = 8000;
+                } else uiIceBlastTimer -= uiDiff;
+
+                DoMeleeAttackIfReady();
+            }
+
+        private:
+            InstanceScript* instance;
+
+            uint32 uiFrostBreathTimer;
+            uint32 uiIceBlastTimer;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_rimefangAI(creature);
+        }
+};
+
+class npc_spinestalker : public CreatureScript
+{
+    public:
+        npc_spinestalker() : CreatureScript("npc_spinestalker") { }
+
+        struct npc_spinestalkerAI: public ScriptedAI
+        {
+            npc_spinestalkerAI(Creature* creature) : ScriptedAI(creature)
+            {
+                instance = creature->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                uiRoarTimer = 14000;
+                uiCleaveTimer = 6000;
+                uiSweepTimer = 7000;
+                me->SetFlying(true);
+            }
+
+            void EnterCombat(Unit* /*who*/)
+            {
+                DoCast(me, SPELL_FROST_AURA_ADD);
+            }
+
+            void JustDied(Unit* /*killer*/)
+            {
+                if(instance)
+                    if(instance->GetData(DATA_SINDRAGOSA) != DONE)
+                        instance->SetData(DATA_SPAWN, +1);
+            }
+
+            void UpdateAI(const uint32 uiDiff)
+            {
+                if (!UpdateVictim())
+                    return;
+
+                if (uiRoarTimer <= uiDiff)
+                {
+                    DoCastAOE(SPELL_BELLOWING_ROAR);
+                    uiRoarTimer = 15000;
+                } else uiRoarTimer -= uiDiff;
+
+                if (uiCleaveTimer <= uiDiff)
+                {
+                    DoCastVictim( SPELL_CLEAVE_ADD);
+                    uiCleaveTimer = 5000;
+                } else uiCleaveTimer -= uiDiff;
+
+                if (uiSweepTimer <= uiDiff)
+                {
+                    DoCast(SPELL_TAIL_SWEEP);
+                    uiSweepTimer = 7000;
+                } else uiSweepTimer -= uiDiff;
+
+                DoMeleeAttackIfReady();
+            }
+        private:
+            InstanceScript* instance;
+
+            uint32 uiRoarTimer;
+            uint32 uiCleaveTimer;
+            uint32 uiSweepTimer;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_spinestalkerAI(creature);
+        }
+};
+
+class spell_sindragosa_ice_tomb : public SpellScriptLoader
+{
+    public:
+        spell_sindragosa_ice_tomb() : SpellScriptLoader("spell_sindragosa_ice_tomb") { } //70157
+
+
+        class spell_sindragosa_ice_tomb_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_sindragosa_ice_tomb_AuraScript)
+
+            void OnRemove(AuraEffect const* aurEff, AuraEffectHandleModes /*mode*/)
+            {
+                if(Unit* beacon = GetCaster())
+                {
+                    if (InstanceScript* instance = GetOwner()->GetInstanceScript())
+                        if (Creature* sindragosa = Unit::GetCreature(*GetOwner(), instance->GetData64(DATA_SINDRAGOSA)))
+                            if(sindragosa->isAlive())
+                                sindragosa->CastSpell(beacon, SPELL_ICE_TOMB, true);
+
+                    beacon->CastSpell(beacon, SPELL_ASPHYXATION, true);
+                    Creature* tomb = beacon->SummonCreature(CREATURE_ICE_TOMB, beacon->GetPositionX(), beacon->GetPositionY(), beacon->GetPositionZ(), 0, TEMPSUMMON_CORPSE_DESPAWN);
+                    if(tomb)
+                        tomb->AI()->SetGUID(beacon->GetGUID());
+                }
+            }
+
+            void Register()
+            {
+                OnEffectRemove += AuraEffectRemoveFn(spell_sindragosa_ice_tomb_AuraScript::OnRemove, EFFECT_2, SPELL_AURA_PERIODIC_TRIGGER_SPELL, AURA_EFFECT_HANDLE_REAL);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_sindragosa_ice_tomb_AuraScript();
+        }
+};
+
+class spell_sindragosa_mystic_buffet : public SpellScriptLoader
+{
+    public:
+        spell_sindragosa_mystic_buffet() : SpellScriptLoader("spell_sindragosa_mystic_buffet") { } //70127
+
+
+        class spell_sindragosa_mystic_buffet_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_sindragosa_mystic_buffet_AuraScript)
+
+            void OnApply(AuraEffect const* aurEff, AuraEffectHandleModes /*mode*/)
+            {
+                if (InstanceScript* instance = GetOwner()->GetInstanceScript())
+                    if(GetStackAmount() >= 5)
+                        instance->SetData(DATA_ALL_YOU_CAN_EAT, FAIL);
+                    else
+                        instance->SetData(DATA_ALL_YOU_CAN_EAT, DONE);
+            }
+
+            void Register()
+            {
+                OnEffectApply += AuraEffectApplyFn(spell_sindragosa_mystic_buffet_AuraScript::OnApply, EFFECT_0, SPELL_AURA_MOD_DAMAGE_PERCENT_TAKEN, AURA_EFFECT_HANDLE_REAL);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_sindragosa_mystic_buffet_AuraScript();
+        }
+};
+
+class spell_sindragosa_unchained_magic : public SpellScriptLoader
+{
+    public:
+        spell_sindragosa_unchained_magic() : SpellScriptLoader("spell_sindragosa_unchained_magic") { } //69766
+
+
+        class spell_sindragosa_unchained_magic_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_sindragosa_unchained_magic_AuraScript)
+
+            void OnRemove(AuraEffect const* aurEff, AuraEffectHandleModes /*mode*/)
+            {
+                Unit* caster = GetCaster();
+                if (!caster)
+                    return;
+
+                int32 damage = (GetStackAmount() * 2000);
+                GetTarget()->CastCustomSpell(71044, SPELLVALUE_BASE_POINT0, damage, GetTarget(), true, NULL, aurEff, GetCasterGUID());
+            }
+
+            void Register()
+            {
+                OnEffectRemove += AuraEffectRemoveFn(spell_sindragosa_unchained_magic_AuraScript::OnRemove, EFFECT_0, SPELL_AURA_DUMMY, AURA_EFFECT_HANDLE_REAL);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_sindragosa_unchained_magic_AuraScript();
+        }
+};
+
+void AddSC_boss_sindragosa()
+{
+    new boss_sindragosa();
+    new npc_spinestalker();
+    new npc_rimefang();
+    new npc_ice_tomb();
+    new spell_sindragosa_ice_tomb();
+    new spell_sindragosa_mystic_buffet(); //for achievement
+    new spell_sindragosa_unchained_magic();
+}
\ No newline at end of file
diff --git a/src/server/scripts/Northrend/IcecrownCitadel/boss_the_lich_king.cpp b/src/server/scripts/Northrend/IcecrownCitadel/boss_the_lich_king.cpp
new file mode 100644
index 0000000..3b23763
--- /dev/null
+++ b/src/server/scripts/Northrend/IcecrownCitadel/boss_the_lich_king.cpp
@@ -0,0 +1,1366 @@
+/*
+* Copyright (C) 2009 - 2010 TrinityCore <http://www.trinitycore.org/>
+*
+* This program is free software; you can redistribute it and/or modify
+* it under the terms of the GNU General Public License as published by
+* the Free Software Foundation; either version 2 of the License, or
+* (at your option) any later version.
+*
+* This program is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+* GNU General Public License for more details.
+*
+* You should have received a copy of the GNU General Public License
+* along with this program; if not, write to the Free Software
+* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
+*/
+
+#include "ObjectMgr.h"
+#include "ScriptMgr.h"
+#include "ScriptedCreature.h"
+#include "SpellScript.h"
+#include "SpellAuraEffects.h"
+#include "icecrown_citadel.h"
+
+#define GOSSIP_MENU 10600
+//#define GOSSIP_MENU "Long have I waited for this day, hero. Are you and your allies prepared to bring the Lich King to justice? We charge on your command!"
+#define GOSSIP_START_EVENT "We are prepared, Highlord. Let us battle for the fate of Azeroth! For the light of dawn!"
+
+enum Yells
+{
+    SAY_INTRO_1_KING         = -1810001,
+    SAY_INTRO_2_TIRION       = -1810002,
+    SAY_INTRO_3_KING         = -1810003,
+    SAY_INTRO_4_TIRION       = -1810004,
+    SAY_INTRO_5_KING         = -1810005,
+    SAY_AGGRO                = -1810006,
+    SAY_REMORSELESS_WINTER   = -1810007,
+    SAY_RANDOM_1             = -1810008,
+    SAY_RANDOM_2             = -1810009,
+    SAY_KILL_1               = -1810010,
+    SAY_KILL_2               = -1810011,
+    SAY_BERSERK              = -1810012,
+    SAY_ENDING_1_KING        = -1810013,
+    SAY_ENDING_2_KING        = -1810014,
+    SAY_ENDING_3_KING        = -1810015,
+    SAY_ENDING_4_KING        = -1810016,
+    SAY_ENDING_5_TIRION      = -1810017,
+    SAY_ENDING_6_KING        = -1810018,
+    SAY_ENDING_8_TIRION      = -1810020,
+    SAY_ENDING_9_FATHER      = -1810021,
+    SAY_ENDING_10_TIRION     = -1810022,
+    SAY_ENDING_11_FATHER     = -1810023,
+    SAY_ENDING_12_KING       = -1810024,
+    SAY_DEATH_KING           = -1810025,
+    SAY_ESCAPE_FROSTMOURNE   = -1810026,
+    SAY_HARVEST_SOUL         = -1810027,
+    SAY_DEVOURED_FROSTMOURNE = -1810028,
+    SAY_SUMMON_VALKYR        = -1810029,
+    SAY_BROKEN_ARENA         = -1810030,
+    SAY_10_PROZENT           = -1810031,
+    SAY_EMOTE_DEFILE         = -1810032,
+};
+
+enum Spells
+{
+    SPELL_SUMMON_SHAMBLING_HORROR    = 70372,
+    SPELL_SUMMON_DRUDGE_GHOULS       = 70358,
+    SPELL_SUMMON_ICE_SPEHERE         = 69104,
+    SPELL_SUMMON_RAGING_SPIRIT       = 69200,
+    SPELL_SUMMON_VALKYR              = 74361,
+    SPELL_SUMMON_DEFILE              = 72762,
+    SPELL_SUMMON_VILE_SPIRIT         = 70498, //????????
+    SPELL_SUMMON_BROKEN_FROSTMOURNE  = 72406,
+    SPELL_SUMMON_SHADOW_TRAP         = 73539,
+    SPELL_INFEST                     = 70541,
+    SPELL_NECROTIC_PLAGUE            = 70337, //70337 - initial cast
+    SPELL_NECROTIC_PLAGUE_IMMUNITY   = 72846,
+    SPELL_PLAGUE_SIPHON              = 74074,
+    SPELL_REMORSELES_WINTER          = 68981,
+    SPELL_REMORSELES_WINTER_DAMAGE   = 68983,
+    SPELL_PAIN_AND_SUFFERING         = 74115,
+    //SPELL_RANDOM_TALK                = 73985,
+    SPELL_WINGS_OF_THE_DAMNED        = 74352,
+    SPELL_SOUL_REAPER                = 69409,
+    SPELL_SOUL_REAPER_HASTE_AURA     = 69410,
+    SPELL_HARVEST_SOUL_TELEPORT      = 71372, //72597
+    SPELL_HARVEST_SOULS              = 68980,
+    SPELL_QUAKE                      = 72262,
+    SPELL_CHANNEL_KING               = 71769,
+    SPELL_BROKEN_FROSTMOURNE         = 72398,
+    SPELL_BOOM_VISUAL                = 72726,
+    SPELL_ICEBLOCK_TRIGGER           = 71614,
+    SPELL_TIRION_LIGHT               = 71797,
+    SPELL_FROSTMOURNE_TRIGGER        = 72405,
+    SPELL_DISENGAGE                  = 61508,
+    SPELL_FURY_OF_FROSTMOURNE        = 72350,
+    SPELL_REVIVE                     = 72429,
+    SPELL_REVIVE_EFFECT              = 72423,
+    SPELL_CLONE_PLAYER               = 57507,
+    SPELL_DEFILE                     = 72743,
+    SPELL_ICE_PULSE                  = 69091,
+    SPELL_ICE_BURST                  = 69108,
+    SPELL_LIFE_SIPHON                = 73783,
+    SPELL_SOUL_SHRIEK                = 69242,
+    SPELL_WHOCKVAWE                  = 72149,
+    SPELL_ENRAGE                     = 72143,
+    SPELL_BURST                      = 70503,
+    SPELL_VILE_SPIRIT_DISTANCE_CHECK = 70502,
+    SPELL_ICE_BURST_DISTANCE_CHECK   = 69109,
+    SPELL_VILE_SPIRIT_ACTIVE         = 72130,
+    SPELL_RAGING_VISUAL              = 69198,
+    SPELL_REMOVE_WEAPON              = 72399,
+    SPELL_DROP_FROSTMOURNE           = 73017,
+    SPELL_SUMMON_FROSTMOURNE_TRIGGER = 72407,
+    SPELL_WMO_INTACT                 = 50176,
+    SPELL_WMO_DAMAGE                 = 50177,
+    SPELL_PLAY_MOVIE                 = 73159,
+    SPELL_SUMMON_MENETHIL            = 72420, //caster - 38584
+    SPELL_MENETHIL_VISUAL            = 72372,
+    SPELL_VALKYR_CARRY_CAN_CAST      = 74506,
+    SPELL_VALKYR_MOVE_PLAYER         = 68985, //74445
+    SPELL_VALKYR_TARGET_SEARCH       = 69030,
+    SPELL_VALKYR_CHARGE              = 74399,
+    SPELL_VALYR_EJECT_PASSANGER      = 68576,
+    SPELL_LIGH_EFFECT                = 71773,
+    SPELL_EMOTE_SHOUT                = 73213,
+    SPELL_RAGING_GHOUL_VISUAL        = 69636,
+    SPELL_RISEN_WITCH_DOCTOR_SPAWN   = 69639,
+    SPELL_ICE_SPHERE_VISUAL          = 69090,
+    SPELL_TIRION_JUMP                = 71809,
+    SPELL_LICH_KING_STOP_CAST_RES    = 72431,
+    SPELL_FROSTMOURNE_DESPAWN        = 72726,
+    SPELL_SUMMON_FROSTMOURNE         = 74081,
+    SPELL_SOUL_EFFECT                = 72305,
+
+    //SPELL_70501 //Vile Spirit Move Target Search
+};
+
+enum eActions
+{
+    ACTION_PHASESWITCH_1        = 1, //phase 1 and 3
+    ACTION_PHASESWITCH_2        = 2, //phase 2 and 4
+    ACTION_START_EVENT          = 3
+};
+
+enum ePoints
+{
+    POINT_START_EVENT_1              = 3659700,
+    POINT_PLATFORM_CENTRE            = 3659701,
+    POINT_PLATFORM_END               = 3659702,
+    POINT_VALKYR_END                 = 3659703,
+    POINT_VALKYR_ZET                 = 3659704
+};
+
+struct Position StartEvent[]=
+{
+    {465.0731f, -2123.473f, 1040.8569f},
+    {462.8351f, -2123.673f, 1040.9082f},
+    {461.5851f, -2123.673f, 1041.4082f},
+    {445.5851f, -2123.673f, 1056.1582f},
+    {436.0851f, -2123.673f, 1064.6582f}
+};
+
+struct Position MovePos[]=
+{
+    {461.792f, -2125.85f, 1040.860f, 0.0f}, // move
+    {503.156f, -2124.51f, 1040.860f, 0.0f}, // move center X: 505.2118 Y: -2124.353 Z: 840.9403
+    {490.110f, -2124.98f, 1040.860f, 0.0f}, // move tirion frostmourne
+    {467.069f, -2123.58f, 1040.857f, 0.0f}, // move tirion attack
+    {498.004f, 2201.57f, 1046.093f, 0.0f},  // move valkyr
+    {489.297f, -2124.84f, 1040.857f, 0.0f}, //start event tirion move 1
+    {503.682f, -2126.63f, 1040.940f, 0.0f}, //   
+    {508.989f, -2124.55f, 1045.356f, 0.0f} //   
+};
+
+/*struct Locations
+{
+    float x,y,z;
+};
+
+static Locations TeleportPoint[]=
+{
+    {959.996f, 212.576f, 193.843f},
+    {932.537f, 231.813f, 193.838f},
+    {958.675f, 254.767f, 193.822f},
+    {946.955f, 201.316f, 192.535f},
+    {944.294f, 149.676f, 197.551f},
+    {930.548f, 284.888f, 193.367f},
+    {965.997f, 278.398f, 195.777f},
+};*/
+
+class boss_the_lich_king : public CreatureScript
+{
+    public:
+        boss_the_lich_king() : CreatureScript("boss_the_lich_king") { }
+
+        struct boss_the_lich_kingAI : public BossAI
+        {
+            boss_the_lich_kingAI(Creature* creature) : BossAI(creature, DATA_LICH_KING), summons(me)
+            {
+                instance = me->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                me->SetReactState(REACT_PASSIVE);
+                me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+
+                uiPhase = 1;
+                uiRandomSpeechTimer = 33000;
+                uiBerserkTimer = 900000;
+                uiSummonShamblingHorrorTimer = 20000;
+                uiSummonDrudgeGhoulsTimer = 30000;
+                uiInfestTimer = 30000;
+                uiNecroticPlagueTimer = 30000;
+                uiIcePulsSummonTimer = 10000;
+                uiSummonSpiritTimer = 25000;
+                uiSummonValkyrTimer = 5000;
+                uiSoulReaperTimer = 30000;
+                uiDefileTimer = 25000;
+                uiInfestTimer = 40000;
+                uiSummonVileSpiritTimer = 30000;
+                uiHarvestSoulTimer = 70000;
+                uiSummonShadowTrap = 20000;
+                uiEndingTimer = 1000;
+                uiStage = 1;
+                uiTirionGUID = 0;
+
+                if(!instance)
+                    return;
+
+                instance->SetData(DATA_THE_LICH_KING, NOT_STARTED);
+                instance->SetData(DATA_BEEN_WAITING, NOT_STARTED);
+                instance->SetData(DATA_NECK_DEEP, DONE);
+
+                if (me->GetMotionMaster()->GetCurrentMovementGeneratorType() == POINT_MOTION_TYPE)
+                    me->GetMotionMaster()->MovementExpired();
+
+                if(SpellEntry* spellRevive = GET_SPELL(SPELL_SUMMON_DEFILE))
+                    spellRevive->DurationIndex = 3;
+
+                if(SpellEntry* lock = GET_SPELL(SPELL_ICEBLOCK_TRIGGER))
+                    lock->Targets = 6; //target chain damage
+
+                if(SpellEntry* reaper = GET_SPELL(SPELL_SOUL_REAPER_HASTE_AURA))
+                    reaper->Targets = 1;
+
+                if(SpellEntry* plague = GET_SPELL(SPELL_PLAGUE_SIPHON)) //hack
+                    plague->Targets = 18;
+
+                if(SpellEntry* raging = GET_SPELL(SPELL_SUMMON_RAGING_SPIRIT))
+                {
+                    raging->DurationIndex = 28;
+                    raging->Effect[0] = 6;
+                }
+            }
+
+            void EnterCombat(Unit* /*pWho*/)
+            {
+                DoScriptText(SAY_AGGRO, me);
+                DoCast(me, SPELL_NECROTIC_PLAGUE_IMMUNITY);
+                if(instance)
+                    uiTirionGUID = instance->GetData64(DATA_TIRION);
+
+                if(instance)
+                    instance->SetData(DATA_THE_LICH_KING, IN_PROGRESS);
+            }
+
+            void JustDied(Unit* /*pKiller*/)
+            {
+                if(!instance)
+                    return;
+
+                DoScriptText(SAY_DEATH_KING, me);
+                DoCast(SPELL_PLAY_MOVIE);
+                instance->SetData(DATA_THE_LICH_KING, DONE);
+                if(instance->GetData(DATA_BEEN_WAITING) == DONE)
+                    instance->DoCompleteAchievement(RAID_MODE(ACHIEV_BEEN_WAITING_A_LONG_TIME_FOR_THIS_10,ACHIEV_BEEN_WAITING_A_LONG_TIME_FOR_THIS_25));
+                if(instance->GetData(DATA_NECK_DEEP) == FAIL)
+                    instance->DoCompleteAchievement(RAID_MODE(ACHIEV_NECK_DEEP_IN_VILE_10,ACHIEV_NECK_DEEP_IN_VILE_25));
+
+                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_INFEST);
+
+                summons.DespawnAll();
+            }
+
+            void MovementInform(uint32 type, uint32 id)
+            {
+                if(type != POINT_MOTION_TYPE)
+                    return;
+
+                switch(id)
+                {
+                    case POINT_PLATFORM_CENTRE:
+                        DoScriptText(SAY_REMORSELESS_WINTER, me);
+                        DoCast(me, SPELL_REMORSELES_WINTER);
+                        DoCast(me, SPELL_PAIN_AND_SUFFERING);
+                        DoCast(me, SPELL_WMO_INTACT);
+                        me->GetMotionMaster()->MovementExpired();
+                        break;
+                }
+            }
+
+            void JustReachedHome()
+            {
+                if(!instance)
+                    return;
+
+                instance->SetData(DATA_THE_LICH_KING, FAIL);
+                instance->DoRemoveAurasDueToSpellOnPlayers(SPELL_INFEST);
+
+                if(uiTirionGUID)
+                    if(Creature* tirion = Unit::GetCreature(*me, uiTirionGUID))
+                        tirion->SetFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_GOSSIP);
+
+                summons.DespawnAll();
+            }
+
+            void KilledUnit(Unit* victim)
+            {
+                if (uiPhase != 6 && victim->GetTypeId() == TYPEID_PLAYER)
+                    DoScriptText(RAND(SAY_KILL_1, SAY_KILL_2), me);
+            }
+
+            void JustSummoned(Creature* summoned)
+            {
+                summons.Summon(summoned);
+                switch(summoned->GetEntry())
+                {
+                    case CREATURE_ICE_SPHERE:
+                        summoned->CastSpell(summoned, SPELL_ICE_BURST_DISTANCE_CHECK, true);
+                        summoned->CastSpell(summoned, SPELL_ICE_PULSE, true);
+                        summoned->CastSpell(summoned, SPELL_ICE_SPHERE_VISUAL, true);
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                        {
+                            summoned->AI()->AttackStart(target);
+                            summoned->GetMotionMaster()->MoveChase(target);
+                        }
+                        break;
+                    case CREATURE_DEFILE:
+                        summoned->CastSpell(summoned, SPELL_DEFILE, true);
+                        summoned->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+                        break;
+                    case CREATURE_RAGING_SPIRIT:
+                        summoned->ApplySpellImmune(0, IMMUNITY_STATE, SPELL_AURA_MOD_TAUNT, true);
+                        summoned->getVictim()->CastSpell(summoned, SPELL_RAGING_VISUAL, true);
+                        summoned->CastSpell(summoned, SPELL_NECROTIC_PLAGUE_IMMUNITY, true);
+                        break;
+                    case CREATURE_VILE_SPIRIT:
+                        summoned->CastSpell(summoned, SPELL_VILE_SPIRIT_DISTANCE_CHECK, true);
+                        break;
+                    case CREATURE_TRIGGER:
+                        summoned->AI()->AttackStart(me);
+                        summoned->SetVisible(false);
+                        summoned->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+                        break;
+                    case CREATURE_FROSTMOURNE_TRIGGER:
+                        summoned->CastSpell(summoned, SPELL_BROKEN_FROSTMOURNE, false);
+                        summoned->CastSpell(summoned, SPELL_FROSTMOURNE_TRIGGER, false);
+                        summoned->SetVisible(false);
+                        break;
+                    case CREAUTRE_MENETHIL:
+                        DoScriptText(SAY_ENDING_9_FATHER, summoned);
+                        summoned->CastSpell(summoned, SPELL_REVIVE, true);
+                        summoned->CastSpell(summoned, SPELL_MENETHIL_VISUAL, true);
+                        break;
+                    case CREATURE_VALKYR:
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                            summoned->AI()->AttackStart(target);
+                        summoned->CastSpell(summoned, SPELL_WINGS_OF_THE_DAMNED, true);
+                        summoned->CastSpell(summoned, SPELL_VALKYR_CARRY_CAN_CAST, true);
+                        break;
+                    case CREATURE_DRUDGE_GHOUL:
+                        summoned->CastSpell(summoned, SPELL_RAGING_GHOUL_VISUAL, true);
+                        break;
+                    case CREATURE_SHAMBLING_HORROR:
+                        summoned->CastSpell(summoned, SPELL_RISEN_WITCH_DOCTOR_SPAWN, true);
+                        break;
+                }
+            }
+
+            void DoAction(const int32 action)
+            {
+                switch(action)
+                {
+                    case ACTION_PHASESWITCH_1:
+                        me->SetReactState(REACT_PASSIVE);
+                        me->AttackStop();
+                        me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+                        SetCombatMovement(false);
+                        me->SetInCombatWithZone();
+                        me->GetMotionMaster()->MovePoint(POINT_PLATFORM_CENTRE, MovePos[1]);
+                        break;
+                    case ACTION_PHASESWITCH_2:
+                        uiPhase = uiPhase == 2 ? 3 : 5;
+                        me->SetReactState(REACT_AGGRESSIVE);
+                        me->RemoveAurasDueToSpell(SPELL_PAIN_AND_SUFFERING);
+                        me->SetInCombatWithZone();
+                        SetCombatMovement(true);
+                        me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+                        break;
+                }
+            }
+
+            void DamageTaken(Unit* /*done_by*/, uint32& /*damage*/)
+            {
+                switch(uiPhase)
+                {
+                    case 1:
+                        if(!HealthAbovePct(71))
+                        {
+                            uiPhase = 2;
+                            DoAction(ACTION_PHASESWITCH_1);
+                            break;
+                        }
+                    case 3:
+                        if(!HealthAbovePct(41))
+                        {
+                            uiPhase = 4;
+                            DoAction(ACTION_PHASESWITCH_1);
+                            break;
+                        }
+                    case 5:
+                        if(!HealthAbovePct(11))
+                        {
+                            me->SummonCreature(CREATURE_TRIGGER, MovePos[6], TEMPSUMMON_CORPSE_DESPAWN, 900000);
+                            summons.DespawnAll();
+                            uiPhase = 6; //ending
+                        }
+                        break;
+                }
+            }
+
+            void UpdateAI(const uint32 uiDiff)
+            {
+                if (!UpdateVictim())
+                    return;
+
+                if(uiPhase != 6)
+                {
+                    if (uiRandomSpeechTimer < uiDiff)
+                    {
+                        DoScriptText(RAND(SAY_RANDOM_1,SAY_RANDOM_2), me);
+                        uiRandomSpeechTimer = 33000;
+                    } else uiRandomSpeechTimer -= uiDiff;
+
+                    if (uiBerserkTimer < uiDiff)
+                    {
+                        DoScriptText(SAY_BERSERK, me);
+                        DoCast(me, SPELL_BERSERK);
+                        uiBerserkTimer = 900000;
+                    } else uiBerserkTimer -= uiDiff;
+                }
+
+                if(uiPhase == 1)
+                {
+                    if (IsHeroic())
+                    {
+                        if (uiSummonShadowTrap < uiDiff)
+                        {
+                            if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                                DoCast(target, SPELL_SUMMON_SHADOW_TRAP, true);
+                            uiSummonShadowTrap = 30000;
+                        } else uiSummonShadowTrap -= uiDiff;
+                    }
+
+                    if (uiInfestTimer < uiDiff)
+                    {
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                            DoCast(target, SPELL_INFEST);
+                        uiInfestTimer = 30000;
+                    } else uiInfestTimer -= uiDiff;
+
+                    if (uiSummonDrudgeGhoulsTimer < uiDiff)
+                    {
+                        DoCast(SPELL_SUMMON_DRUDGE_GHOULS);
+                        uiSummonDrudgeGhoulsTimer = 20000;
+                    } else uiSummonDrudgeGhoulsTimer -= uiDiff;
+
+                    if (uiSummonShamblingHorrorTimer < uiDiff)
+                    {
+                        DoCast(SPELL_SUMMON_SHAMBLING_HORROR);
+                        uiSummonShamblingHorrorTimer = 30000;
+                    } else uiSummonShamblingHorrorTimer -= uiDiff;
+
+                    if (uiNecroticPlagueTimer < uiDiff)
+                    {
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                            DoCast(target, SPELL_NECROTIC_PLAGUE);
+                    } else uiNecroticPlagueTimer -= uiDiff;
+                }
+
+                if(uiPhase == 2) //transition phase 1
+                {
+                    if (uiSummonSpiritTimer < uiDiff)
+                    {
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                            DoCast(target, SPELL_SUMMON_RAGING_SPIRIT);
+                        uiSummonSpiritTimer = 20000;
+                    } else uiSummonSpiritTimer -= uiDiff;
+
+                    if (uiIcePulsSummonTimer < uiDiff)
+                    {
+                        DoCast(SPELL_SUMMON_ICE_SPEHERE);
+                        uiIcePulsSummonTimer = 15000;
+                    } else uiIcePulsSummonTimer -= uiDiff;
+                }
+
+                if(uiPhase == 3)
+                {
+                    if (uiDefileTimer < uiDiff)
+                    {
+                        DoScriptText(SAY_EMOTE_DEFILE, me);
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 0, 100.0f, true))
+                            DoCast(target, SPELL_SUMMON_DEFILE);
+                        uiDefileTimer = 20000;
+                    } else uiDefileTimer -= uiDiff;
+
+                    if (uiSummonValkyrTimer < uiDiff)
+                    {
+                        DoScriptText(SAY_SUMMON_VALKYR, me);
+                        DoCast(SPELL_SUMMON_VALKYR);
+                        uiSummonValkyrTimer = 35000;
+                        uiDefileTimer = 5000; //cast defile after cast valkyr summon
+                    } else uiSummonValkyrTimer -= uiDiff;
+
+                    if (uiSoulReaperTimer < uiDiff)
+                    {
+                        DoCastVictim(SPELL_SOUL_REAPER);
+                        DoCast(SPELL_SOUL_REAPER_HASTE_AURA);
+                        uiSoulReaperTimer = 30000;
+                    } else uiSoulReaperTimer -= uiDiff;
+
+                    if (uiInfestTimer < uiDiff)
+                    {
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                            DoCast(target, SPELL_INFEST);
+                        uiInfestTimer = 30000;
+                    } else uiInfestTimer -= uiDiff;
+                }
+
+                if(uiPhase == 4) //transition phase 2
+                {
+                    if (uiSummonSpiritTimer < uiDiff)
+                    {
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                            DoCast(target, SPELL_SUMMON_RAGING_SPIRIT);
+                        uiSummonSpiritTimer = 25000;
+                    } else uiSummonSpiritTimer -= uiDiff;
+
+                    if (uiIcePulsSummonTimer < uiDiff)
+                    {
+                        DoCast(SPELL_SUMMON_ICE_SPEHERE);
+                        uiIcePulsSummonTimer = 15000;
+                    } else uiIcePulsSummonTimer -= uiDiff;
+                }
+
+                if(uiPhase == 5)
+                {
+                    if (uiSummonVileSpiritTimer < uiDiff)
+                    {
+                        DoCast(SPELL_SUMMON_VILE_SPIRIT);
+                        uiSummonVileSpiritTimer = 30000;
+                    } else uiSummonVileSpiritTimer -= uiDiff;
+
+                    if (uiHarvestSoulTimer < uiDiff)
+                    {
+                        DoScriptText(SAY_HARVEST_SOUL, me);
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                            DoCast(target, SPELL_HARVEST_SOULS);
+                        uiHarvestSoulTimer = 70000;
+                    } else uiHarvestSoulTimer -= uiDiff;
+
+                    if (uiSoulReaperTimer < uiDiff)
+                    {
+                        DoCastVictim(SPELL_SOUL_REAPER);
+                        DoCast(SPELL_SOUL_REAPER_HASTE_AURA);
+                        uiSoulReaperTimer = 30000;
+                    } else uiSoulReaperTimer -= uiDiff;
+
+                    if (uiDefileTimer < uiDiff)
+                    {
+                        if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 0, 100.0f, true))
+                            DoCast(target, SPELL_SUMMON_DEFILE);
+                        uiDefileTimer = 20000;
+                    } else uiDefileTimer -= uiDiff;
+                }
+
+                if(uiPhase == 6)
+                {
+                    if (uiEndingTimer <= uiDiff)
+                    {
+                        switch(uiStage)
+                        {
+                            case 1:
+                                me->GetMotionMaster()->MoveIdle();
+                                me->SetReactState(REACT_PASSIVE);
+                                me->AttackStop();
+                                me->CastStop();
+                                me->SetInCombatWithZone();
+                                DoScriptText(SAY_10_PROZENT, me);
+                                DoCast(SPELL_FURY_OF_FROSTMOURNE);
+                                uiEndingTimer = 15000;
+                                break;
+                            case 2:
+                                DoScriptText(SAY_ENDING_1_KING, me);
+                                uiEndingTimer = 24000;
+                                break;
+                            case 3:
+                                DoScriptText(SAY_ENDING_2_KING, me);
+                                uiEndingTimer = 25000;
+                                break;
+                            case 4:
+                                me->GetMotionMaster()->MovePoint(0, MovePos[1]);
+                                uiEndingTimer = 4000;
+                                break;
+                            case 5:
+                                DoScriptText(SAY_ENDING_3_KING, me);
+                                DoCast(me, SPELL_CHANNEL_KING);
+                                me->HandleEmoteCommand(EMOTE_ONESHOT_LAUGH);
+                                uiEndingTimer = 28000;
+                                break;
+                            case 6:
+                                DoScriptText(SAY_ENDING_4_KING, me);
+                                uiEndingTimer = 8000;
+                                break;
+                            case 7:
+                            {
+                                if(uiTirionGUID)
+                                    if(Creature* tirion = Unit::GetCreature(*me, uiTirionGUID))
+                                        DoScriptText(SAY_ENDING_5_TIRION, tirion);
+                                uiEndingTimer = 11000;
+                                break;
+                            }
+                            case 8:
+                            {
+                                if(uiTirionGUID)
+                                    if(Creature* tirion = Unit::GetCreature(*me, uiTirionGUID))
+                                        tirion->CastSpell(tirion, SPELL_TIRION_LIGHT, true);
+                                uiEndingTimer = 7000;
+                                break;
+                            }
+                            case 9:
+                            {
+                                if(uiTirionGUID)
+                                    if(Creature* tirion = Unit::GetCreature(*me, uiTirionGUID))
+                                        tirion->GetMotionMaster()->MovePoint(0, MovePos[2]);
+                                uiEndingTimer = 1000;
+                                break;
+                            }
+                            case 10:
+                            {
+                                if(uiTirionGUID)
+                                {
+                                    if(Creature* tirion = Unit::GetCreature(*me, uiTirionGUID))
+                                    {
+                                        tirion->GetMotionMaster()->MoveJump(517.482910f, -2124.905762f, 1040.861328f, 10.0f, 15.0f);
+                                        tirion->SetUInt32Value(UNIT_NPC_EMOTESTATE, 375);
+                                    }
+                                }
+                                uiEndingTimer = 1000;
+                                break;
+                            }
+                            case 11:
+                                me->RemoveAura(SPELL_CHANNEL_KING);
+                                me->CastSpell(me, SPELL_BOOM_VISUAL, false);
+                                uiEndingTimer = 3000;
+                                break;
+                            case 12:
+                                DoCast(me, SPELL_DROP_FROSTMOURNE);
+                                uiEndingTimer = 1000;
+                                break;
+                            case 13:
+                                DoScriptText(SAY_ENDING_6_KING, me);
+                                uiEndingTimer = 3000;
+                                break;
+                            case 14:
+                                DoCast(me, SPELL_SUMMON_FROSTMOURNE_TRIGGER);
+                                DoCast(me, SPELL_REMOVE_WEAPON);
+                                uiEndingTimer = 2000;
+                                break;
+                            case 15:
+                                me->RemoveAllAuras();
+                                DoPlaySoundToSet(me, SOUND_ENDING_7_KING);
+                                me->SetUInt32Value(UNIT_NPC_EMOTESTATE, 473);
+                                uiEndingTimer = 5000;
+                                break;
+                            case 16:
+                                DoScriptText(SAY_ENDING_8_TIRION, me);
+                                uiEndingTimer = 6000;
+                                break;
+                            case 17:
+                                DoCast(SPELL_SUMMON_MENETHIL);
+                                uiEndingTimer = 3000;
+                                break;
+                            case 18:
+                                DoScriptText(SAY_ENDING_11_FATHER, me);
+                                uiEndingTimer = 6000;
+                                break;
+                            case 19:
+                                DoScriptText(SAY_ENDING_10_TIRION, me);
+                                uiEndingTimer = 5000;
+                                break;
+                            case 20:
+                                {
+                                    DoScriptText(SAY_ENDING_12_KING, me);
+                                    if(uiTirionGUID)
+                                    {
+                                        if(Creature* tirion = Unit::GetCreature(*me, uiTirionGUID))
+                                        {
+                                            tirion->SetReactState(REACT_AGGRESSIVE);
+                                            tirion->AI()->AttackStart(me);
+                                        }
+                                    }
+                                    if(Creature* father = me->FindNearestCreature(CREAUTRE_MENETHIL, 25.0f, true))
+                                        father->AI()->AttackStart(me);
+                                    uiEndingTimer = 5000;
+                                    break;
+                                }
+                        }
+                        ++uiStage;
+                    } else uiEndingTimer -= uiDiff;
+                }
+
+                DoMeleeAttackIfReady();
+            }
+        private:
+            InstanceScript* instance;
+
+            uint8 uiStage;
+            uint8 uiPhase;
+
+            uint32 uiEndingTimer;
+            uint32 uiSummonShamblingHorrorTimer;
+            uint32 uiSummonDrudgeGhoulsTimer;
+            uint32 uiSummonShadowTrap;
+            uint32 uiInfestTimer;
+            uint32 uiNecroticPlagueTimer;
+            uint32 uiBerserkTimer;
+            uint32 uiSummonValkyrTimer;
+            uint32 uiSoulReaperTimer;
+            uint32 uiDefileTimer;
+            uint32 uiHarvestSoulTimer;
+            uint32 uiSummonVileSpiritTimer;
+            uint32 uiIcePulsSummonTimer;
+            uint32 uiSummonSpiritTimer;
+            uint32 uiRandomSpeechTimer;
+            uint64 uiTirionGUID;
+
+            SummonList summons;
+
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new boss_the_lich_kingAI(creature);
+        }
+};
+
+class npc_tirion_icc : public CreatureScript
+{
+    public:
+        npc_tirion_icc() : CreatureScript("npc_tirion_icc") { }
+
+        struct npc_tirion_iccAI : public ScriptedAI
+        {
+            npc_tirion_iccAI(Creature* creature) : ScriptedAI(creature)
+            {
+                instance = creature->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                uiIntroTimer = 1000;
+                uiStage = 1;
+                uiLichKingGUID = 0;
+                bIntro = false;
+
+                me->SetReactState(REACT_PASSIVE);
+                me->SetSpeed(MOVE_RUN, 1.8f);
+                me->SetFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_GOSSIP);
+            }
+
+            void DoAction(const int32 action)
+            {
+                if(action == ACTION_START_EVENT)
+                {
+                    bIntro = true;
+                    if(instance)
+                        uiLichKingGUID = instance->GetData64(DATA_LICH_KING);
+                }
+            }
+
+            void SpellHit(Unit* /*caster*/, const SpellEntry * spell)
+            {
+                if(spell->Id == SPELL_LIGH_EFFECT)
+                    me->RemoveAurasDueToSpell(SPELL_ICEBLOCK_TRIGGER);
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if(!bIntro || !uiLichKingGUID)
+                    return;
+
+                if(uiIntroTimer <= diff)
+                {
+                    switch(uiStage)
+                    {
+                        case 1:
+                            {
+                                if(Creature* lich = Unit::GetCreature(*me, uiLichKingGUID))
+                                {
+                                    lich->SetStandState(UNIT_STAND_STATE_STAND);
+                                    lich->GetMotionMaster()->MovePoint(POINT_START_EVENT_1, MovePos[0]);
+                                }
+                                me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_STATE_READY2H);
+                                uiIntroTimer = 3000;
+                                break;
+                            }
+                        case 2:
+                        {
+                            if(Creature* lich = Unit::GetCreature(*me, uiLichKingGUID))
+                                lich->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_ONESHOT_TALK);
+                            DoScriptText(SAY_INTRO_1_KING, me);
+                            uiIntroTimer = 14000;
+                            break;
+                        }
+                        case 3:
+                        {
+                            if(Creature* lich = Unit::GetCreature(*me, uiLichKingGUID))
+                                lich->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_ONESHOT_NONE);
+                            DoScriptText(SAY_INTRO_2_TIRION, me);
+                            uiIntroTimer = 9000;
+                            break;
+                        }
+                        case 4:
+                        {
+                            DoScriptText(SAY_INTRO_3_KING, me);
+                            if(Creature* lich = Unit::GetCreature(*me, uiLichKingGUID))
+                                lich->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_STATE_LAUGH);
+                            uiIntroTimer = 3000;
+                            break;
+                        }
+                        case 5:
+                        {
+                            if(Creature* lich = Unit::GetCreature(*me, uiLichKingGUID))
+                                lich->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_ONESHOT_POINT_NOSHEATHE);
+                            uiIntroTimer = 2000;
+                            break;
+                        }
+                        case 6:
+                        {
+                            if(Creature* lich = Unit::GetCreature(*me, uiLichKingGUID))
+                                lich->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_ONESHOT_NONE);
+                            uiIntroTimer = 18000;
+                            break;
+                        }
+                        case 7:
+                            me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_ONESHOT_POINT_NOSHEATHE);
+                            DoScriptText(SAY_INTRO_4_TIRION, me);
+                            uiIntroTimer = 1000;
+                            break;
+                        case 8:
+                            me->SetUInt32Value(UNIT_NPC_EMOTESTATE, EMOTE_ONESHOT_NONE);
+                            me->GetMotionMaster()->MovePoint(0, MovePos[3]);
+                            uiIntroTimer = 2000;
+                            break;
+                        case 9:
+                        {
+                            if(Creature* lich = Unit::GetCreature(*me, uiLichKingGUID))
+                                lich->CastSpell(me, SPELL_ICEBLOCK_TRIGGER, true);
+                            uiIntroTimer = 2000;
+                            break;
+                        }
+                        case 10:
+                        {
+                            DoScriptText(SAY_INTRO_5_KING, me);
+                            if(Creature* lich = Unit::GetCreature(*me, uiLichKingGUID))
+                            {
+                                lich->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+                                lich->SetReactState(REACT_AGGRESSIVE);
+                                if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 0, 100.0f, true))
+                                    lich->AI()->AttackStart(target);
+                            }
+                            uiIntroTimer = 12000;
+                            break;
+                        }
+                    }
+                    ++uiStage;
+                } else uiIntroTimer -= diff;
+            }
+            private:
+                InstanceScript* instance;
+
+                uint64 uiLichKingGUID;
+                uint32 uiIntroTimer;
+                uint8 uiStage;
+                bool bIntro;
+        };
+
+        bool OnGossipHello(Player* player, Creature* creature)
+        {
+            player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, GOSSIP_START_EVENT, GOSSIP_SENDER_MAIN, 999999);
+            player->SEND_GOSSIP_MENU(GOSSIP_MENU, creature->GetGUID());
+
+            return true;
+        }
+
+        bool OnGossipSelect(Player* player, Creature* creature, uint32 /*uiSender*/, uint32 uiAction)
+        {
+            if (uiAction == 999999)
+            {
+                CAST_AI(npc_tirion_icc::npc_tirion_iccAI, creature->AI())->DoAction(ACTION_START_EVENT);
+                creature->RemoveFlag(UNIT_NPC_FLAGS, UNIT_NPC_FLAG_GOSSIP);
+                player->CLOSE_GOSSIP_MENU();
+            }
+            return true;
+        }
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_tirion_iccAI(creature);
+        }
+};
+
+class npc_valkyr_icc : public CreatureScript
+{
+    public:
+        npc_valkyr_icc() : CreatureScript("npc_valkyr_icc") { }
+
+        struct npc_valkyr_iccAI : public ScriptedAI
+        {
+            npc_valkyr_iccAI(Creature* creature) : ScriptedAI(creature), vehicle(creature->GetVehicleKit())
+            {
+                ASSERT(vehicle);
+            }
+
+            void Reset()
+            {
+                me->SetFlying(true);
+                bCanCast = false;
+                m_uiLifeSiphonTimer = 3000;
+
+                if (me->GetMotionMaster()->GetCurrentMovementGeneratorType() == POINT_MOTION_TYPE)
+                    me->GetMotionMaster()->MovementExpired();
+            }
+
+            void DamageTaken(Unit* /*done_by*/, uint32& /*damage*/)
+            {
+                if(!HealthAbovePct(50) && IsHeroic() && !bCanCast)
+                {
+                    vehicle->RemoveAllPassengers();
+                    me->GetMotionMaster()->MovePoint(POINT_VALKYR_ZET, me->GetPositionX(), me->GetPositionY(), me->GetPositionZ() + 10);
+                }
+            }
+
+            void PassengerBoarded(Unit* who, int8 /*seatId*/, bool apply)
+            {
+                if(apply)
+                    me->GetMotionMaster()->MovePoint(POINT_PLATFORM_END, MovePos[4]);
+            }
+
+            void MovementInform(uint32 type, uint32 id)
+            {
+                if(type != POINT_MOTION_TYPE)
+                    return;
+
+                if(bCanCast)
+                    me->GetMotionMaster()->Clear();
+
+                switch(id)
+                {
+                    case POINT_PLATFORM_END:
+                        vehicle->RemoveAllPassengers();
+                        float x,y,z;
+                        me->GetNearPoint2D(x, y, 50, me->GetAngle(me));
+                        me->GetMotionMaster()->MovePoint(POINT_VALKYR_END,x,y,z+15);
+                        break;
+                    case POINT_VALKYR_END:
+                        me->ForcedDespawn();
+                        break;
+                    case POINT_VALKYR_ZET:
+                        bCanCast = true;
+                        break;
+                }
+            }
+
+            void UpdateAI(const uint32 uiDiff)
+            {
+                if (!UpdateVictim() || !bCanCast)
+                    return;
+
+                if (m_uiLifeSiphonTimer < uiDiff)
+                {
+                    DoCastVictim(SPELL_LIFE_SIPHON);
+                    m_uiLifeSiphonTimer = 3000;
+                } else m_uiLifeSiphonTimer -= uiDiff;
+            }
+        private:
+            uint32 m_uiLifeSiphonTimer;
+            bool bCanCast;
+
+            Vehicle* vehicle;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_valkyr_iccAI(creature);
+        }
+};
+
+class npc_vile_spirit_icc : public CreatureScript
+{
+    public:
+        npc_vile_spirit_icc() : CreatureScript("npc_vile_spirit_icc") { }
+
+        struct npc_vile_spirit_iccAI : public ScriptedAI
+        {
+            npc_vile_spirit_iccAI(Creature* creature) : ScriptedAI(creature) { }
+
+            void Reset()
+            {
+                uiMoveTimer = 15000;
+                SetCombatMovement(false);
+            }
+
+            void UpdateAI(const uint32 uiDiff)
+            {
+                if (uiMoveTimer < uiDiff)
+                {
+                    DoCast(me, SPELL_VILE_SPIRIT_ACTIVE);
+                    SetCombatMovement(true);
+                    if(Unit* target = SelectTarget(SELECT_TARGET_RANDOM, 1, 100, true))
+                        me->AddThreat(target, 100000.0f);
+                    uiMoveTimer = 1500000;
+                } else uiMoveTimer -= uiDiff;
+            }
+        private:
+            uint32 uiMoveTimer;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_vile_spirit_iccAI(creature);
+        }
+};
+
+class spell_lich_king_necrotic_plague : public SpellScriptLoader
+{
+    public:
+        spell_lich_king_necrotic_plague() : SpellScriptLoader("spell_lich_king_necrotic_plague") { } //70338
+
+        class spell_lich_king_necrotic_plague_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_lich_king_necrotic_plague_AuraScript)
+
+            void OnApply(AuraEffect const* aurEff, AuraEffectHandleModes)
+            {
+                if (InstanceScript* instance = GetCaster()->GetInstanceScript())
+                {
+                    SetStackAmount(instance->GetData(DATA_NECROTIC_STACK));
+                    instance->SetData(DATA_NECROTIC_STACK, GetStackAmount() + 1);
+                    if(GetStackAmount() >= 30)
+                        instance->SetData(DATA_BEEN_WAITING, DONE);
+                }
+            }
+
+            void Register()
+            {
+                OnEffectApply += AuraEffectApplyFn(spell_lich_king_necrotic_plague_AuraScript::OnApply, EFFECT_0, SPELL_AURA_PERIODIC_DAMAGE, AURA_EFFECT_HANDLE_REAL);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_lich_king_necrotic_plague_AuraScript();
+        }
+};
+
+class spell_lich_king_infection : public SpellScriptLoader
+{
+    public:
+        spell_lich_king_infection() : SpellScriptLoader("spell_lich_king_infection") { } //70541
+
+
+        class spell_lich_king_infection_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_lich_king_infection_AuraScript)
+
+            void OnPeriodic(AuraEffect const* aurEff)
+            {
+                PreventDefaultAction();
+                if(GetTarget()->GetHealthPct() < 90 || !GetCaster())
+                    return;
+
+                GetTarget()->RemoveAurasDueToSpell(SPELL_INFEST);
+            }
+
+            void Register()
+            {
+                OnEffectPeriodic += AuraEffectPeriodicFn(spell_lich_king_infection_AuraScript::OnPeriodic, EFFECT_0, SPELL_AURA_PERIODIC_DAMAGE);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_lich_king_infection_AuraScript();
+        }
+};
+
+class spell_lich_king_valkyr_summon : public SpellScriptLoader
+{
+    public:
+        spell_lich_king_valkyr_summon() : SpellScriptLoader("spell_lich_king_valkyr_summon") { } //74361
+
+
+        class spell_lich_king_valkyr_summon_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_lich_king_valkyr_summon_AuraScript);
+
+            void OnApply(AuraEffect const* aurEff, AuraEffectHandleModes /*mode*/)
+            {
+                if (Unit* caster = GetCaster())
+                {
+                    uint8 spawnMod = caster->GetMap()->GetSpawnMode();
+                    SetDuration(spawnMod == 1 || spawnMod == 3 ? 3000 : 1000);
+                }
+            }
+
+            void HandleTriggerSpell(AuraEffect const* aurEff)
+            {
+                PreventDefaultAction();
+                if (Unit* caster = GetCaster())
+                {
+                    int triggerSpellId = GetSpellProto()->EffectTriggerSpell[aurEff->GetEffIndex()];
+                    float x, y, z;
+                    caster->GetPosition(x, y, z);
+                    caster->CastSpell(x, y, z + 6, triggerSpellId, true, NULL, NULL, GetCasterGUID(), caster);
+                }
+            }
+
+            void Register()
+            {
+                OnEffectPeriodic += AuraEffectPeriodicFn(spell_lich_king_valkyr_summon_AuraScript::HandleTriggerSpell, EFFECT_0, SPELL_AURA_PERIODIC_TRIGGER_SPELL);
+                OnEffectApply += AuraEffectApplyFn(spell_lich_king_valkyr_summon_AuraScript::OnApply, EFFECT_0, SPELL_AURA_PERIODIC_TRIGGER_SPELL, AURA_EFFECT_HANDLE_REAL);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_lich_king_valkyr_summon_AuraScript();
+        }
+};
+
+class spell_lich_king_winter : public SpellScriptLoader
+{
+    public:
+        spell_lich_king_winter() : SpellScriptLoader("spell_lich_king_winter") { } //68981
+
+
+        class spell_lich_king_winter_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_lich_king_winter_AuraScript)
+
+            void OnRemove(AuraEffect const* aurEff, AuraEffectHandleModes /*mode*/)
+            {
+                if (Unit* caster = GetCaster())
+                {
+                    caster->CastSpell(caster, SPELL_QUAKE, true);
+                    DoScriptText(SAY_BROKEN_ARENA, caster);
+                }
+            }
+
+            void Register()
+            {
+                OnEffectRemove += AuraEffectRemoveFn(spell_lich_king_winter_AuraScript::OnRemove, EFFECT_0, SPELL_AURA_PERIODIC_TRIGGER_SPELL, AURA_EFFECT_HANDLE_REAL);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_lich_king_winter_AuraScript();
+        }
+};
+
+class spell_lich_king_quake : public SpellScriptLoader
+{
+    public:
+        spell_lich_king_quake() : SpellScriptLoader("spell_lich_king_quake") { } //72262
+
+
+        class spell_lich_king_quake_AuraScript : public AuraScript
+        {
+            PrepareAuraScript(spell_lich_king_quake_AuraScript)
+
+            void OnRemove(AuraEffect const* aurEff, AuraEffectHandleModes /*mode*/)
+            {
+                if(!GetCaster() || !GetOwner())
+                    return;
+
+                GetCaster()->CastSpell(GetCaster(), SPELL_WMO_DAMAGE, true);
+                if (InstanceScript* instance = GetTarget()->GetInstanceScript())
+                    if (Creature* lichKing = Unit::GetCreature(*GetTarget(), instance->GetData64(DATA_LICH_KING)))
+                        lichKing->AI()->DoAction(ACTION_PHASESWITCH_2);
+            }
+
+            void Register()
+            {
+                OnEffectRemove += AuraEffectRemoveFn(spell_lich_king_quake_AuraScript::OnRemove, EFFECT_0, SPELL_AURA_DUMMY, AURA_EFFECT_HANDLE_REAL);
+            }
+        };
+
+        AuraScript* GetAuraScript() const
+        {
+            return new spell_lich_king_quake_AuraScript();
+        }
+};
+
+class spell_vile_spirit_distance_check : public SpellScriptLoader
+{
+    public:
+        spell_vile_spirit_distance_check() : SpellScriptLoader("spell_vile_spirit_distance_check") { }
+
+
+        class spell_vile_spirit_distance_check_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_vile_spirit_distance_check_SpellScript);
+
+
+            void HandleScript(SpellEffIndex /*effIndex*/)
+            {
+                if (!(GetHitUnit() && GetHitUnit()->isAlive()))
+                    return;
+
+                if(Unit* caster = GetCaster())
+                {
+                    caster->CastSpell(caster, SPELL_BURST, true);
+
+                    if (InstanceScript* instance = caster->GetInstanceScript())
+                        instance->SetData(DATA_NECK_DEEP, FAIL);
+                }
+            }
+
+            void Register()
+            {
+                OnEffect += SpellEffectFn(spell_vile_spirit_distance_check_SpellScript::HandleScript, EFFECT_0, SPELL_EFFECT_DUMMY);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_vile_spirit_distance_check_SpellScript();
+        }
+};
+
+class spell_ice_burst_distance_check : public SpellScriptLoader
+{
+    public:
+        spell_ice_burst_distance_check() : SpellScriptLoader("spell_ice_burst_distance_check") { }
+
+
+        class spell_ice_burst_distance_check_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_ice_burst_distance_check_SpellScript);
+
+
+            void HandleScript(SpellEffIndex /*effIndex*/)
+            {
+                if (!(GetHitUnit() && GetHitUnit()->isAlive()))
+                    return;
+
+                if(Unit* caster = GetCaster())
+                    caster->CastSpell(caster, SPELL_ICE_BURST, true);
+            }
+
+            void Register()
+            {
+                OnEffect += SpellEffectFn(spell_ice_burst_distance_check_SpellScript::HandleScript, EFFECT_0, SPELL_EFFECT_DUMMY);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_ice_burst_distance_check_SpellScript();
+        }
+};
+
+class spell_lich_king_play_movie : public SpellScriptLoader
+{
+    public:
+        spell_lich_king_play_movie() : SpellScriptLoader("spell_lich_king_play_movie") { }
+
+
+        class spell_lich_king_play_movie_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_lich_king_play_movie_SpellScript);
+
+            void HandleScript(SpellEffIndex /*effIndex*/)
+            {
+                if (!(GetHitUnit() && GetHitUnit()->isAlive()))
+                    return;
+
+                if (GetHitUnit()->GetTypeId() == TYPEID_PLAYER)
+                    GetHitUnit()->ToPlayer()->SendMovieStart(MOVIE_ID_ARTHAS_DEATH);
+            }
+
+            void Register()
+            {
+                OnEffect += SpellEffectFn(spell_lich_king_play_movie_SpellScript::HandleScript, EFFECT_0, SPELL_EFFECT_SCRIPT_EFFECT);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_lich_king_play_movie_SpellScript();
+        }
+};
+
+class spell_valkyr_carry_can_cast : public SpellScriptLoader
+{
+    public:
+        spell_valkyr_carry_can_cast() : SpellScriptLoader("spell_valkyr_carry_can_cast") { }
+
+
+        class spell_valkyr_carry_can_cast_SpellScript : public SpellScript
+        {
+            PrepareSpellScript(spell_valkyr_carry_can_cast_SpellScript);
+
+            void HandleScript(SpellEffIndex /*effIndex*/)
+            {
+                if (!(GetHitUnit() && GetHitUnit()->isAlive() && GetCaster()))
+                    return;
+
+                if (GetHitUnit()->GetTypeId() == TYPEID_PLAYER)
+                    GetHitUnit()->CastSpell(GetCaster(), SPELL_VALKYR_MOVE_PLAYER, true);
+            }
+
+            void Register()
+            {
+                OnEffect += SpellEffectFn(spell_valkyr_carry_can_cast_SpellScript::HandleScript, EFFECT_0, SPELL_EFFECT_SCRIPT_EFFECT);
+            }
+        };
+
+        SpellScript* GetSpellScript() const
+        {
+            return new spell_valkyr_carry_can_cast_SpellScript();
+        }
+};
+
+void AddSC_boss_lichking()
+{
+    new boss_the_lich_king();
+    new npc_tirion_icc();
+    new npc_valkyr_icc();
+    new npc_vile_spirit_icc();
+    new spell_lich_king_necrotic_plague();
+    new spell_lich_king_infection();
+    new spell_lich_king_valkyr_summon();
+    new spell_lich_king_winter();
+    new spell_vile_spirit_distance_check();
+    new spell_ice_burst_distance_check();
+    new spell_lich_king_quake();
+    new spell_lich_king_play_movie();
+    new spell_valkyr_carry_can_cast();
+}
\ No newline at end of file
diff --git a/src/server/scripts/Northrend/IcecrownCitadel/boss_valithria_dreamwalker.cpp b/src/server/scripts/Northrend/IcecrownCitadel/boss_valithria_dreamwalker.cpp
new file mode 100644
index 0000000..8d4dc6c
--- /dev/null
+++ b/src/server/scripts/Northrend/IcecrownCitadel/boss_valithria_dreamwalker.cpp
@@ -0,0 +1,415 @@
+/*
+* Copyright (C) 2009 - 2010 TrinityCore <http://www.trinitycore.org/>
+*
+* This program is free software; you can redistribute it and/or modify
+* it under the terms of the GNU General Public License as published by
+* the Free Software Foundation; either version 2 of the License, or
+* (at your option) any later version.
+*
+* This program is distributed in the hope that it will be useful,
+* but WITHOUT ANY WARRANTY; without even the implied warranty of
+* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
+* GNU General Public License for more details.
+*
+* You should have received a copy of the GNU General Public License
+* along with this program; if not, write to the Free Software
+* Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
+*/
+
+#include "ScriptPCH.h"
+#include "icecrown_citadel.h"
+
+enum Yells
+{
+    SAY_AGGRO       = -1666063,
+    SAY_BELOW_25    = -1666066,
+    SAY_ABOVE_75    = -1666065,
+    SAY_DEATH       = -1666067,
+    SAY_PDEATH      = -1666068,
+    SAY_END         = -1666070,
+    SAY_BERSERK     = -1666069,
+    SAY_OPEN_PORTAL = -1666064
+};
+
+enum Spells
+{
+    SPELL_CORRUPTION    = 70904,
+    SPELL_DREAM_SLIP    = 71196,
+    SPELL_RAGE          = 71189,
+    SPELL_COLUMN        = 70704,
+    SPELL_DREAM_STATE   = 70766,
+    SPELL_VIGOR         = 70873,
+    SPELL_CLOUD_VISUAL  = 70876,
+    SPELL_PORTAL_N_PRE  = 71301,
+    SPELL_PORTAL_N_NPC  = 71305,
+    SPELL_PORTAL_H_PRE  = 71977,
+    SPELL_PORTAL_H_NPC  = 71987,
+};
+
+const Position Pos[] =
+{
+    {4239.579102f, 2566.753418f, 364.868439f, 0.0f}, //normal 0,1
+    {4240.688477f, 2405.794678f, 364.868591f, 0.0f}, // normal
+    {4165.112305f, 2405.872559f, 364.872925f, 0.0f}, //2,3
+    {4166.216797f, 2564.197266f, 364.873047f, 0.0f}
+};
+
+class boss_valithria : public CreatureScript
+{
+    public:
+        boss_valithria() : CreatureScript("boss_valithria") { }
+
+        struct boss_valithriaAI : public BossAI
+        {
+            boss_valithriaAI(Creature* pCreature) : BossAI(pCreature, DATA_VALITHRIA_DREAMWALKER)
+            {
+                pInstance = me->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                m_uiStage = 1;
+
+                DoCast(me, SPELL_CORRUPTION);
+                me->SetHealth(uint32(me->GetMaxHealth() / 2));
+
+                m_uiEndTimer = 1000;
+
+                bIntro = false;
+                bEnd = false;
+                bAboveHP = false;
+                bBelowHP = false;
+
+                me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_DISABLE_MOVE);
+
+                if (pInstance)
+                    pInstance->SetData(DATA_VALITHRIA_DREAMWALKER, NOT_STARTED);
+            }
+
+            void MoveInLineOfSight(Unit *who)
+            {
+                if (pInstance && pInstance->GetData(DATA_VALITHRIA_DREAMWALKER) == NOT_STARTED)
+                    pInstance->SetData(DATA_VALITHRIA_DREAMWALKER, IN_PROGRESS);
+
+                if (!bIntro && who->IsWithinDistInMap(me, 40.0f,true))
+                {
+                    DoScriptText(SAY_AGGRO, me);
+                    bIntro = true;
+
+                    ScriptedAI::MoveInLineOfSight(who);
+                }
+                if (pInstance && pInstance->GetData(DATA_VALITHRIA_DREAMWALKER) == IN_PROGRESS)
+                    if(!who->IsWithinDistInMap(me, 60.0f,true))
+                        pInstance->SetData(DATA_VALITHRIA_DREAMWALKER, FAIL);
+            }
+
+            void JustDied(Unit* /*pKiller*/)
+            {
+                DoScriptText(SAY_DEATH, me);
+
+                if (pInstance)
+                    pInstance->SetData(DATA_VALITHRIA_DREAMWALKER, FAIL);
+            }
+
+            void DamageTaken(Unit* /*done_by*/, uint32& /*damage*/)
+            {
+                if (!pInstance || pInstance->GetData(DATA_VALITHRIA_DREAMWALKER) == DONE)
+                    return;
+
+                if (!bAboveHP && HealthAbovePct(74))
+                {
+                    DoScriptText(SAY_ABOVE_75, me);
+                    bAboveHP = true;
+                }
+                if (!bBelowHP && HealthBelowPct(26))
+                {
+                    DoScriptText(SAY_BELOW_25, me);
+                    bBelowHP = true;
+                }
+                if (!bEnd && HealthAbovePct(99))
+                {
+                    DoScriptText(SAY_END, me);
+                    me->RemoveFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_DISABLE_MOVE);
+                    me->SetReactState(REACT_PASSIVE);
+                    me->RemoveAurasDueToSpell(SPELL_CORRUPTION);
+                    bEnd = true;
+                }
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!bEnd || !pInstance || pInstance->GetData(DATA_VALITHRIA_DREAMWALKER) == DONE)
+                    return;
+
+                if (m_uiEndTimer <= diff)
+                {
+                    switch(m_uiStage)
+                    {
+                        case 1:
+                            DoScriptText(SAY_BERSERK , me);
+                            DoCast(me, SPELL_RAGE);
+                            me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NOT_SELECTABLE);
+                            ++m_uiStage;
+                            m_uiEndTimer = 6000;
+                            break;
+                        case 2:
+                            DoCast(SPELL_DREAM_SLIP);
+                            ++m_uiStage;
+                            m_uiEndTimer = 1000;
+                            break;
+                        case 3:
+                            me->ForcedDespawn();
+                            pInstance->SetData(DATA_VALITHRIA_DREAMWALKER, DONE);
+                            m_uiEndTimer = 1000;
+                            bEnd = false;
+                            ++m_uiStage;
+                            break;
+                    }
+                } else m_uiEndTimer -= diff;
+            }
+
+        private:
+            InstanceScript* pInstance;
+
+            uint8 m_uiStage;
+            uint32 m_uiEndTimer;
+            bool bIntro;
+            bool bEnd;
+            bool bAboveHP;
+            bool bBelowHP;
+        };
+
+        CreatureAI* GetAI(Creature* pCreature) const
+        {
+            return new boss_valithriaAI(pCreature);
+        }
+};
+
+class npc_valithria_alternative : public CreatureScript
+{
+    public:
+        npc_valithria_alternative() : CreatureScript("npc_valithria_alternative") { }
+
+        struct npc_valithria_alternativeAI : public ScriptedAI
+        {
+            npc_valithria_alternativeAI(Creature* pCreature) : ScriptedAI(pCreature)
+            {
+                pInstance = pCreature->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                me->SetPhaseMask(16, true);
+                me->AddUnitMovementFlag(MOVEMENTFLAG_CAN_FLY);
+                me->SendMovementFlagUpdate();
+                me->SetFlying(true);
+                me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_DISABLE_MOVE);
+                me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NOT_SELECTABLE);
+
+                m_uiSummonPortalTimer = 5000;
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (pInstance && pInstance->GetData(DATA_VALITHRIA_DREAMWALKER) != IN_PROGRESS)
+                    return;
+
+                if (m_uiSummonPortalTimer <= diff)
+                {
+                    float x, y, z;
+                    me->GetPosition(x,y,z);
+                    for(uint8 i = 0; i <= 8; ++i) //need correct count
+                        me->SummonCreature(CREATURE_CLOUD, x + (urand(2, 6) * 10), y + (urand(1, 4) * 10), z + urand(2,8), 0, TEMPSUMMON_TIMED_DESPAWN, 15000);
+                    m_uiSummonPortalTimer = 5000;
+                } else m_uiSummonPortalTimer -= diff;
+            }
+        private:
+            InstanceScript* pInstance;
+
+            uint32 m_uiSummonPortalTimer;
+        };
+
+        CreatureAI* GetAI(Creature* pCreature) const
+        {
+            return new npc_valithria_alternativeAI(pCreature);
+        }
+};
+
+class npc_dreamportal_icc : public CreatureScript //  
+{
+    public:
+        npc_dreamportal_icc() : CreatureScript("npc_dreamportal_icc") { }
+
+        struct npc_dreamportal_iccAI : public ScriptedAI
+        {
+            npc_dreamportal_iccAI(Creature* pCreature) : ScriptedAI(pCreature) { }
+
+            void Reset()
+            {
+                me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_STUNNED);
+
+                m_uiChangeTimer = 15000;
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if(me->GetEntry() == CREATURE_PORTAL_NORMAL_MODE_PRE)
+                {
+                    if (m_uiChangeTimer <= diff)
+                    {
+                        me->UpdateEntry(CREATURE_PORTAL_NORMAL_MODE_NPC);
+                    } else m_uiChangeTimer -= diff;
+                }
+
+                if(me->GetEntry() == CREATURE_PORTAL_HEROIC_MODE_PRE)
+                {
+                    if (m_uiChangeTimer <= diff)
+                    {
+                        me->UpdateEntry(CREATURE_PORTAL_HEROIC_MODE_NPC);
+                    } else m_uiChangeTimer -= diff;
+                }
+            }
+
+        private:
+            uint32 m_uiChangeTimer;
+        };
+
+        CreatureAI* GetAI(Creature* pCreature) const
+        {
+            return new npc_dreamportal_iccAI(pCreature);
+        }
+};
+
+class npc_dreamcloud_icc : public CreatureScript //  
+{
+    public:
+        npc_dreamcloud_icc() : CreatureScript("npc_dreamcloud_icc") { }
+
+        struct npc_dreamcloud_iccAI : public ScriptedAI
+        {
+            npc_dreamcloud_iccAI(Creature* pCreature) : ScriptedAI(pCreature) { }
+
+            void Reset()
+            {
+                me->SetPhaseMask(16, true);
+                DoCast(SPELL_CLOUD_VISUAL);
+                me->AddUnitMovementFlag(MOVEMENTFLAG_CAN_FLY);
+                me->SendMovementFlagUpdate();
+                me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_DISABLE_MOVE);
+                me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NOT_SELECTABLE);
+            }
+
+            void MoveInLineOfSight(Unit *who)
+            {
+                if (me->IsWithinDistInMap(who, 5.0f, true))
+                    DoCast(SPELL_VIGOR);
+
+                ScriptedAI::MoveInLineOfSight(who);
+            }
+        };
+
+        CreatureAI* GetAI(Creature* pCreature) const
+        {
+            return new npc_dreamcloud_iccAI(pCreature);
+        }
+};
+
+class npc_icc_combat_stalker : public CreatureScript
+{
+    public:
+        npc_icc_combat_stalker() : CreatureScript("npc_icc_combat_stalker") { }
+
+        struct npc_icc_combat_stalkerAI : public ScriptedAI
+        {
+            npc_icc_combat_stalkerAI(Creature* pCreature) : ScriptedAI(pCreature), summons(me)
+            {
+                pInstance = me->GetInstanceScript();
+            }
+
+            void Reset()
+            {
+                me->SetFlag(UNIT_FIELD_FLAGS, UNIT_FLAG_NON_ATTACKABLE);
+                me->SetInCombatWithZone();
+                DoStartNoMovement(me->getVictim());
+                m_uiSummonTimer = 20000;
+                m_uiPortalTimer = 50000;
+                m_uiColumnTimer = 13000;
+
+                if (pInstance && pInstance->GetData(DATA_VALITHRIA_DREAMWALKER) != IN_PROGRESS)
+                    summons.DespawnAll();
+            }
+
+            void JustSummoned(Creature* pSummoned)
+            {
+                if (Creature* valithria = Unit::GetCreature(*me, pInstance->GetData64(DATA_VALITHRIA_DREAMWALKER)))
+                    pSummoned->AI()->AttackStart(valithria);
+
+                summons.Summon(pSummoned);
+            }
+
+            void KilledUnit(Unit* /*victim*/)
+            {
+                if (Creature* valithria = Unit::GetCreature(*me, pInstance->GetData64(DATA_VALITHRIA_DREAMWALKER)))
+                    DoScriptText(SAY_PDEATH, valithria);
+            }
+
+            void UpdateAI(const uint32 diff)
+            {
+                if (!pInstance || pInstance->GetData(DATA_VALITHRIA_DREAMWALKER) != IN_PROGRESS)
+                    return;
+
+                if (m_uiSummonTimer <= diff)
+                {
+                    for (uint8 coords = 0; coords <= RAID_MODE(1,3,1,3); ++coords)
+                    {
+                        if(urand(0,1)) DoSummon(CREATURE_ZOMBIE, Pos[coords]);
+                        if(urand(0,1)) DoSummon(CREATURE_SKELETON, Pos[coords]);
+                        if(urand(0,1)) DoSummon(CREATURE_ARCHMAGE, Pos[coords]);
+                        if(urand(0,1)) DoSummon(CREATURE_SUPPRESSER, Pos[coords]);
+                        if(urand(0,1)) DoSummon(CREATURE_ABOMINATION, Pos[coords]);
+                    }
+                    m_uiSummonTimer = 20000;
+                } else m_uiSummonTimer -= diff;
+
+                if (m_uiColumnTimer <= diff)
+                {
+                    if(Unit* pTarget = SelectTarget(SELECT_TARGET_RANDOM, 1, 100.0f, true))
+                        DoCast(pTarget, SPELL_COLUMN);
+                    m_uiColumnTimer = 13000;
+                } else m_uiColumnTimer -= diff;
+
+                if (m_uiPortalTimer <= diff)
+                {
+                    if (Creature* valithria = Unit::GetCreature(*me, pInstance->GetData64(DATA_VALITHRIA_DREAMWALKER)))
+                        DoScriptText(SAY_OPEN_PORTAL, valithria);
+
+                    for(uint8 p = 0; p < 6; ++p)
+                    {
+                        DoCast(RAID_MODE(SPELL_PORTAL_N_PRE,SPELL_PORTAL_N_PRE,SPELL_PORTAL_H_PRE,SPELL_PORTAL_H_PRE));
+                    }
+                    m_uiPortalTimer = 50000;
+                } else m_uiPortalTimer -= diff;
+            }
+            private:
+                InstanceScript* pInstance;
+
+                uint32 m_uiSummonTimer;
+                uint32 m_uiPortalTimer;
+                uint32 m_uiColumnTimer;
+                SummonList summons;
+        };
+
+        CreatureAI* GetAI(Creature* pCreature) const
+        {
+            return new npc_icc_combat_stalkerAI(pCreature);
+        }
+};
+
+void AddSC_boss_valithria()
+{
+    new boss_valithria();
+    new npc_dreamportal_icc();
+    new npc_dreamcloud_icc();
+    new npc_icc_combat_stalker();
+    new npc_valithria_alternative();
+}
\ No newline at end of file
diff --git a/src/server/scripts/Northrend/IcecrownCitadel/icecrown_citadel.cpp b/src/server/scripts/Northrend/IcecrownCitadel/icecrown_citadel.cpp
new file mode 100644
index 0000000..d816001
--- /dev/null
+++ b/src/server/scripts/Northrend/IcecrownCitadel/icecrown_citadel.cpp
@@ -0,0 +1,262 @@
+/*
+ * Copyright (C) 2008-2010 TrinityCore <http://www.trinitycore.org/>
+ *
+ * This program is free software; you can redistribute it and/or modify it
+ * under the terms of the GNU General Public License as published by the
+ * Free Software Foundation; either version 2 of the License, or (at your
+ * option) any later version.
+ *
+ * This program is distributed in the hope that it will be useful, but WITHOUT
+ * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+ * FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for
+ * more details.
+ *
+ * You should have received a copy of the GNU General Public License along
+ * with this program. If not, see <http://www.gnu.org/licenses/>.
+ */
+
+#include "ScriptPCH.h"
+#include "icecrown_citadel.h"
+#include "Spell.h"
+
+enum Spells
+{
+    SPELL_ON_ORGRIMS_HAMMER_DECK    = 70121, //maybe for gunship battle
+    SPELL_DARKMARTYRDOM_FANATIC     = 71236,
+    SPELL_DARKMARTYRDOM_ADHERENT    = 70903,
+    SPELL_DARKTRANSFORMATION        = 70900,
+    SPELL_NECROTICSTRIKE            = 70659,
+    SPELL_SHADOWCLEAVE              = 70670,
+    SPELL_VAMPIRICMIGHT             = 70674,
+    SPELL_FANATIC_DETERMINATION     = 71235,
+    SPELL_ADHERENT_DETERMINATION    = 71234,
+    SPELL_EMPOWEREMENT              = 70901,
+    SPELL_FROST_FEVER               = 67767,
+    SPELL_DEATHCHILL_BLAST          = 70906,
+    SPELL_DEATHCHILL_BOLT           = 70594,
+    SPELL_CURSE_OF_TORPOR           = 71237,
+    SPELL_SHORUD_OF_THE_OCCULT      = 70768,
+    SPELL_DARK_TRANSFORMATION_T     = 70895,
+    SPELL_DARK_EMPOWERMENT_T        = 70896,
+    SPELL_STANDART_HORDE            = 69811
+};
+
+enum TeleportSpells
+{
+    HAMMER        = 70781,
+    ORATORY       = 70856,
+    RAMPART       = 70857,
+    SAURFANG      = 70858,
+    UPPER_SPIRE   = 70859,
+    PLAGUEWORKS   = 9995,
+    CRIMSONHALL   = 9996,
+    FWHALLS       = 9997,
+    QUEEN         = 70861,
+    LICHKING      = 70860
+};
+
+class npc_cult_fanatic_and_adherent : public CreatureScript
+{
+    public:
+        npc_cult_fanatic_and_adherent() : CreatureScript("npc_cult_fanatic_and_adherent") { }
+
+        struct npc_cult_fanatic_and_adherentAI : public ScriptedAI
+        {
+            npc_cult_fanatic_and_adherentAI(Creature* creature) : ScriptedAI(creature) { }
+
+            void Reset()
+            {
+                uiStrikeTimer = urand(8000, 11000);
+                uiVampirTimer = urand(19000, 22000);
+                uiCleaveTimer = urand(7000, 9000);
+                uiMartyrdomTimer = urand(24000, 30000);
+                uiFrostFeverTimer = urand(9000, 11000);
+                uiDeathchillTimer = urand(10000, 12000);
+                uiCurseTimer = urand(8000, 10000);
+                uiOccultTimer = urand(25000, 29000);
+
+                bEmpowerement = false;
+
+                if(me->GetEntry() == CREATURE_REANIMATED_ADHERENT)
+                    DoCast(me, SPELL_ADHERENT_DETERMINATION);
+                if(me->GetEntry() == CREATURE_REANIMATED_FANATIC)
+                    DoCast(me, SPELL_FANATIC_DETERMINATION);
+            }
+
+            void JustDied(Unit* /*who*/) { }
+
+            void SpellHit(Unit* /*caster*/, const SpellEntry * spell)
+            {
+                if(me->GetEntry() == CREATURE_ADHERENT)
+                {
+                    if (spell->Id == SPELL_EMPOWEREMENT)
+                        me->UpdateEntry(CREATURE_EMPOWERED_ADHERENT);
+                    else if (spell->Id == SPELL_DARK_EMPOWERMENT_T)
+                    {
+                        DoCast(me, SPELL_EMPOWEREMENT);
+                        bEmpowerement = true;
+                    }
+                }
+                if(me->GetEntry() == CREATURE_FANATIC)
+                {
+                    if (spell->Id == SPELL_DARKTRANSFORMATION)
+                        me->UpdateEntry(CREATURE_DEFORMED_FANATIC);
+                    else if (spell->Id == SPELL_DARK_TRANSFORMATION_T)
+                        DoCast(me, SPELL_DARKTRANSFORMATION);
+                }
+            }
+
+            void UpdateAI(const uint32 uiDiff)
+            {
+                if (!UpdateVictim() || me->HasUnitState(UNIT_STAT_CASTING))
+                    return;
+
+                if((me->GetEntry() == CREATURE_ADHERENT) || (me->GetEntry() == CREATURE_EMPOWERED_ADHERENT) || (me->GetEntry() == CREATURE_REANIMATED_ADHERENT))
+                {
+                    if (uiMartyrdomTimer <= uiDiff && !bEmpowerement)
+                    {
+                        DoCast(me, SPELL_DARKMARTYRDOM_ADHERENT);
+                        uiMartyrdomTimer = urand(24000, 30000);
+                    } else uiMartyrdomTimer -= uiDiff;
+
+                    if (uiFrostFeverTimer <= uiDiff)
+                    {
+                        DoCast(me->getVictim(), SPELL_FROST_FEVER);
+                        uiFrostFeverTimer = urand(9000, 11000);
+                    } else uiFrostFeverTimer -= uiDiff;
+
+                    if (uiDeathchillTimer <= uiDiff)
+                    {
+                        if (me->GetEntry() == CREATURE_EMPOWERED_ADHERENT)
+                            DoCast(me->getVictim(), SPELL_DEATHCHILL_BLAST);
+                        else
+                            DoCast(me->getVictim(), SPELL_DEATHCHILL_BOLT);
+                        uiDeathchillTimer = urand(10000, 12000);
+                    } else uiDeathchillTimer -= uiDiff;
+
+                    if (uiCurseTimer <= uiDiff)
+                    {
+                        if (Unit* target = SelectUnit(SELECT_TARGET_RANDOM, 1))
+                            DoCast(target, SPELL_CURSE_OF_TORPOR);
+                        uiCurseTimer = urand(8000, 10000);
+                    } else uiCurseTimer -= uiDiff;
+
+                    if (uiOccultTimer <= uiDiff)
+                    {
+                        DoCast(me, SPELL_SHORUD_OF_THE_OCCULT);
+                        uiOccultTimer = urand(25000, 29000);
+                    } else uiOccultTimer -= uiDiff;
+                }
+                if((me->GetEntry() == CREATURE_FANATIC) || (me->GetEntry() == CREATURE_REANIMATED_FANATIC) || (me->GetEntry() == CREATURE_DEFORMED_FANATIC))
+                {
+                    if (uiMartyrdomTimer <= uiDiff)
+                    {
+                        DoCast(me, SPELL_DARKMARTYRDOM_FANATIC);
+                        uiMartyrdomTimer = urand(24000, 30000);
+                    } else uiMartyrdomTimer -= uiDiff;
+
+                    if (uiStrikeTimer <= uiDiff)
+                    {
+                        DoCast(me, SPELL_NECROTICSTRIKE);
+                        uiStrikeTimer = urand(8000, 11000);
+                    } else uiStrikeTimer -= uiDiff;
+
+                    if (uiCleaveTimer <= uiDiff)
+                    {
+                        DoCast(me, SPELL_SHADOWCLEAVE);
+                        uiCleaveTimer = urand(7000, 9000);
+                    } else uiCleaveTimer -= uiDiff;
+
+                    if (uiVampirTimer <= uiDiff)
+                    {
+                        DoCast(me, SPELL_VAMPIRICMIGHT);
+                        uiVampirTimer = urand(19000, 22000);
+                    } else uiVampirTimer -= uiDiff;
+                }
+
+                DoMeleeAttackIfReady();
+            }
+
+        private:
+            uint32 uiStrikeTimer;
+            uint32 uiCleaveTimer;
+            uint32 uiVampirTimer;
+            uint32 uiMartyrdomTimer;
+            uint32 uiFrostFeverTimer;
+            uint32 uiDeathchillTimer;
+            uint32 uiCurseTimer;
+            uint32 uiOccultTimer;
+
+            bool bEmpowerement;
+        };
+
+        CreatureAI* GetAI(Creature* creature) const
+        {
+            return new npc_cult_fanatic_and_adherentAI(creature);
+        }
+};
+
+class go_icecrown_teleporter : public GameObjectScript
+{
+    public:
+        go_icecrown_teleporter() : GameObjectScript("go_icecrown_teleporter") { }
+
+        bool OnGossipHello(Player* player, GameObject* go)
+        {
+            InstanceScript* instance = go->GetInstanceScript();
+            if(!instance)
+                return false;
+
+            if(instance->GetData(DATA_LORD_MARROWGAR) == DONE)
+            {
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to Light's Hammer.", GOSSIP_SENDER_MAIN, HAMMER);
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to the Oratory of the Damned.", GOSSIP_SENDER_MAIN, ORATORY);
+            }
+            if(instance->GetData(DATA_LADY_DEATHWHISPER) == DONE)
+            {
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to the Rampart of Skulls.", GOSSIP_SENDER_MAIN, RAMPART);
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to the Deathbringer's Rise.", GOSSIP_SENDER_MAIN, SAURFANG);
+            }
+            if(instance->GetData(DATA_DEATHBRINGER_SAURFANG) == DONE)
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to the Upper Spire.", GOSSIP_SENDER_MAIN, UPPER_SPIRE);
+            if(instance->GetData(DATA_PROFESSOR_PUTRICIDE) == DONE)
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to the Plagueworks", GOSSIP_SENDER_MAIN, PLAGUEWORKS);
+            if(instance->GetData(DATA_BLOOD_QUEEN_LANA_THEL) == DONE)
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to the Crimson Halls", GOSSIP_SENDER_MAIN, CRIMSONHALL);
+            if(instance->GetData(DATA_VALITHRIA_DREAMWALKER) == DONE)
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to the Sindragosa's Lair", GOSSIP_SENDER_MAIN, QUEEN);
+            if(instance->GetData(DATA_SINDRAGOSA) == DONE)
+                player->ADD_GOSSIP_ITEM(GOSSIP_ICON_CHAT, "Teleport to the Frostwing Halls", GOSSIP_SENDER_MAIN, FWHALLS);
+
+            player->SEND_GOSSIP_MENU(DEFAULT_GOSSIP_MESSAGE, go->GetGUID());
+            return true;
+        }
+
+        bool OnGossipSelect(Player* player, GameObject* /*go*/, uint32 uiSender, uint32 uiAction)
+        {
+            //player->PlayerTalkClass->ClearMenus();
+            if(!player->getAttackers().empty())
+                return false;
+
+            SpellEntry const* spell = sSpellStore.LookupEntry(uiAction);
+            if (!spell)
+                return false;
+
+            if (player->isInCombat())
+            {
+                Spell::SendCastResult(player, spell, 0, SPELL_FAILED_AFFECTING_COMBAT);
+                return true;
+            }
+
+            if (uiSender == GOSSIP_SENDER_MAIN)
+                player->CastSpell(player, spell, true);
+
+            return true;
+        }
+};
+
+void AddSC_icecrown_citadel()
+{
+    new npc_cult_fanatic_and_adherent();
+    new go_icecrown_teleporter();
+}
diff --git a/src/server/scripts/Northrend/IcecrownCitadel/icecrown_citadel.h b/src/server/scripts/Northrend/IcecrownCitadel/icecrown_citadel.h
index 14c4bfa..4a159b1 100755
--- a/src/server/scripts/Northrend/IcecrownCitadel/icecrown_citadel.h
+++ b/src/server/scripts/Northrend/IcecrownCitadel/icecrown_citadel.h
@@ -27,6 +27,12 @@ enum eSharedSpells
     SPELL_BERSERK2  = 47008
 };
 
+enum eEnums
+{
+    SOUND_ENDING_7_KING                   = 17360,
+    MOVIE_ID_ARTHAS_DEATH                 = 16
+};
+
 enum eData
 {
     // Encounter States/Boss GUIDs
@@ -54,6 +60,13 @@ enum eData
     DATA_PRINCE_TALDARAM_GUID       = 19,
     DATA_PRINCE_VALANAR_GUID        = 20,
     DATA_BLOOD_PRINCES_CONTROL      = 21,
+	DATA_ALL_YOU_CAN_EAT            = 22,
+	DATA_SPAWN                      = 23,
+	DATA_LICH_KING                  = 24,
+	DATA_BEEN_WAITING               = 25,
+	DATA_NECK_DEEP                  = 26,
+	DATA_TIRION                     = 27,
+	DATA_NECROTIC_STACK             = 28,
 };
 
 #define MAX_ENCOUNTER 12
@@ -114,6 +127,9 @@ enum eCreatures
     NPC_OOZE_SPRAY_STALKER                      = 37986,
     NPC_PUDDLE_STALKER                          = 37013,
     NPC_UNSTABLE_EXPLOSION_STALKER              = 38107,
+	
+	// Sindragosa
+	CREATURE_ICE_TOMB                           = 36980,
 
     // Professor Putricide
     NPC_PROFESSOR_PUTRICIDE                     = 36678,
@@ -139,6 +155,46 @@ enum eCreatures
 
     // Blood-Queen Lana'thel
     NPC_BLOOD_QUEEN_LANA_THEL                   = 37955,
+	
+	// Valithria Dreamwalker
+	CREATURE_CLOUD                              = 37985,
+	CREATURE_PORTAL_NORMAL_MODE_PRE             = 38186,
+    CREATURE_PORTAL_NORMAL_MODE_NPC             = 37945,
+    CREATURE_PORTAL_HEROIC_MODE_PRE             = 38429,
+    CREATURE_PORTAL_HEROIC_MODE_NPC             = 38430,
+	CREATURE_ABOMINATION                        = 37886,
+    CREATURE_SKELETON                           = 36791,
+    CREATURE_ARCHMAGE                           = 37868,
+    CREATURE_SUPPRESSER                         = 37863,
+    CREATURE_ZOMBIE                             = 37934,
+	
+	// Rat Des Blutes
+	CREATURE_BALL_OF_FLAME                      = 38332,
+	CREATURE_BALL_OF_INFERNO_FLAME              = 38451,
+	CREATURE_KINETIC_BOMB_TARGET                = 38458,
+    CREATURE_KINETIC_BOMB                       = 38454,
+	CREATURE_SHOCK_VORTEX                       = 38422,
+	CREATURE_FLOATING_TRIGGER                   = 30298,
+	
+	// Icecrown
+	CREATURE_ADHERENT                           = 37949,
+    CREATURE_EMPOWERED_ADHERENT                 = 38136,
+    CREATURE_REANIMATED_ADHERENT                = 38010,
+    CREATURE_FANATIC                            = 37890,
+    CREATURE_DEFORMED_FANATIC                   = 38135,
+    CREATURE_REANIMATED_FANATIC                 = 38009,
+	
+	// The Lich King
+	CREATURE_ICE_SPHERE                         = 36633,
+	CREATURE_DEFILE                             = 38757,
+	CREATURE_RAGING_SPIRIT                      = 36701,
+	CREATURE_TRIGGER                            = 38667,
+    CREATURE_VILE_SPIRIT                        = 37799,
+	CREATURE_FROSTMOURNE_TRIGGER                = 38584,
+	CREAUTRE_MENETHIL                           = 38579,
+	CREATURE_VALKYR                             = 36609,
+	CREATURE_DRUDGE_GHOUL                       = 37695,
+    CREATURE_SHAMBLING_HORROR                   = 37698,
 };
 
 enum eGameobjects
@@ -203,6 +259,14 @@ enum eAchievementCriteria
     CRITERIA_DANCES_WITH_OOZES_25N      = 12966,
     CRITERIA_DANCES_WITH_OOZES_10H      = 12985,
     CRITERIA_DANCES_WITH_OOZES_25H      = 12983,
+	
+	// Sindragosa
+	ACHIEV_ALL_YOU_CAN_EAT_10           = 4580,
+    ACHIEV_ALL_YOU_CAN_EAT_25           = 4620,
+	ACHIEV_BEEN_WAITING_A_LONG_TIME_FOR_THIS_10 = 4601,
+    ACHIEV_BEEN_WAITING_A_LONG_TIME_FOR_THIS_25 = 4621,
+    ACHIEV_NECK_DEEP_IN_VILE_10         = 4581,
+    ACHIEV_NECK_DEEP_IN_VILE_25         = 4622,
 
     // Professor Putricide
     CRITERIA_NAUSEA_10N                 = 12987,
