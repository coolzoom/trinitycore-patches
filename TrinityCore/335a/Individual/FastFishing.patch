From 4885596f7fc5730d93ef35e6b784eb0b97c805f6 Mon Sep 17 00:00:00 2001
From: LordPsyan <realmsofwarcraft@gmail.com>
Date: Sun, 5 Oct 2014 11:49:00 -0400
Subject: [PATCH] FastFishing

---
 src/server/game/Spells/SpellEffects.cpp      |  3 +++
 src/server/game/World/World.cpp              |  2 +-
 src/server/game/World/World.h                |  2 +-
 src/server/worldserver/worldserver.conf.dist | 12 ++++++++++++
 4 files changed, 17 insertions(+), 2 deletions(-)

diff --git a/src/server/game/Spells/SpellEffects.cpp b/src/server/game/Spells/SpellEffects.cpp
index af1e3b6..73247a1 100644
--- a/src/server/game/Spells/SpellEffects.cpp
+++ b/src/server/game/Spells/SpellEffects.cpp
@@ -5163,6 +5163,9 @@ void Spell::EffectTransmitted(SpellEffIndex effIndex)
                 case 3: lastSec = 17; break;
             }
 
+            if (sWorld->getBoolConfig(CONFIG_FAST_FISHING))
+                lastSec = 17;
+
             duration = duration - lastSec*IN_MILLISECONDS + FISHING_BOBBER_READY_TIME*IN_MILLISECONDS;
             break;
         }
diff --git a/src/server/game/World/World.cpp b/src/server/game/World/World.cpp
index 0b6a1ac..565fd2c 100644
--- a/src/server/game/World/World.cpp
+++ b/src/server/game/World/World.cpp
@@ -1114,7 +1114,7 @@ void World::LoadConfigSettings(bool reload)
     // 04
     // 05
     // 06
-    // 07
+    m_bool_configs[CONFIG_FAST_FISHING] = sConfigMgr->GetBoolDefault("Custom.FastFishing", false);
     // 08
     // 09
     // 10
diff --git a/src/server/game/World/World.h b/src/server/game/World/World.h
index 05d0fcc..1076e8b 100644
--- a/src/server/game/World/World.h
+++ b/src/server/game/World/World.h
@@ -168,7 +168,7 @@ enum WorldBoolConfigs
     // 08
     // 09
     // 10
-    // 11
+    CONFIG_FAST_FISHING,
     // 12
     // 13
     // 14
diff --git a/src/server/worldserver/worldserver.conf.dist b/src/server/worldserver/worldserver.conf.dist
index 43ea962..d8da943 100644
--- a/src/server/worldserver/worldserver.conf.dist
+++ b/src/server/worldserver/worldserver.conf.dist
@@ -3231,6 +3231,18 @@ PacketSpoof.BanDuration = 86400
 #
 ###################################################################################################
 
+###################################################################################################
+#
+# Custom.FastFishing
+# Set it to 1 to make fishing a lot faster!
+# Default : 0 (Fishing is normal)
+#
+
+Custom.FastFishing = 0
+
+#
+###################################################################################################
+
 #
 # Prepatch by LordPsyan.
 # See http://www.realmsofwarcraft.com/bb for forums and information.
-- 
2.1.0

