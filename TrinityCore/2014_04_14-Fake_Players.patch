From eba93ba3c692acc39bc7c558dfac37d4516361e7 Mon Sep 17 00:00:00 2001
From: LordPsyan <realmsofwarcraft@gmail.com>
Date: Mon, 14 Apr 2014 06:48:25 -0500
Subject: [PATCH] 2014_04_14-Fake_Players

---
 sql/extras/2014_04_14-characters-fake_players.sql | 17 +++++++++++++++++
 src/server/game/Entities/Player/Player.cpp        |  9 ++++++++-
 src/server/worldserver/worldserver.conf.dist      |  7 +++++++
 3 files changed, 32 insertions(+), 1 deletion(-)
 create mode 100644 sql/extras/2014_04_14-characters-fake_players.sql

diff --git a/sql/extras/2014_04_14-characters-fake_players.sql b/sql/extras/2014_04_14-characters-fake_players.sql
new file mode 100644
index 0000000..b4ba867
--- /dev/null
+++ b/sql/extras/2014_04_14-characters-fake_players.sql
@@ -0,0 +1,17 @@
+/*Table structure for table `characters_fake` */
+
+DROP TABLE IF EXISTS `characters_fake`;
+
+CREATE TABLE `characters_fake` (
+  `name` varchar(36) NOT NULL,
+  `race` mediumint(3) NOT NULL DEFAULT '0',
+  `class` mediumint(3) NOT NULL DEFAULT '0',
+  `level` mediumint(3) NOT NULL DEFAULT '0',
+  `zone` mediumint(9) NOT NULL DEFAULT '0',
+  `gender` mediumint(3) NOT NULL DEFAULT '0',
+  `online` mediumint(3) NOT NULL DEFAULT '0'
+) ENGINE=MyISAM DEFAULT CHARSET=latin1;
+
+/*Data for the table `characters_fake` */
+
+insert  into `characters_fake`(`name`,`race`,`class`,`level`,`zone`,`gender`,`online`) values ('Drikish',2,8,18,3,0,2),('Sovelis',1,1,71,18,0,2),('Cuddles',2,2,62,28,0,2),('Epiasdv',8,4,16,35,0,2),('Mac',5,4,51,43,0,2),('Tiesto',8,6,45,9,0,2),('Ihavfacebook',11,7,72,15,1,2),('Mimik',2,4,66,48,0,2),('Deadmau',5,4,31,45,0,2),('Smoosh',8,1,39,28,0,2),('Shadowcrest',4,4,17,6,1,2),('Lolol',4,5,49,44,1,2),('Prox',11,1,33,1,1,2),('Rovip',3,4,18,24,0,2),('Ryan',7,8,69,18,0,2),('Holysmite',1,2,48,16,0,2),('Airagon',6,2,33,27,0,2),('Fracture',5,1,22,38,0,2),('Supershen',3,2,11,5,1,2),('Jana',2,6,64,11,0,2),('Gamm',2,1,49,40,0,2),('Emoarchie',6,8,52,18,0,2),('Melia',1,2,33,20,1,2),('Balu',6,11,5,43,0,2),('Jabari',2,1,5,5,0,2),('Sinan',10,2,11,45,0,2),('Shisha',10,4,38,9,1,2),('Killbill',1,4,76,10,0,2),('Gaby',4,11,24,21,1,2),('Fallen',4,4,51,26,0,2),('Druidita',6,11,24,18,0,2),('Pigolo',6,11,46,9,0,2),('Saga',5,2,78,42,0,2),('Deadmask',10,2,9,30,0,2),('Assasincz',4,6,50,27,0,2),('Petracz',1,4,64,41,1,2),('Aleks',10,2,8,25,0,2),('Cazadormen',4,4,7,2,1,2),('Kireth',1,2,10,36,1,2),('Liesma',1,1,29,22,1,2),('Tyller',1,1,33,2,0,2),('Astrabutaz',1,2,77,45,0,2),('Carlita',7,8,44,17,1,2),('Beanie',10,2,70,50,0,2),('Nergal',10,3,55,49,0,2),('Smikis',10,5,63,43,0,2),('Peperoma',11,2,70,20,0,2),('May',1,2,5,18,1,2),('Keyadis',8,7,34,29,0,2),('Preatorian',10,2,5,43,0,2),('Mitza',1,9,81,25,0,2),('Keedor',10,2,69,47,0,2),('Kekw',4,3,22,10,1,2),('Wark',1,2,63,8,0,2),('Barrabus',10,2,7,9,0,2),('Malodetehepy',4,11,5,21,0,2),('Dranati',10,2,79,26,0,2),('Sorin',2,1,62,18,0,2),('Resan',4,4,73,9,0,2),('Silverhilt',1,1,15,43,1,2),('Chirica',10,2,18,39,0,2),('Trias',10,8,44,14,0,2),('Prdo',5,1,5,1,0,2),('Guten',8,7,49,13,0,2),('Sonsia',4,3,73,12,1,2),('Smikiss',10,4,54,21,0,2),('Ledy',4,1,50,20,1,2),('Rymar',5,6,8,33,0,2),('Rokass',5,1,50,7,0,2),('Waisha',10,3,64,36,1,2),('Xenon',4,1,8,8,0,2),('Palanoski',1,2,8,32,0,2),('Helona',6,11,13,33,1,2),('Skalons',2,1,42,20,0,2),('Zazlock',5,9,11,2,0,2),('Zazk',6,7,8,1,0,2),('Ezekiel',10,9,7,45,0,2),('Deiv',10,8,11,21,0,2),('Crashwar',5,1,30,20,0,2),('Bandaid',5,5,36,38,0,2),('Hunterherbie',4,3,10,31,0,2),('Cheesebeard',3,1,20,37,0,2),('Phin',7,6,68,43,0,2),('Prig',6,5,41,4,0,2),('Eraevel',6,5,78,40,1,2),('Bourne',5,4,28,36,0,2),('Twoogi',5,8,65,9,0,2),('Devon',5,6,5,38,0,2),('Ledystar',1,2,50,12,1,2),('Frostie',3,8,6,46,1,2),('Kie',5,4,38,43,0,2),('Reios',1,2,9,25,0,2),('Zero',4,4,13,48,0,2),('Wuk',2,1,38,13,0,2),('Sylvaediir',4,3,69,20,0,2),('Kansetsu',11,2,68,12,0,2),('Makura',11,2,52,47,1,2),('Demonia',11,2,55,1,1,2),('Stonebull',6,11,37,14,0,2),('Marianus',10,2,19,17,0,2);
diff --git a/src/server/game/Entities/Player/Player.cpp b/src/server/game/Entities/Player/Player.cpp
index 2691a68..7a10992 100644
--- a/src/server/game/Entities/Player/Player.cpp
+++ b/src/server/game/Entities/Player/Player.cpp
@@ -78,6 +78,7 @@
 #include "WorldPacket.h"
 #include "WorldSession.h"
 #include "GameObjectAI.h"
+#include "Config.h"
 
 #define ZONE_UPDATE_INTERVAL (1*IN_MILLISECONDS)
 
@@ -1333,8 +1334,11 @@ int32 Player::getMaxTimer(MirrorTimerType timer)
 {
     switch (timer)
     {
+    if(sConfigMgr->GetBoolDefault("fatigue.enabled", true)) // If "fatigue.enabled" is enabled
+        {
         case FATIGUE_TIMER:
             return MINUTE * IN_MILLISECONDS;
+        }
         case BREATH_TIMER:
         {
             if (!IsAlive() || HasAuraType(SPELL_AURA_WATER_BREATHING) || GetSession()->GetSecurity() >= AccountTypes(sWorld->getIntConfig(CONFIG_DISABLE_BREATHING)))
@@ -1417,6 +1421,9 @@ void Player::HandleDrowning(uint32 time_diff)
     }
 
     // In dark water
+if(sConfigMgr->GetBoolDefault("fatigue.enabled", true)) // If "fatigue.enabled" is enabled
+{
+
     if (m_MirrorTimerFlags & UNDERWARER_INDARKWATER)
     {
         // Fatigue timer not activated - activate it
@@ -1453,7 +1460,7 @@ void Player::HandleDrowning(uint32 time_diff)
         else if (m_MirrorTimerFlagsLast & UNDERWARER_INDARKWATER)
             SendMirrorTimer(FATIGUE_TIMER, DarkWaterTime, m_MirrorTimer[FATIGUE_TIMER], 10);
     }
-
+}
     if (m_MirrorTimerFlags & (UNDERWATER_INLAVA /*| UNDERWATER_INSLIME*/) && !(_lastLiquid && _lastLiquid->SpellId))
     {
         // Breath timer not activated - activate it
diff --git a/src/server/worldserver/worldserver.conf.dist b/src/server/worldserver/worldserver.conf.dist
index f71ef5d..4fb63c3 100644
--- a/src/server/worldserver/worldserver.conf.dist
+++ b/src/server/worldserver/worldserver.conf.dist
@@ -757,6 +757,13 @@ RecruitAFriend.MaxDifference = 4
 DisableWaterBreath = 4
 
 #
+#    Enable or Disable "Fatigue" timer
+#           default = 1 (enabled)
+#                   = 0 (disabled)
+
+fatigue.enabled = 1
+
+#
 #    AllFlightPaths
 #        Description: Character knows all flight paths (of both factions) after creation.
 #        Default:     0 - (Disabled)
-- 
1.8.3.msysgit.0

