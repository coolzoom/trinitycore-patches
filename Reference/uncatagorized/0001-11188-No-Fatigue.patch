From 95fc48f9c6562b19934ad7203d9ab70616d4c5c7 Mon Sep 17 00:00:00 2001
From: LordPsyan <uppp@juno.com>
Date: Wed, 9 Feb 2011 08:36:23 -0500
Subject: [PATCH] 11188-No-Fatigue

---
 0001-11188-Saurfang-Door.patch             |   24 ++++++++++++++++++++++++
 src/server/game/Entities/Player/Player.cpp |    8 ++++----
 src/server/game/Entities/Player/Player.h   |    4 ++--
 3 files changed, 30 insertions(+), 6 deletions(-)
 create mode 100644 0001-11188-Saurfang-Door.patch

diff --git a/0001-11188-Saurfang-Door.patch b/0001-11188-Saurfang-Door.patch
new file mode 100644
index 0000000..9240720
--- /dev/null
+++ b/0001-11188-Saurfang-Door.patch
@@ -0,0 +1,24 @@
+From 49bcdc26e2734207b631b551c279c9d7bc4dda66 Mon Sep 17 00:00:00 2001
+From: LordPsyan <uppp@juno.com>
+Date: Wed, 9 Feb 2011 08:26:59 -0500
+Subject: [PATCH] 11188-Saurfang-Door
+
+---
+ .../IcecrownCitadel/instance_icecrown_citadel.cpp  |    1 +
+ 1 files changed, 1 insertions(+), 0 deletions(-)
+
+diff --git a/src/server/scripts/Northrend/IcecrownCitadel/instance_icecrown_citadel.cpp b/src/server/scripts/Northrend/IcecrownCitadel/instance_icecrown_citadel.cpp
+index 17728a9..2488b4b 100755
+--- a/src/server/scripts/Northrend/IcecrownCitadel/instance_icecrown_citadel.cpp
++++ b/src/server/scripts/Northrend/IcecrownCitadel/instance_icecrown_citadel.cpp
+@@ -402,6 +402,7 @@ class instance_icecrown_citadel : public InstanceMapScript
+                         {
+                             case DONE:
+                                 DoRespawnGameObject(deathbringersCache, 7*DAY);
++								HandleGameObject(saurfangDoor, true);
+                             case NOT_STARTED:
+                                 if (GameObject* teleporter = instance->GetGameObject(saurfangTeleport))
+                                 {
+-- 
+1.7.2.3
+
diff --git a/src/server/game/Entities/Player/Player.cpp b/src/server/game/Entities/Player/Player.cpp
index a6a8e9a..76d013b 100755
--- a/src/server/game/Entities/Player/Player.cpp
+++ b/src/server/game/Entities/Player/Player.cpp
@@ -1050,8 +1050,8 @@ int32 Player::getMaxTimer(MirrorTimerType timer)
 {
     switch (timer)
     {
-        case FATIGUE_TIMER:
-            return MINUTE * IN_MILLISECONDS;
+       /* case FATIGUE_TIMER:
+            return MINUTE * IN_MILLISECONDS;*/
         case BREATH_TIMER:
         {
             if (!isAlive() || HasAuraType(SPELL_AURA_WATER_BREATHING) || GetSession()->GetSecurity() >= AccountTypes(sWorld->getIntConfig(CONFIG_DISABLE_BREATHING)))
@@ -1122,7 +1122,7 @@ void Player::HandleDrowning(uint32 time_diff)
     }
 
     // In dark water
-    if (m_MirrorTimerFlags & UNDERWARER_INDARKWATER)
+    /* if (m_MirrorTimerFlags & UNDERWARER_INDARKWATER)
     {
         // Fatigue timer not activated - activate it
         if (m_MirrorTimer[FATIGUE_TIMER] == DISABLED_MIRROR_TIMER)
@@ -1157,7 +1157,7 @@ void Player::HandleDrowning(uint32 time_diff)
             StopMirrorTimer(FATIGUE_TIMER);
         else if (m_MirrorTimerFlagsLast & UNDERWARER_INDARKWATER)
             SendMirrorTimer(FATIGUE_TIMER, DarkWaterTime, m_MirrorTimer[FATIGUE_TIMER], 10);
-    }
+    }*/
 
     if (m_MirrorTimerFlags & (UNDERWATER_INLAVA|UNDERWATER_INSLIME))
     {
diff --git a/src/server/game/Entities/Player/Player.h b/src/server/game/Entities/Player/Player.h
index a4f5b42..36d6ed4 100755
--- a/src/server/game/Entities/Player/Player.h
+++ b/src/server/game/Entities/Player/Player.h
@@ -469,7 +469,7 @@ enum ActivateTaxiReplies
 
 enum MirrorTimerType
 {
-    FATIGUE_TIMER      = 0,
+    // FATIGUE_TIMER      = 0,
     BREATH_TIMER       = 1,
     FIRE_TIMER         = 2
 };
@@ -1883,7 +1883,7 @@ class Player : public Unit, public GridObject<Player>
         void UpdateMirrorTimers();
         void StopMirrorTimers()
         {
-            StopMirrorTimer(FATIGUE_TIMER);
+            // StopMirrorTimer(FATIGUE_TIMER);
             StopMirrorTimer(BREATH_TIMER);
             StopMirrorTimer(FIRE_TIMER);
         }
-- 
1.7.2.3

